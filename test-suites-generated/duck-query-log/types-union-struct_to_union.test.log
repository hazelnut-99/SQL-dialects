create table union_tbl(
	col UNION(
		a BOOL,
		b INTEGER,
		c TINYINT
	)
);
insert into union_tbl VALUES
	({tag: '0', a: true, b: null, c: null});
insert into union_tbl VALUES
	({tag: 0::UINT8, a: true, b: null::INTEGER, d: null::TINYINT});
insert into union_tbl VALUES
	({tag: 0::UINT8, a: 1, b: null::INTEGER, c: null::TINYINT});
insert into union_tbl VALUES
	({tag: 4::UINT8, a: true, b: null::INTEGER, c: null::TINYINT});
create table struct_tbl(
	col STRUCT(
		tag UINT8,
		A BOOL,
		B INTEGER,
		C TINYINT
	)
);
INSERT INTO struct_tbl VALUES
	(ROW(0, True, NULL, NULL)),
	(ROW(1, NULL, 23423, NULL)),
    (ROW(0, True, NULL, NULL));
insert into union_tbl select * from struct_tbl;;
delete from struct_tbl;;
INSERT INTO struct_tbl VALUES
	(ROW(0, True, NULL, NULL)),
	(ROW(1, NULL, 23423, NULL)),
	(ROW(2, True, NULL, NULL));
insert into union_tbl select * from struct_tbl;;
insert into union_tbl VALUES(
	{tag: 0::UINT8, a: False, b: NULL::INTEGER, c: NULL::TINYINT}
);
insert into union_tbl VALUES(
	{tag: 1::UINT8, a: NULL::BOOLEAN, b: 32412, c: 123::TINYINT}
);
delete from struct_tbl;;
insert into struct_tbl VALUES
	(ROW(1::UINT8, NULL, 1, NULL)),
	(ROW(1::UINT8, NULL, 2, NULL)),
	(ROW(1::UINT8, NULL, 3, 0));
insert into union_tbl select * from struct_tbl;;
