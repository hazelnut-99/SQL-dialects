PRAGMA enable_verification;
CREATE TABLE test (a INTEGER, b INTEGER);
INSERT INTO test VALUES (-1099511627776, 3);
INSERT INTO test VALUES (11, 22), (12, 21), (14, 22);
SELECT ALL CAST ( - SUM ( DISTINCT - CAST ( NULL AS INTEGER ) ) AS INTEGER ) FROM test;
SELECT b, AVG(a) FROM test GROUP BY b ORDER BY b;
SELECT cast(200 AS TINYINT);
SELECT cast(-129 AS TINYINT);
SELECT cast(100 AS TINYINT) + cast(100 AS TINYINT);
CREATE TABLE test2 (a INTEGER, b TINYINT);
INSERT INTO test2 VALUES (200, 60), (12, 60), (14, 60);
SELECT cast(a AS TINYINT) FROM test2;
SELECT SUM(b) FROM test2;
SELECT 100::TINYINT - -50::TINYINT;
SELECT 100::TINYINT * 2::TINYINT;
SELECT 100::TINYINT + b::TINYINT FROM test2;
SELECT 100::TINYINT - -b::TINYINT FROM test2;
SELECT 100::TINYINT * b::TINYINT FROM test2;
SELECT a + b FROM (SELECT cast(100 AS TINYINT) AS a, cast(100 AS TINYINT) AS b) tbl1;
PRAGMA enable_verification;
SELECT 1e308::DOUBLE + 1e308::DOUBLE;
SELECT 0::DOUBLE - 1e308::DOUBLE - 1e308::DOUBLE;
SELECT 1e308::DOUBLE * 1e308::DOUBLE;
SELECT 1e308::DOUBLE * 1e308::DOUBLE;
SELECT 1e308::DOUBLE / 0.1;
SELECT 2e38::FLOAT + 2e38::FLOAT;
SELECT 2e38::FLOAT * 2e38::FLOAT;
SELECT 2e38::FLOAT / 0.1;
PRAGMA enable_verification;
CREATE TABLE integers(x INTEGER);
SET max_expression_depth=250;
SELECT x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x + x FROM integers;
PRAGMA enable_verification;
SELECT 100::TINYINT + 1::TINYINT;
SELECT 100::TINYINT + 50::TINYINT;
SELECT 0::TINYINT + -127::TINYINT;
SELECT -2::TINYINT + -127::TINYINT;
SELECT 30000::SMALLINT + 1::SMALLINT;
SELECT 30000::SMALLINT + 5000::SMALLINT;
SELECT 0::SMALLINT + -32767::SMALLINT;
SELECT -2::SMALLINT + -32767::SMALLINT;
SELECT 2147483640::INTEGER + 1::INTEGER;
SELECT 2147483640::INTEGER + 5000::INTEGER;
SELECT 0::INTEGER + -2147483647::INTEGER;
SELECT -2::INTEGER + -2147483647::INTEGER;
SELECT 9223372036854775800::BIGINT + 1::BIGINT;
SELECT 9223372036854775800::BIGINT + 5000::BIGINT;
SELECT 0::BIGINT + -9223372036854775807::BIGINT;
SELECT -2::BIGINT + -9223372036854775808::BIGINT;
SELECT -100::TINYINT - 1::TINYINT;
SELECT -100::TINYINT - 50::TINYINT;
SELECT 0::TINYINT - 127::TINYINT;
SELECT -2::TINYINT - 127::TINYINT;
SELECT -30000::SMALLINT - 1::SMALLINT;
SELECT -30000::SMALLINT - 5000::SMALLINT;
SELECT 0::SMALLINT - 32767::SMALLINT;
SELECT -2::SMALLINT - 32767::SMALLINT;
SELECT -2147483640::INTEGER - 1::INTEGER;
SELECT -2147483640::INTEGER - 5000::INTEGER;
SELECT 0::INTEGER - 2147483647::INTEGER;
SELECT -2::INTEGER - 2147483647::INTEGER;
SELECT -9223372036854775800::BIGINT - 1::BIGINT;
SELECT -9223372036854775800::BIGINT - 5000::BIGINT;
SELECT 0::BIGINT - 9223372036854775807::BIGINT;
SELECT -2::BIGINT - 9223372036854775807::BIGINT;
SELECT 50::TINYINT * 2::TINYINT;
SELECT 50::TINYINT * 3::TINYINT;
SELECT -1::TINYINT * 127::TINYINT;
SELECT -2::TINYINT * 64::TINYINT;
SELECT -2::TINYINT * 65::TINYINT;
SELECT 15000::SMALLINT * 2::SMALLINT;
SELECT 15000::SMALLINT * 3::SMALLINT;
SELECT -1::SMALLINT * 32767::SMALLINT;
SELECT -2::SMALLINT * 16384::SMALLINT;
SELECT -2::SMALLINT * 16385::SMALLINT;
SELECT 1073741820::INTEGER * 2::INTEGER;
SELECT 1073741820::INTEGER * 3::INTEGER;
SELECT -1::INTEGER * 2147483647::INTEGER;
SELECT -2::INTEGER * 1073741824::INTEGER;
SELECT -2::INTEGER * 1073741825::INTEGER;
SELECT 4611686018427387900::BIGINT * 2::BIGINT;
SELECT 4611686018427387900::BIGINT * 3::BIGINT;
SELECT -1::BIGINT * 9223372036854775807::BIGINT;
SELECT -2::BIGINT * 4611686018427387905::BIGINT;
PRAGMA enable_verification;
SELECT 1e1000;
SELECT 1e308::REAL;
SELECT 1e1000::REAL;
SELECT '1e1000'::DOUBLE;
SELECT '1e100'::REAL;
SELECT SUM(i) FROM (VALUES (1e308), (1e308)) tbl(i);
SELECT AVG(i) FROM (VALUES (1e308), (1e308)) tbl(i);
SELECT 1e308+1e308;
SELECT 1e308*2;
SELECT -1e308-1e308;
SELECT 1e308/0.1;
SELECT 2e38::REAL+2e38::REAL;
SELECT 2e38::REAL*2;
SELECT -2e38::REAL-2e38::REAL;
SELECT 2e38::REAL/0.1::REAL;
CREATE TABLE tinyints(i TINYINT);
INSERT INTO tinyints VALUES (1), (10);
SELECT i+100::TINYINT FROM tinyints ORDER BY 1;
SELECT i+120::TINYINT FROM tinyints ORDER BY 1;
SELECT i+120::TINYINT FROM tinyints WHERE i=1 ORDER BY 1;
SELECT -100::TINYINT-i FROM tinyints ORDER BY 1;
SELECT -120::TINYINT-i FROM tinyints ORDER BY 1;
SELECT -120::TINYINT-i FROM tinyints WHERE i=1 ORDER BY 1;
SELECT -120::TINYINT + (-i) FROM tinyints ORDER BY 1;
SELECT -120::TINYINT + (-(-(-i))) FROM tinyints ORDER BY 1;
SELECT i*10::TINYINT FROM tinyints ORDER BY 1;
SELECT i*15::TINYINT FROM tinyints ORDER BY 1;
SELECT (i*10::TINYINT)*10::TINYINT FROM tinyints ORDER BY 1;
SELECT (i*10::TINYINT)*10::TINYINT FROM tinyints WHERE i=1 ORDER BY 1;
SELECT (i*10::TINYINT)*10::TINYINT FROM (SELECT * FROM tinyints) tbl(i) ORDER BY 1;
SELECT (i*10::TINYINT)*10::TINYINT FROM (SELECT * FROM tinyints) tbl(i) WHERE i=1 ORDER BY 1;
SELECT (i*10::TINYINT)*10::TINYINT FROM (SELECT * FROM tinyints WHERE i=1 UNION ALL SELECT * FROM tinyints WHERE i=10) tbl(i) ORDER BY 1;
CREATE TABLE smallints(i SMALLINT);
INSERT INTO smallints VALUES (1), (10);
SELECT i+32765::SMALLINT FROM smallints;
SELECT i+32765::SMALLINT FROM smallints WHERE i=1;
SELECT -32765::SMALLINT-i FROM smallints;
SELECT -32765::SMALLINT-i FROM smallints WHERE i=1;
SELECT i*10000::SMALLINT FROM smallints;
SELECT i*10000::SMALLINT FROM smallints WHERE i=1;
SELECT i::TINYINT+120::TINYINT FROM smallints;
SELECT i::TINYINT+120::TINYINT FROM smallints WHERE i=1;
INSERT INTO smallints VALUES (1000);
SELECT i::TINYINT FROM smallints;
SELECT i::TINYINT+120::TINYINT FROM smallints WHERE i=1;
INSERT INTO smallints VALUES (30000);
SELECT integers1.i::SMALLINT + integers2.i::SMALLINT from smallints integers1, smallints integers2 where integers1.i = integers2.i;
CREATE TABLE smallints2 (j SMALLINT);
INSERT INTO smallints2 VALUES (1), (10);
SELECT i + j from smallints si_left LEFT JOIN smallints2 si_right ON (i = j);
INSERT INTO smallints2 VALUES (30000);
SELECT i + j from smallints LEFT JOIN smallints2  ON (i = j);
PRAGMA enable_verification;
SELECT 251658240::BIGINT * 251658240::BIGINT;
SELECT 251658240::BIGINT * 1080863910568919040::BIGINT;
SELECT 1080863910568919040::BIGINT * 251658240::BIGINT;
SELECT 1080863910568919040::BIGINT * 1080863910568919040::BIGINT;
SELECT -1::BIGINT * 9223372036854775807::BIGINT;
SELECT -2::BIGINT * 4611686018427387905::BIGINT;
SELECT 8589934592::BIGINT * 1073741823::BIGINT;
SELECT 10737418240::BIGINT * 1073741823::BIGINT;
SELECT 1073741823::BIGINT * 8589934592::BIGINT;
SELECT 1073741823::BIGINT * 10737418240::BIGINT;
SELECT 1073741823::BIGINT * 8589934592::BIGINT;
SELECT (-9223372036854775808)::BIGINT * 2::BIGINT;
SELECT (-9223372036854775808)::BIGINT * -1::BIGINT;
SELECT -1::BIGINT * (-9223372036854775808)::BIGINT;
SELECT -2::BIGINT * (-9223372036854775808)::BIGINT;
SELECT (-9223372036854775808)::BIGINT * 0::BIGINT;
SELECT (-9223372036854775808)::BIGINT * 1::BIGINT;
SELECT 0::BIGINT * (-9223372036854775808)::BIGINT;
SELECT 1::BIGINT * (-9223372036854775808)::BIGINT;
SELECT (-9223372036854775807)::BIGINT * 2::BIGINT;
SELECT (-9223372036854775807)::BIGINT * -1::BIGINT;
SELECT -1::BIGINT * (-9223372036854775807)::BIGINT;
SELECT -2::BIGINT * (-9223372036854775807)::BIGINT;
SELECT (-9223372036854775807)::BIGINT * 0::BIGINT;
SELECT (-9223372036854775807)::BIGINT * 1::BIGINT;
SELECT 0::BIGINT * (-9223372036854775807)::BIGINT;
SELECT 1::BIGINT * (-9223372036854775807)::BIGINT;
