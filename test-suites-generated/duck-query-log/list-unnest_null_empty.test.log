PRAGMA enable_verification
CREATE TABLE people(id INTEGER, name VARCHAR, address VARCHAR[]);
insert into people values (1, 'Zuckerberg', ARRAY['New York']);
insert into people values (2, 'Bezos', ARRAY['Washington', 'Space']);
insert into people values (3, 'Tim', NULL);
insert into people values (4, 'Elvis', ARRAY[NULL, NULL, NULL]);
insert into people values (5, 'Mark', ARRAY[]::VARCHAR[]);
SELECT UNNEST(NULL);
SELECT UNNEST(NULL);

SELECT UNNEST(NULL);
SELECT unnest(NULL)




SELECT UNNEST(NULL);
SELECT UNNEST(NULL::BOOLEAN[]);
SELECT UNNEST(NULL::BOOLEAN[]);

SELECT UNNEST(NULL::BOOLEAN[]);
SELECT unnest(CAST(NULL AS BOOLEAN[]))




SELECT UNNEST(NULL::BOOLEAN[]);
SELECT name, UNNEST(address) FROM people;
SELECT name, UNNEST(address) FROM people;

SELECT name, UNNEST(address) FROM people;
SELECT "name", unnest(address) FROM people




SELECT name, UNNEST(address) FROM people;
SELECT name, UNNEST(address), UNNEST([1]) FROM people;
SELECT name, UNNEST(address), UNNEST([1]) FROM people;

SELECT name, UNNEST(address), UNNEST([1]) FROM people;
SELECT "name", unnest(address), unnest(main.list_value(1)) FROM people




SELECT name, UNNEST(address), UNNEST([1]) FROM people;
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a, UNNEST(a) AS n
FROM t
ORDER BY r, n;
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a, UNNEST(a) AS n
FROM t
ORDER BY r, n;

WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a, UNNEST(a) AS n
FROM t
ORDER BY r, n;
WITH t AS (((SELECT 1 AS r, (ARRAY[1, 2, 3]) AS a) UNION (SELECT 2 AS r, (ARRAY[4]) AS a)) UNION (SELECT 3 AS r, NULL AS a))SELECT r, a, unnest(a) AS n FROM t ORDER BY r, n




WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a, UNNEST(a) AS n
FROM t
ORDER BY r, n;
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, (SELECT UNNEST(a)) AS a(value)
ORDER BY r, a.value
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, (SELECT UNNEST(a)) AS a(value)
ORDER BY r, a.value

WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, (SELECT UNNEST(a)) AS a(value)
ORDER BY r, a.value
WITH t AS (((SELECT 1 AS r, (ARRAY[1, 2, 3]) AS a) UNION (SELECT 2 AS r, (ARRAY[4]) AS a)) UNION (SELECT 3 AS r, NULL AS a))SELECT r, a."value" FROM t , (SELECT unnest(a)) AS a("value") ORDER BY r, a."value"




WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, (SELECT UNNEST(a)) AS a(value)
ORDER BY r, a.value
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value

WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
WITH t AS (((SELECT 1 AS r, (ARRAY[1, 2, 3]) AS a) UNION (SELECT 2 AS r, (ARRAY[4]) AS a)) UNION (SELECT 3 AS r, NULL AS a))SELECT r, a."value" FROM t , unnest(a) AS a("value") ORDER BY r, a."value"




WITH t AS (
	SELECT 1 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 2 AS r, ARRAY[4] AS a
	UNION SELECT 3 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
CREATE TABLE t AS SELECT 5 AS r, ARRAY[1, 2, 3] AS a;
INSERT INTO t VALUES (6, [4]), (7, NULL);
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value

SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
SELECT r, a."value" FROM t , unnest(a) AS a("value") ORDER BY r, a."value"




SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
WITH t AS (
	SELECT 5 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 6 AS r, ARRAY[4] AS a
	UNION SELECT 7 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
WITH t AS (
	SELECT 5 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 6 AS r, ARRAY[4] AS a
	UNION SELECT 7 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value

WITH t AS (
	SELECT 5 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 6 AS r, ARRAY[4] AS a
	UNION SELECT 7 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
WITH t AS (((SELECT 5 AS r, (ARRAY[1, 2, 3]) AS a) UNION (SELECT 6 AS r, (ARRAY[4]) AS a)) UNION (SELECT 7 AS r, NULL AS a))SELECT r, a."value" FROM t , unnest(a) AS a("value") ORDER BY r, a."value"




WITH t AS (
	SELECT 5 AS r, ARRAY[1, 2, 3] AS a
	UNION SELECT 6 AS r, ARRAY[4] AS a
	UNION SELECT 7 AS r, NULL AS a)
SELECT r, a.value
FROM t, UNNEST(a) AS a(value)
ORDER BY r, a.value
