SET default_null_order='nulls_first';;
PRAGMA enable_verification;
CREATE TABLE nested_lists(l INTEGER[][]);;
INSERT INTO nested_lists VALUES (ARRAY[ARRAY[0], ARRAY[1]]), (ARRAY[ARRAY[2], ARRAY[NULL, 3]]), (ARRAY[ARRAY[4, 5], ARRAY[6, 7], ARRAY[], ARRAY[8]]), (NULL), (ARRAY[NULL]::INT[][]);;
SELECT UNNEST(l) FROM nested_lists;
SELECT UNNEST(l) FROM nested_lists;
;
SELECT UNNEST(l) FROM nested_lists;
SELECT unnest(l) FROM nested_lists;
;
;
;
;
SELECT UNNEST(l) FROM nested_lists;
SELECT l, (SELECT SUM(a) FROM (SELECT UNNEST(b) AS a FROM (SELECT UNNEST(l) AS b))) FROM nested_lists ORDER BY l;
SELECT l, (SELECT SUM(a) FROM (SELECT UNNEST(b) AS a FROM (SELECT UNNEST(l) AS b))) FROM nested_lists ORDER BY l;
;
SELECT l, (SELECT SUM(a) FROM (SELECT UNNEST(b) AS a FROM (SELECT UNNEST(l) AS b))) FROM nested_lists ORDER BY l;
SELECT l, (SELECT sum(a) FROM (SELECT unnest(b) AS a FROM (SELECT unnest(l) AS b))) FROM nested_lists ORDER BY l;
;
;
;
;
SELECT l, (SELECT SUM(a) FROM (SELECT UNNEST(b) AS a FROM (SELECT UNNEST(l) AS b))) FROM nested_lists ORDER BY l;
