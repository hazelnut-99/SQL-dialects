PRAGMA enable_verification
SET default_null_order='nulls_first';
CREATE TABLE tbl1(id INT, a UNION(b INT, c VARCHAR));
CREATE TABLE tbl2(id INT, d UNION(e INT, f VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar');
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2);
SELECT id, union_tag(a), a.b, a.c FROM tbl1 UNION SELECT id, union_tag(d), d.e, d.f FROM tbl2 ORDER BY ALL;
SELECT id, union_tag(a), a.b, a.c FROM tbl1 UNION SELECT id, union_tag(d), d.e, d.f FROM tbl2 ORDER BY ALL;

SELECT id, union_tag(a), a.b, a.c FROM tbl1 UNION SELECT id, union_tag(d), d.e, d.f FROM tbl2 ORDER BY ALL;
(SELECT id, union_tag(a), a.b, a.c FROM tbl1) UNION (SELECT id, union_tag(d), d.e, d.f FROM tbl2) ORDER BY COLUMNS(*)




SELECT id, union_tag(a), a.b, a.c FROM tbl1 UNION SELECT id, union_tag(d), d.e, d.f FROM tbl2 ORDER BY ALL;
SELECT id, union_tag(a) as tag, a.b as v1, a.c as v2 FROM tbl1 UNION SELECT id, union_tag(d) as tag, d.e as v1, d.f as v2 FROM tbl2 ORDER BY ALL;
SELECT id, union_tag(a) as tag, a.b as v1, a.c as v2 FROM tbl1 UNION SELECT id, union_tag(d) as tag, d.e as v1, d.f as v2 FROM tbl2 ORDER BY ALL;

SELECT id, union_tag(a) as tag, a.b as v1, a.c as v2 FROM tbl1 UNION SELECT id, union_tag(d) as tag, d.e as v1, d.f as v2 FROM tbl2 ORDER BY ALL;
(SELECT id, union_tag(a) AS tag, a.b AS v1, a.c AS v2 FROM tbl1) UNION (SELECT id, union_tag(d) AS tag, d.e AS v1, d.f AS v2 FROM tbl2) ORDER BY COLUMNS(*)




SELECT id, union_tag(a) as tag, a.b as v1, a.c as v2 FROM tbl1 UNION SELECT id, union_tag(d) as tag, d.e as v1, d.f as v2 FROM tbl2 ORDER BY ALL;
SELECT tbl1.a.c, tbl1.id, tbl2.id FROM tbl2 JOIN tbl1 ON tbl1.a.c = tbl2.d.f ORDER BY ALL;
SELECT tbl1.a.c, tbl1.id, tbl2.id FROM tbl2 JOIN tbl1 ON tbl1.a.c = tbl2.d.f ORDER BY ALL;

SELECT tbl1.a.c, tbl1.id, tbl2.id FROM tbl2 JOIN tbl1 ON tbl1.a.c = tbl2.d.f ORDER BY ALL;
SELECT tbl1.a.c, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON ((tbl1.a.c = tbl2.d.f)) ORDER BY COLUMNS(*)




SELECT tbl1.a.c, tbl1.id, tbl2.id FROM tbl2 JOIN tbl1 ON tbl1.a.c = tbl2.d.f ORDER BY ALL;
SELECT t1.id FROM tbl1 as t1 JOIN tbl1 as t2 ON t1.a = t2.a ORDER BY ALL;
SELECT t1.id FROM tbl1 as t1 JOIN tbl1 as t2 ON t1.a = t2.a ORDER BY ALL;

SELECT t1.id FROM tbl1 as t1 JOIN tbl1 as t2 ON t1.a = t2.a ORDER BY ALL;
SELECT t1.id FROM tbl1 AS t1 INNER JOIN tbl1 AS t2 ON ((t1.a = t2.a)) ORDER BY COLUMNS(*)




SELECT t1.id FROM tbl1 as t1 JOIN tbl1 as t2 ON t1.a = t2.a ORDER BY ALL;
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
DROP TABLE tbl1;
DROP TABLE tbl2;
CREATE TABLE tbl1(id INT, a UNION(num INT, str VARCHAR));
CREATE TABLE tbl2(id INT, b UNION(num INT, str VARCHAR));
INSERT INTO tbl1 VALUES (1, 1), (3, 'foo'), (2, 2), (4, 'bar'), (5, 1), (4, NULL);
INSERT INTO tbl2 VALUES (1, 'foo'), (2, 'bar'), (3, 1), (4, 2), (5, 'qux');
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;

SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON ((tbl1.a = tbl2.b)) ORDER BY COLUMNS(*)




SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 INNER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 FULL OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 FULL OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;

SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 FULL OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 FULL JOIN tbl1 ON ((tbl1.a = tbl2.b)) ORDER BY COLUMNS(*)




SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 FULL OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 LEFT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 LEFT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;

SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 LEFT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 LEFT JOIN tbl1 ON ((tbl1.a = tbl2.b)) ORDER BY COLUMNS(*)




SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 LEFT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 RIGHT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 RIGHT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;

SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 RIGHT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 RIGHT JOIN tbl1 ON ((tbl1.a = tbl2.b)) ORDER BY COLUMNS(*)




SELECT tbl1.a, tbl1.id, tbl2.id FROM tbl2 RIGHT OUTER JOIN tbl1 ON tbl1.a = tbl2.b ORDER BY ALL;
SELECT id FROM tbl1 WHERE a = union_value(str :='foo')
SELECT id FROM tbl1 WHERE a = union_value(str :='foo')

SELECT id FROM tbl1 WHERE a = union_value(str :='foo')
SELECT id FROM tbl1 WHERE (a = union_value(str := 'foo'))




SELECT id FROM tbl1 WHERE a = union_value(str :='foo')
SELECT id from tbl1 where a = 'foo'::UNION(num INT, str VARCHAR)
SELECT id from tbl1 where a = 'foo'::UNION(num INT, str VARCHAR)

SELECT id from tbl1 where a = 'foo'::UNION(num INT, str VARCHAR)
SELECT id FROM tbl1 WHERE (a = CAST('foo' AS UNION(num INTEGER, str VARCHAR)))




SELECT id from tbl1 where a = 'foo'::UNION(num INT, str VARCHAR)
SELECT union_tag('foo'::UNION(num INT, str VARCHAR))
SELECT union_tag('foo'::UNION(num INT, str VARCHAR))

SELECT union_tag('foo'::UNION(num INT, str VARCHAR))
SELECT union_tag(CAST('foo' AS UNION(num INTEGER, str VARCHAR)))




SELECT union_tag('foo'::UNION(num INT, str VARCHAR))
