PRAGMA enable_verification;
PRAGMA verify_parallelism;;
PRAGMA threads=4;;
CREATE TABLE test2 as SELECT i as a, (i*2) as b, power(i,2) as c from range(0,10) tbl(i);
CREATE TABLE test3 as SELECT i as a, (i*3) as b, power(i,3) as c from range(0,10) tbl(i);
CREATE TABLE test4 as SELECT i as a, (i*4) as b, power(i,4) as c from range(0,10) tbl(i);
CREATE TABLE test5 as SELECT i as a, (i*5) as b, power(i,5) as c from range(0,10) tbl(i);
CREATE TABLE testpto as SELECT i as a, (i*10) as b, (i*100) as c from range(0,10000) tbl(i);;
CREATE TABLE test2 as SELECT i as a, (i*2) as b, power(i,2) as c from range(0,10) tbl(i);
CREATE TABLE test3 as SELECT i as a, (i*3) as b, power(i,3) as c from range(0,10) tbl(i);
CREATE TABLE test4 as SELECT i as a, (i*4) as b, power(i,4) as c from range(0,10) tbl(i);
CREATE TABLE test5 as SELECT i as a, (i*5) as b, power(i,5) as c from range(0,10) tbl(i);
CREATE TABLE testpto as SELECT i as a, (i*10) as b, (i*100) as c from range(0,10000) tbl(i);;
CREATE TABLE test2 as SELECT i as a, (i*2) as b, power(i,2) as c from range(0,10) tbl(i);
CREATE TABLE test3 as SELECT i as a, (i*3) as b, power(i,3) as c from range(0,10) tbl(i);
CREATE TABLE test4 as SELECT i as a, (i*4) as b, power(i,4) as c from range(0,10) tbl(i);
CREATE TABLE test5 as SELECT i as a, (i*5) as b, power(i,5) as c from range(0,10) tbl(i);
CREATE TABLE testpto as SELECT i as a, (i*10) as b, (i*100) as c from range(0,10000) tbl(i);;
CREATE TABLE test2 as SELECT i as a, (i*2) as b, power(i,2) as c from range(0,10) tbl(i);
CREATE TABLE test3 as SELECT i as a, (i*3) as b, power(i,3) as c from range(0,10) tbl(i);
CREATE TABLE test4 as SELECT i as a, (i*4) as b, power(i,4) as c from range(0,10) tbl(i);
CREATE TABLE test5 as SELECT i as a, (i*5) as b, power(i,5) as c from range(0,10) tbl(i);
CREATE TABLE testpto as SELECT i as a, (i*10) as b, (i*100) as c from range(0,10000) tbl(i);;
CREATE TABLE test2 as SELECT i as a, (i*2) as b, power(i,2) as c from range(0,10) tbl(i);
CREATE TABLE test3 as SELECT i as a, (i*3) as b, power(i,3) as c from range(0,10) tbl(i);
CREATE TABLE test4 as SELECT i as a, (i*4) as b, power(i,4) as c from range(0,10) tbl(i);
CREATE TABLE test5 as SELECT i as a, (i*5) as b, power(i,5) as c from range(0,10) tbl(i);
CREATE TABLE testpto as SELECT i as a, (i*10) as b, (i*100) as c from range(0,10000) tbl(i);;
SELECT * FROM test2;;
SELECT * FROM test2;;
;
SELECT * FROM test2;;
SELECT * FROM test2;
;
;
;
;
SELECT * FROM test2;;
COPY test2 TO 'duckdb_unittest_tempdir/54491/part' (FORMAT PARQUET, PARTITION_BY (a), FILENAME_PATTERN "leading_{uuid}");;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????.parquet';;
COPY test3 TO 'duckdb_unittest_tempdir/54491/part' (FORMAT PARQUET, PARTITION_BY (a), overwrite_or_ignore TRUE, FILENAME_PATTERN "leading_{uuid}_trailing");;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????_trailing.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????_trailing.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????_trailing.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????_trailing.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????_trailing.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/leading_????????-????-4???-????-????????????*.parquet';;
COPY test4 TO 'duckdb_unittest_tempdir/54491/part' (FORMAT PARQUET, PARTITION_BY (a), overwrite_or_ignore TRUE);;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/data_[0-9]*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/data_[0-9]*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/data_[0-9]*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/data_[0-9]*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/data_[0-9]*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
COPY test5 TO 'duckdb_unittest_tempdir/54491/part' (FORMAT PARQUET, PARTITION_BY (a), overwrite_or_ignore TRUE, FILENAME_PATTERN "basename");;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/basename[0-9]*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/basename[0-9]*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/basename[0-9]*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/basename[0-9]*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/basename[0-9]*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/part/a=9/*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/part/a=9/*.parquet';;
COPY test5 TO 'duckdb_unittest_tempdir/54491/part' (FORMAT PARQUET, PARTITION_BY (a));;
COPY test4 TO 'duckdb_unittest_tempdir/54491/to_be_overwritten' (FORMAT PARQUET, PARTITION_BY (a), FILENAME_PATTERN);;
COPY test4 TO 'duckdb_unittest_tempdir/54491/to_be_overwritten' (FORMAT PARQUET, PARTITION_BY (a), FILENAME_PATTERN a_file_name);;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*');;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*');;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*');;
SELECT count_star() FROM glob('duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*');
;
;
;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*');;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten/a=9/a_file_name*.parquet';;
COPY test5 TO 'duckdb_unittest_tempdir/54491/incorrect_pos' (FORMAT PARQUET, PARTITION_BY (a), filename_pattern "a_name{i}_with_{uuid}_numbers");;
SELECT * FROM 'duckdb_unittest_tempdir/54491/incorrect_pos/a=5/a_name_with_????????-????-4???-????-????????????_numbers.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/incorrect_pos/a=5/a_name_with_????????-????-4???-????-????????????_numbers.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/incorrect_pos/a=5/a_name_with_????????-????-4???-????-????????????_numbers.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/incorrect_pos/a=5/a_name_with_????????-????-4???-????-????????????_numbers.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/incorrect_pos/a=5/a_name_with_????????-????-4???-????-????????????_numbers.parquet';;
COPY testpto TO 'duckdb_unittest_tempdir/54491/pto' (FORMAT PARQUET, PER_THREAD_OUTPUT TRUE, OVERWRITE_OR_IGNORE TRUE, FILENAME_PATTERN "basename_{uuid}");;
SELECT COUNT(*) FROM 'duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet';;
SELECT COUNT(*) FROM 'duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet';;
;
SELECT COUNT(*) FROM 'duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet';;
SELECT count_star() FROM "duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet";
;
;
;
;
SELECT COUNT(*) FROM 'duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet';;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet');;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet');;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet');;
SELECT count_star() FROM glob('duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet');
;
;
;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/pto/basename_????????-????-4???-????-????????????.parquet');;
PRAGMA threads=1;;
COPY test5 TO 'duckdb_unittest_tempdir/54491/to_be_overwritten2' (FORMAT PARQUET, PARTITION_BY (a), OVERWRITE_OR_IGNORE);;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/*');;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/*');;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/*');;
SELECT count_star() FROM glob('duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/*');
;
;
;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/*');;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/data_0*.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/data_0*.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/data_0*.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/data_0*.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/to_be_overwritten2/a=9/data_0*.parquet';;
COPY test5 TO 'duckdb_unittest_tempdir/54491/directory0' (FORMAT PARQUET, PARTITION_BY (a), overwrite_or_ignore TRUE, FILENAME_PATTERN "my_filename");;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/directory0/a=7/*');;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/directory0/a=7/*');;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/directory0/a=7/*');;
SELECT count_star() FROM glob('duckdb_unittest_tempdir/54491/directory0/a=7/*');
;
;
;
;
SELECT COUNT(*) FROM GLOB('duckdb_unittest_tempdir/54491/directory0/a=7/*');;
SELECT * FROM 'duckdb_unittest_tempdir/54491/directory0/a=7/my_filename0.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54491/directory0/a=7/my_filename0.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/directory0/a=7/my_filename0.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54491/directory0/a=7/my_filename0.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54491/directory0/a=7/my_filename0.parquet';;
