CREATE TABLE pkt(i INTEGER PRIMARY KEY);
CREATE TABLE fkt(j INTEGER, FOREIGN KEY (j) REFERENCES pkt(i));
BEGIN TRANSACTION;
INSERT INTO pkt VALUES (1);
INSERT INTO fkt VALUES (1);
ROLLBACK;
INSERT INTO pkt VALUES (1);
BEGIN TRANSACTION;
INSERT INTO pkt VALUES (2);
INSERT INTO fkt VALUES (3);
ROLLBACK;
BEGIN TRANSACTION;
INSERT INTO fkt VALUES (1);
DELETE FROM pkt WHERE i=1;
ROLLBACK;
BEGIN TRANSACTION;
DELETE FROM pkt WHERE i=1;
INSERT INTO fkt VALUES (1);
ROLLBACK;
BEGIN TRANSACTION;
INSERT INTO pkt VALUES (2);
INSERT INTO fkt VALUES (1), (2);
DELETE FROM fkt WHERE j=1;
DELETE FROM pkt WHERE i=1;
COMMIT;
DELETE FROM pkt WHERE i=2;
DELETE FROM fkt WHERE j=2;
DELETE FROM pkt WHERE i=2;
INSERT INTO pkt VALUES (3);
BEGIN TRANSACTION;
DELETE FROM pkt WHERE i=3;
INSERT INTO fkt VALUES (3);
ROLLBACK;
DROP TABLE pkt;;
DROP TABLE fkt;;
DROP TABLE pkt;;
BEGIN TRANSACTION;
CREATE TABLE a(i INTEGER PRIMARY KEY);
CREATE TABLE b(j INTEGER, FOREIGN KEY (j) REFERENCES a(i));
INSERT INTO a VALUES (1), (2);
INSERT INTO b VALUES (1), (2);
DELETE FROM b;
DELETE FROM a;
