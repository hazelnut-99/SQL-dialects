PRAGMA enable_verification;
select filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
select filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
;
select filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
SELECT split(filename.replace('\', '/'), '/')[-2] FROM read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', (HIVE_PARTITIONING = 1), (FILENAME = 1)) ORDER BY 1;
;
;
;
;
select filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
SELECT part, split(filename.replace('\', '/'), '/')[-2], "value" FROM read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', (HIVE_PARTITIONING = 1), (FILENAME = 1)) ORDER BY 1;
;
;
;
;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
SELECT part, split(filename.replace('\', '/'), '/')[-2], "value" FROM read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', (HIVE_PARTITIONING = 1), (FILENAME = 1), (UNION_BY_NAME = 1)) ORDER BY 1;
;
;
;
;
select part, filename.replace('\', '/').split('/')[-2], value from read_csv_auto('data/csv/hive-partitioning/simple/*/*/test.csv', HIVE_PARTITIONING=1,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
select * exclude(filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1)  order by 1;
select * exclude(filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1)  order by 1;
;
select * exclude(filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1)  order by 1;
select * exclude(filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1)  order by 1;
select * from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1,  UNION_BY_NAME=1)  order by 1;
select * from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1,  UNION_BY_NAME=1)  order by 1;
;
select * from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1,  UNION_BY_NAME=1)  order by 1;
SELECT * FROM read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', (HIVE_PARTITIONING = 1), (UNION_BY_NAME = 1)) ORDER BY 1;
;
;
;
;
select * from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1,  UNION_BY_NAME=1)  order by 1;
select * exclude(filename), filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
select * exclude(filename), filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
;
select * exclude(filename), filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
SELECT * EXCLUDE (filename), split(filename.replace('\', '/'), '/')[-2] FROM read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', (HIVE_PARTITIONING = 1), (FILENAME = 1), (UNION_BY_NAME = 1)) ORDER BY 1;
;
;
;
;
select * exclude(filename), filename.replace('\', '/').split('/')[-2] from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], a, b from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
select part, filename.replace('\', '/').split('/')[-2], a, b from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
;
select part, filename.replace('\', '/').split('/')[-2], a, b from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
SELECT part, split(filename.replace('\', '/'), '/')[-2], a, b FROM read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', (HIVE_PARTITIONING = 1), (FILENAME = 1), (UNION_BY_NAME = 1)) ORDER BY 1;
;
;
;
;
select part, filename.replace('\', '/').split('/')[-2], a, b from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=1, FILENAME=1, UNION_BY_NAME=1)  order by 1;
select * exclude (filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=0,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
select * exclude (filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=0,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
;
select * exclude (filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=0,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
SELECT * EXCLUDE (filename) FROM read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', (HIVE_PARTITIONING = 0), (FILENAME = 1), (UNION_BY_NAME = 1)) ORDER BY 1;
;
;
;
;
select * exclude (filename) from read_csv_auto('data/csv/hive-partitioning/mismatching_types/*/*.csv', HIVE_PARTITIONING=0,  FILENAME=1, UNION_BY_NAME=1)  order by 1;
select * from read_csv_auto(['data/csv/hive-partitioning/mismatching_contents/part=1/test.csv', 'data/csv/hive-partitioning/mismatching_contents/part=2/test.csv'])  order by 1;
select * from read_csv_auto(['data/csv/hive-partitioning/mismatching_contents/part=1/test.csv', 'data/csv/hive-partitioning/mismatching_contents/part=2/test.csv'])  order by 1;
;
select * from read_csv_auto(['data/csv/hive-partitioning/mismatching_contents/part=1/test.csv', 'data/csv/hive-partitioning/mismatching_contents/part=2/test.csv'])  order by 1;
select * from read_csv_auto(['data/csv/hive-partitioning/mismatching_contents/part=1/test.csv', 'data/csv/hive-partitioning/mismatching_contents/part=2/test.csv'])  order by 1;
select a, b, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', UNION_BY_NAME=1)  order by 2 NULLS LAST;
select a, b, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', UNION_BY_NAME=1)  order by 2 NULLS LAST;
;
select a, b, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', UNION_BY_NAME=1)  order by 2 NULLS LAST;
SELECT a, b, c FROM read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', (UNION_BY_NAME = 1)) ORDER BY 2 NULLS LAST;
;
;
;
;
select a, b, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', UNION_BY_NAME=1)  order by 2 NULLS LAST;
select a, b, part, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv',  UNION_BY_NAME=1, HIVE_PARTITIONING=1)  order by 2 NULLS LAST;
select a, b, part, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv',  UNION_BY_NAME=1, HIVE_PARTITIONING=1)  order by 2 NULLS LAST;
;
select a, b, part, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv',  UNION_BY_NAME=1, HIVE_PARTITIONING=1)  order by 2 NULLS LAST;
SELECT a, b, part, c FROM read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv', (UNION_BY_NAME = 1), (HIVE_PARTITIONING = 1)) ORDER BY 2 NULLS LAST;
;
;
;
;
select a, b, part, c from read_csv_auto('data/csv/hive-partitioning/mismatching_contents/*/*.csv',  UNION_BY_NAME=1, HIVE_PARTITIONING=1)  order by 2 NULLS LAST;
