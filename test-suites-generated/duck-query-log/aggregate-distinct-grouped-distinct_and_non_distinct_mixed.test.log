PRAGMA enable_verification;
create table tbl as
	(select i%50 as i, i%100 as j, i%5 as groups from range(50000) tbl(i))
;;
select
	count(distinct i)
from tbl group by groups;;;
select
	count(distinct i)
from tbl group by groups;;;
;
select
	count(distinct i)
from tbl group by groups;;;
SELECT count(DISTINCT i) FROM tbl GROUP BY "groups";
;
;
;
;
select
	count(distinct i)
from tbl group by groups;;;
select
	sum(distinct i),
	sum(i),
	sum(j)
from tbl group by groups;;;
select
	sum(distinct i),
	sum(i),
	sum(j)
from tbl group by groups;;;
;
select
	sum(distinct i),
	sum(i),
	sum(j)
from tbl group by groups;;;
SELECT sum(DISTINCT i), sum(i), sum(j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i),
	sum(i),
	sum(j)
from tbl group by groups;;;
select
	sum(i),
	sum(j),
	sum(distinct i)
from tbl group by groups;;;
select
	sum(i),
	sum(j),
	sum(distinct i)
from tbl group by groups;;;
;
select
	sum(i),
	sum(j),
	sum(distinct i)
from tbl group by groups;;;
SELECT sum(i), sum(j), sum(DISTINCT i) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(i),
	sum(j),
	sum(distinct i)
from tbl group by groups;;;
select
	sum(i),
	sum(distinct i),
	sum(j)
from tbl group by groups;;;
select
	sum(i),
	sum(distinct i),
	sum(j)
from tbl group by groups;;;
;
select
	sum(i),
	sum(distinct i),
	sum(j)
from tbl group by groups;;;
SELECT sum(i), sum(DISTINCT i), sum(j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(i),
	sum(distinct i),
	sum(j)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
SELECT sum(DISTINCT i), count(j), sum(DISTINCT j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
SELECT sum(j), sum(DISTINCT i), count(j), sum(DISTINCT j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
SELECT sum(j), sum(DISTINCT i), count(j), sum(DISTINCT j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(j),
	sum(distinct i),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j),
	sum(j)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j),
	sum(j)
from tbl group by groups;;;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j),
	sum(j)
from tbl group by groups;;;
SELECT sum(DISTINCT i), count(j), sum(DISTINCT j), sum(j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j),
	sum(j)
from tbl group by groups;;;
select
	count(distinct i) FILTER (WHERE i >= 20)
from tbl group by groups;;;
select
	count(distinct i) FILTER (WHERE i >= 20)
from tbl group by groups;;;
;
select
	count(distinct i) FILTER (WHERE i >= 20)
from tbl group by groups;;;
SELECT count(DISTINCT i) FILTER (WHERE (i >= 20)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	count(distinct i) FILTER (WHERE i >= 20)
from tbl group by groups;;;
select
	sum(distinct i),
	sum(i) FILTER (WHERE j < 20),
	sum(j) FILTER (WHERE i >= 20)
from tbl group by groups;;;
select
	sum(distinct i),
	sum(i) FILTER (WHERE j < 20),
	sum(j) FILTER (WHERE i >= 20)
from tbl group by groups;;;
;
select
	sum(distinct i),
	sum(i) FILTER (WHERE j < 20),
	sum(j) FILTER (WHERE i >= 20)
from tbl group by groups;;;
SELECT sum(DISTINCT i), sum(i) FILTER (WHERE (j < 20)), sum(j) FILTER (WHERE (i >= 20)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i),
	sum(i) FILTER (WHERE j < 20),
	sum(j) FILTER (WHERE i >= 20)
from tbl group by groups;;;
select
	sum(i),
	sum(j) FILTER (WHERE j == 0),
	sum(distinct i) FILTER (WHERE i == 0)
from tbl group by groups;;;
select
	sum(i),
	sum(j) FILTER (WHERE j == 0),
	sum(distinct i) FILTER (WHERE i == 0)
from tbl group by groups;;;
;
select
	sum(i),
	sum(j) FILTER (WHERE j == 0),
	sum(distinct i) FILTER (WHERE i == 0)
from tbl group by groups;;;
SELECT sum(i), sum(j) FILTER (WHERE (j = 0)), sum(DISTINCT i) FILTER (WHERE (i = 0)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(i),
	sum(j) FILTER (WHERE j == 0),
	sum(distinct i) FILTER (WHERE i == 0)
from tbl group by groups;;;
select
	sum(i) FILTER (WHERE j == 5),
	sum(distinct i),
	sum(j) FILTER (WHERE i == 5)
from tbl group by groups;;;
select
	sum(i) FILTER (WHERE j == 5),
	sum(distinct i),
	sum(j) FILTER (WHERE i == 5)
from tbl group by groups;;;
;
select
	sum(i) FILTER (WHERE j == 5),
	sum(distinct i),
	sum(j) FILTER (WHERE i == 5)
from tbl group by groups;;;
SELECT sum(i) FILTER (WHERE (j = 5)), sum(DISTINCT i), sum(j) FILTER (WHERE (i = 5)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(i) FILTER (WHERE j == 5),
	sum(distinct i),
	sum(j) FILTER (WHERE i == 5)
from tbl group by groups;;;
select
	sum(distinct i) FILTER (WHERE i == 5),
	count(j),
	sum(distinct j) FILTER (WHERE i == 5)
from tbl group by groups;;;
select
	sum(distinct i) FILTER (WHERE i == 5),
	count(j),
	sum(distinct j) FILTER (WHERE i == 5)
from tbl group by groups;;;
;
select
	sum(distinct i) FILTER (WHERE i == 5),
	count(j),
	sum(distinct j) FILTER (WHERE i == 5)
from tbl group by groups;;;
SELECT sum(DISTINCT i) FILTER (WHERE (i = 5)), count(j), sum(DISTINCT j) FILTER (WHERE (i = 5)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i) FILTER (WHERE i == 5),
	count(j),
	sum(distinct j) FILTER (WHERE i == 5)
from tbl group by groups;;;
select
	sum(j) FILTER (WHERE j == 5),
	sum(distinct i) FILTER (WHERE j == 5),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j) FILTER (WHERE j == 5),
	sum(distinct i) FILTER (WHERE j == 5),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
;
select
	sum(j) FILTER (WHERE j == 5),
	sum(distinct i) FILTER (WHERE j == 5),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
SELECT sum(j) FILTER (WHERE (j = 5)), sum(DISTINCT i) FILTER (WHERE (j = 5)), count(j), sum(DISTINCT j) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(j) FILTER (WHERE j == 5),
	sum(distinct i) FILTER (WHERE j == 5),
	count(j),
	sum(distinct j)
from tbl group by groups;;;
select
	sum(j) FILTER (WHERE i == 5),
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5)
from tbl group by groups;;;
select
	sum(j) FILTER (WHERE i == 5),
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5)
from tbl group by groups;;;
;
select
	sum(j) FILTER (WHERE i == 5),
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5)
from tbl group by groups;;;
SELECT sum(j) FILTER (WHERE (i = 5)), sum(DISTINCT i), count(j), sum(DISTINCT j) FILTER (WHERE (j = 5)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(j) FILTER (WHERE i == 5),
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5),
	sum(j) FILTER (WHERE j == 5)
from tbl group by groups;;;
select
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5),
	sum(j) FILTER (WHERE j == 5)
from tbl group by groups;;;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5),
	sum(j) FILTER (WHERE j == 5)
from tbl group by groups;;;
SELECT sum(DISTINCT i), count(j), sum(DISTINCT j) FILTER (WHERE (j = 5)), sum(j) FILTER (WHERE (j = 5)) FROM tbl GROUP BY "groups";
;
;
;
;
select
	sum(distinct i),
	count(j),
	sum(distinct j) FILTER (WHERE j == 5),
	sum(j) FILTER (WHERE j == 5)
from tbl group by groups;;;
