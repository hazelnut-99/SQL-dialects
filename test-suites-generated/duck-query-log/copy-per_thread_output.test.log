PRAGMA verify_parallelism;;
pragma threads=4;;
CREATE TABLE bigdata AS SELECT i AS col_a, i AS col_b FROM range(0,10000) tbl(i);;
COPY (FROM bigdata) TO 'duckdb_unittest_tempdir/54485/per_thread_output' (FORMAT PARQUET, PER_THREAD_OUTPUT TRUE);;
SELECT COUNT(*) FROM PARQUET_SCAN('duckdb_unittest_tempdir/54485/per_thread_output/*.parquet');
SELECT STR_SPLIT(REPLACE(file, '\','/'), '/')[-1]  f FROM GLOB('duckdb_unittest_tempdir/54485/per_thread_output/*.parquet') ORDER BY f;
COPY (FROM bigdata) TO 'duckdb_unittest_tempdir/54485/per_thread_output_csv' (FORMAT CSV,  PER_THREAD_OUTPUT TRUE);;
SELECT COUNT(*) FROM read_csv('duckdb_unittest_tempdir/54485/per_thread_output_csv/*.csv', columns={'col_a': 'INT', 'col_b' : 'INT'});;
SELECT STR_SPLIT(REPLACE(file, '\','/'), '/')[-1]  f FROM GLOB('duckdb_unittest_tempdir/54485/per_thread_output_csv/*.csv') ORDER BY f;
COPY (FROM bigdata) TO 'duckdb_unittest_tempdir/54485/per_thread_output2/' (FORMAT PARQUET, PER_THREAD_OUTPUT TRUE);;
SELECT COUNT(*) FROM PARQUET_SCAN('duckdb_unittest_tempdir/54485/per_thread_output2/*.parquet');
COPY (FROM bigdata) TO 'duckdb_unittest_tempdir/54485/per_thread_output2/' (FORMAT PARQUET, PER_THREAD_OUTPUT TRUE);;
SELECT COUNT(*) FROM PARQUET_SCAN('duckdb_unittest_tempdir/54485/per_thread_output2/*.parquet');
COPY (FROM bigdata) TO 'duckdb_unittest_tempdir/54485/per_thread_output3' (FORMAT PARQUET, PER_THREAD_OUTPUT TRUE, USE_TMP_FILE TRUE);;
