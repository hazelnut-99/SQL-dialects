PRAGMA enable_verification;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, y_i) -> x + y + y_i));;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, y_i) -> x + y + y_i));;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, y_i) -> x + y + y_i));;
SELECT list_transform(main.list_value(1, 2, 3), (x -> list_transform(main.list_value(4, 5, 6), (main.row(y, y_i) -> ((x + y) + y_i)))));
;
;
;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, y_i) -> x + y + y_i));;
SELECT list_transform(['abc'], (x, i) -> x[i + 1]);;
SELECT list_transform(['abc'], (x, i) -> x[i + 1]);;
;
SELECT list_transform(['abc'], (x, i) -> x[i + 1]);;
SELECT list_transform(main.list_value('abc'), (main.row(x, i) -> x[(i + 1)]));
;
;
;
;
SELECT list_transform(['abc'], (x, i) -> x[i + 1]);;
SELECT list_filter([1, 2, 1], (x, y) -> x >= y);;
SELECT list_filter([1, 2, 1], (x, y) -> x >= y);;
;
SELECT list_filter([1, 2, 1], (x, y) -> x >= y);;
SELECT list_filter(main.list_value(1, 2, 1), (main.row(x, y) -> (x >= y)));
;
;
;
;
SELECT list_filter([1, 2, 1], (x, y) -> x >= y);;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], (z, i) -> x + y + z + i)));;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], (z, i) -> x + y + z + i)));;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], (z, i) -> x + y + z + i)));;
SELECT list_transform(main.list_value(1, 2, 3), (x -> list_transform(main.list_value(4, 5, 6), (y -> list_transform(main.list_value(7, 8, 9), (main.row(z, i) -> (((x + y) + z) + i)))))));
;
;
;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], (z, i) -> x + y + z + i)));;
SELECT list_transform([10, 20, 30], (x, i) -> x + i);;
SELECT list_transform([10, 20, 30], (x, i) -> x + i);;
;
SELECT list_transform([10, 20, 30], (x, i) -> x + i);;
SELECT list_transform(main.list_value(10, 20, 30), (main.row(x, i) -> (x + i)));
;
;
;
;
SELECT list_transform([10, 20, 30], (x, i) -> x + i);;
SELECT list_transform([1, 2, 3, 4, 5, 6], (x, i) -> x * i);;
SELECT list_transform([1, 2, 3, 4, 5, 6], (x, i) -> x * i);;
;
SELECT list_transform([1, 2, 3, 4, 5, 6], (x, i) -> x * i);;
SELECT list_transform(main.list_value(1, 2, 3, 4, 5, 6), (main.row(x, i) -> (x * i)));
;
;
;
;
SELECT list_transform([1, 2, 3, 4, 5, 6], (x, i) -> x * i);;
SELECT list_transform([6, 5, 4, 3, 2, 1], (x, i) -> x * i);;
SELECT list_transform([6, 5, 4, 3, 2, 1], (x, i) -> x * i);;
;
SELECT list_transform([6, 5, 4, 3, 2, 1], (x, i) -> x * i);;
SELECT list_transform(main.list_value(6, 5, 4, 3, 2, 1), (main.row(x, i) -> (x * i)));
;
;
;
;
SELECT list_transform([6, 5, 4, 3, 2, 1], (x, i) -> x * i);;
SELECT list_transform([1, NULL, 3, 4, 5, 6], (x, i) -> x + i);;
SELECT list_transform([1, NULL, 3, 4, 5, 6], (x, i) -> x + i);;
;
SELECT list_transform([1, NULL, 3, 4, 5, 6], (x, i) -> x + i);;
SELECT list_transform(main.list_value(1, NULL, 3, 4, 5, 6), (main.row(x, i) -> (x + i)));
;
;
;
;
SELECT list_transform([1, NULL, 3, 4, 5, 6], (x, i) -> x + i);;
SELECT list_transform(NULL, (x, i) -> x + i);;
SELECT list_transform(NULL, (x, i) -> x + i);;
;
SELECT list_transform(NULL, (x, i) -> x + i);;
SELECT list_transform(NULL, (main.row(x, i) -> (x + i)));
;
;
;
;
SELECT list_transform(NULL, (x, i) -> x + i);;
SELECT list_transform(['1', '2', '3', '4'], (x, i) -> (x || ' + ' || CAST(i AS string)));;
SELECT list_transform(['1', '2', '3', '4'], (x, i) -> (x || ' + ' || CAST(i AS string)));;
;
SELECT list_transform(['1', '2', '3', '4'], (x, i) -> (x || ' + ' || CAST(i AS string)));;
SELECT list_transform(main.list_value('1', '2', '3', '4'), (main.row(x, i) -> ((x || ' + ') || CAST(i AS VARCHAR))));
;
;
;
;
SELECT list_transform(['1', '2', '3', '4'], (x, i) -> (x || ' + ' || CAST(i AS string)));;
SELECT list_transform([1,2,3,4,5], (x, i) -> (x * 10 / i));;
SELECT list_transform([1,2,3,4,5], (x, i) -> (x * 10 / i));;
;
SELECT list_transform([1,2,3,4,5], (x, i) -> (x * 10 / i));;
SELECT list_transform(main.list_value(1, 2, 3, 4, 5), (main.row(x, i) -> ((x * 10) / i)));
;
;
;
;
SELECT list_transform([1,2,3,4,5], (x, i) -> (x * 10 / i));;
CREATE TABLE tbl(a int[]);;
INSERT INTO tbl VALUES ([5, 4, 3]), ([1, 2, 3]), (NULL), ([NULL, 101, 12]);;
SELECT list_transform(a, (x, i) -> x + i) FROM tbl;;
SELECT list_transform(a, (x, i) -> x + i) FROM tbl;;
;
SELECT list_transform(a, (x, i) -> x + i) FROM tbl;;
SELECT list_transform(a, (main.row(x, i) -> (x + i))) FROM tbl;
;
;
;
;
SELECT list_transform(a, (x, i) -> x + i) FROM tbl;;
SELECT list_transform(a, (x, i) -> x + i + list_any_value(a)) FROM tbl;;
SELECT list_transform(a, (x, i) -> x + i + list_any_value(a)) FROM tbl;;
;
SELECT list_transform(a, (x, i) -> x + i + list_any_value(a)) FROM tbl;;
SELECT list_transform(a, (main.row(x, i) -> ((x + i) + list_any_value(a)))) FROM tbl;
;
;
;
;
SELECT list_transform(a, (x, i) -> x + i + list_any_value(a)) FROM tbl;;
DROP TABLE tbl;;
CREATE TABLE tbl(a int[], b int, c int);;
INSERT INTO tbl VALUES ([5,4,3], 5, 10), ([1,2,3], 7, 14), (NULL, 9, 18), ([10,NULL,12], 11, 22);;
SELECT list_transform(a, (x, i) -> (c / b ) * (x + i)) FROM tbl;;
SELECT list_transform(a, (x, i) -> (c / b ) * (x + i)) FROM tbl;;
;
SELECT list_transform(a, (x, i) -> (c / b ) * (x + i)) FROM tbl;;
SELECT list_transform(a, (main.row(x, i) -> ((c / b) * (x + i)))) FROM tbl;
;
;
;
;
SELECT list_transform(a, (x, i) -> (c / b ) * (x + i)) FROM tbl;;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], y -> x + y + x_i));;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], y -> x + y + x_i));;
;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], y -> x + y + x_i));;
SELECT list_transform(main.list_value(1, 2, 3), (main.row(x, x_i) -> list_transform(main.list_value(4, 5, 6), (y -> ((x + y) + x_i)))));
;
;
;
;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], y -> x + y + x_i));;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], (y, y_i) -> x + y + x_i + y_i));;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], (y, y_i) -> x + y + x_i + y_i));;
;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], (y, y_i) -> x + y + x_i + y_i));;
SELECT list_transform(main.list_value(1, 2, 3), (main.row(x, x_i) -> list_transform(main.list_value(4, 5, 6), (main.row(y, y_i) -> (((x + y) + x_i) + y_i)))));
;
;
;
;
SELECT list_transform([1, 2, 3], (x, x_i) -> list_transform([4, 5, 6], (y, y_i) -> x + y + x_i + y_i));;
SELECT list_transform([1, 2, 3], (x, i) -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], z -> x + y + z + i)));;
SELECT list_transform([1, 2, 3], (x, i) -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], z -> x + y + z + i)));;
;
SELECT list_transform([1, 2, 3], (x, i) -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], z -> x + y + z + i)));;
SELECT list_transform(main.list_value(1, 2, 3), (main.row(x, i) -> list_transform(main.list_value(4, 5, 6), (y -> list_transform(main.list_value(7, 8, 9), (z -> (((x + y) + z) + i)))))));
;
;
;
;
SELECT list_transform([1, 2, 3], (x, i) -> list_transform([4, 5, 6], y -> list_transform([7, 8, 9], z -> x + y + z + i)));;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, i) -> list_transform([7, 8, 9], z -> x + y + z + i)));;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, i) -> list_transform([7, 8, 9], z -> x + y + z + i)));;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, i) -> list_transform([7, 8, 9], z -> x + y + z + i)));;
SELECT list_transform(main.list_value(1, 2, 3), (x -> list_transform(main.list_value(4, 5, 6), (main.row(y, i) -> list_transform(main.list_value(7, 8, 9), (z -> (((x + y) + z) + i)))))));
;
;
;
;
SELECT list_transform([1, 2, 3], x -> list_transform([4, 5, 6], (y, i) -> list_transform([7, 8, 9], z -> x + y + z + i)));;
