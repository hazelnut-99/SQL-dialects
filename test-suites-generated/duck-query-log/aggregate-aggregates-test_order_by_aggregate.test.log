PRAGMA enable_verification;
CREATE TABLE integers(grp INTEGER, i INTEGER);;
INSERT INTO integers VALUES (1, 10), (2, 15), (1, 30), (2, 20);
SELECT FIRST(i ORDER BY i) FROM integers;
SELECT FIRST(i ORDER BY i) FROM integers;
;
SELECT FIRST(i ORDER BY i) FROM integers;
SELECT first(i ORDER BY i) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i) FROM integers;
SELECT FIRST(i ORDER BY i, i, i) FROM integers;
SELECT FIRST(i ORDER BY i, i, i) FROM integers;
;
SELECT FIRST(i ORDER BY i, i, i) FROM integers;
SELECT first(i ORDER BY i, i, i) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i, i, i) FROM integers;
SELECT FIRST(i ORDER BY i, i DESC, i) FROM integers;
SELECT FIRST(i ORDER BY i, i DESC, i) FROM integers;
;
SELECT FIRST(i ORDER BY i, i DESC, i) FROM integers;
SELECT first(i ORDER BY i, i DESC, i) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i, i DESC, i) FROM integers;
SELECT FIRST(i ORDER BY i DESC) FROM integers;
SELECT FIRST(i ORDER BY i DESC) FROM integers;
;
SELECT FIRST(i ORDER BY i DESC) FROM integers;
SELECT first(i ORDER BY i DESC) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i DESC) FROM integers;
SELECT FIRST(i ORDER BY i DESC, i ASC) FROM integers;
SELECT FIRST(i ORDER BY i DESC, i ASC) FROM integers;
;
SELECT FIRST(i ORDER BY i DESC, i ASC) FROM integers;
SELECT first(i ORDER BY i DESC, i ASC) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i DESC, i ASC) FROM integers;
SELECT FIRST(i ORDER BY i), FIRST(i ORDER BY i DESC) FROM integers;
SELECT FIRST(i ORDER BY i), FIRST(i ORDER BY i DESC) FROM integers;
;
SELECT FIRST(i ORDER BY i), FIRST(i ORDER BY i DESC) FROM integers;
SELECT first(i ORDER BY i), first(i ORDER BY i DESC) FROM integers;
;
;
;
;
SELECT FIRST(i ORDER BY i), FIRST(i ORDER BY i DESC) FROM integers;
SELECT grp, FIRST(i ORDER BY i) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, FIRST(i ORDER BY i) FROM integers GROUP BY grp ORDER BY ALL;
;
SELECT grp, FIRST(i ORDER BY i) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, first(i ORDER BY i) FROM integers GROUP BY grp ORDER BY COLUMNS(*);
;
;
;
;
SELECT grp, FIRST(i ORDER BY i) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, FIRST(i ORDER BY grp, i, grp DESC, i DESC) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, FIRST(i ORDER BY grp, i, grp DESC, i DESC) FROM integers GROUP BY grp ORDER BY ALL;
;
SELECT grp, FIRST(i ORDER BY grp, i, grp DESC, i DESC) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, first(i ORDER BY grp, i, grp DESC, i DESC) FROM integers GROUP BY grp ORDER BY COLUMNS(*);
;
;
;
;
SELECT grp, FIRST(i ORDER BY grp, i, grp DESC, i DESC) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, FIRST(i ORDER BY i DESC) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, FIRST(i ORDER BY i DESC) FROM integers GROUP BY grp ORDER BY ALL;
;
SELECT grp, FIRST(i ORDER BY i DESC) FROM integers GROUP BY grp ORDER BY ALL;
SELECT grp, first(i ORDER BY i DESC) FROM integers GROUP BY grp ORDER BY COLUMNS(*);
;
;
;
;
SELECT grp, FIRST(i ORDER BY i DESC) FROM integers GROUP BY grp ORDER BY ALL;
CREATE TABLE user_causes (
    user_id INT,
    cause VARCHAR,
    "date" DATE
);;
INSERT INTO user_causes (user_id, cause, "date") VALUES
(1, 'Environmental', '2024-03-18'),
(1, 'Environmental', '2024-02-18'),
(1, 'Health', '2024-01-18'),
(1, 'Social', '2023-12-18'),
(1, NULL, '2023-11-19');;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY "date" DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY "date" DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY "date" DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY "date" DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY cause DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY cause DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY cause DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
SELECT user_id, list_sort(list(DISTINCT cause) FILTER (WHERE (cause IS NOT NULL)), 'DESCENDING', 'ORDER_DEFAULT') AS causes FROM user_causes GROUP BY user_id;
;
;
;
SELECT 
    user_id, 
    list(DISTINCT cause ORDER BY cause DESC) FILTER(cause IS NOT NULL) AS causes
FROM user_causes 
GROUP BY user_id;;
