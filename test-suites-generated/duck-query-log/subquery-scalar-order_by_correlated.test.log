SET default_null_order='nulls_first';;
PRAGMA enable_verification;
CREATE TABLE integers(i INTEGER);;
INSERT INTO integers VALUES (1), (2), (3), (NULL);;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i ASC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i ASC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i ASC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, (SELECT * FROM integers WHERE (i > i1.i) ORDER BY i ASC NULLS FIRST LIMIT 1) AS top FROM integers AS i1 ORDER BY i;
;
;
;
;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i ASC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i DESC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i DESC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i DESC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, (SELECT * FROM integers WHERE (i > i1.i) ORDER BY i DESC NULLS FIRST LIMIT 1) AS top FROM integers AS i1 ORDER BY i;
;
;
;
;
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i DESC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i;
SELECT i, ARRAY(
	SELECT * FROM integers WHERE i>i1.i ORDER BY i
) top
FROM integers i1
ORDER BY i;
SELECT i, ARRAY(
	SELECT * FROM integers WHERE i>i1.i ORDER BY i
) top
FROM integers i1
ORDER BY i;
;
SELECT i, ARRAY(
	SELECT * FROM integers WHERE i>i1.i ORDER BY i
) top
FROM integers i1
ORDER BY i;
SELECT i, (SELECT CASE  WHEN ((array_agg(COLUMNS(*) ORDER BY i) IS NULL)) THEN (list_value()) ELSE array_agg(COLUMNS(*) ORDER BY i) END FROM (SELECT * FROM integers WHERE (i > i1.i) ORDER BY i)) AS top FROM integers AS i1 ORDER BY i;
;
;
;
;
SELECT i, ARRAY(
	SELECT * FROM integers WHERE i>i1.i ORDER BY i
) top
FROM integers i1
ORDER BY i;
