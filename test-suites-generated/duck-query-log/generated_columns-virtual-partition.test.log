PRAGMA enable_verification;
CREATE TABLE unit (
	price INTEGER,
	amount_sold INTEGER,
	name VARCHAR,
	total_profit AS (price * amount_sold)
);;
INSERT INTO unit VALUES (5,4, 'Soda can');
INSERT INTO unit VALUES (5,8, 'Mars bar');
INSERT INTO unit VALUES (4, 5, 'Chewing gum');
SELECT total_profit, COUNT(total_profit), SUM(amount_sold), SUM(price) FROM unit GROUP BY total_profit ORDER BY ALL;
SELECT total_profit, COUNT(total_profit), SUM(amount_sold), SUM(price) FROM unit GROUP BY total_profit ORDER BY ALL;
;
SELECT total_profit, COUNT(total_profit), SUM(amount_sold), SUM(price) FROM unit GROUP BY total_profit ORDER BY ALL;
SELECT total_profit, count(total_profit), sum(amount_sold), sum(price) FROM unit GROUP BY total_profit ORDER BY COLUMNS(*);
;
;
;
;
SELECT total_profit, COUNT(total_profit), SUM(amount_sold), SUM(price) FROM unit GROUP BY total_profit ORDER BY ALL;
SELECT total_profit,
		name,
		COUNT(total_profit) OVER(PARTITION BY total_profit) AS CountTotalProfit,
		SUM(amount_sold) OVER(PARTITION BY total_profit) AS SumAmountSold,
		SUM(price) OVER(PARTITION BY total_profit) AS SumPrice
FROM unit
ORDER BY 1, 2 DESC;
SELECT total_profit,
		name,
		COUNT(total_profit) OVER(PARTITION BY total_profit) AS CountTotalProfit,
		SUM(amount_sold) OVER(PARTITION BY total_profit) AS SumAmountSold,
		SUM(price) OVER(PARTITION BY total_profit) AS SumPrice
FROM unit
ORDER BY 1, 2 DESC;
;
SELECT total_profit,
		name,
		COUNT(total_profit) OVER(PARTITION BY total_profit) AS CountTotalProfit,
		SUM(amount_sold) OVER(PARTITION BY total_profit) AS SumAmountSold,
		SUM(price) OVER(PARTITION BY total_profit) AS SumPrice
FROM unit
ORDER BY 1, 2 DESC;
SELECT total_profit, "name", count(total_profit) OVER (PARTITION BY total_profit) AS CountTotalProfit, sum(amount_sold) OVER (PARTITION BY total_profit) AS SumAmountSold, sum(price) OVER (PARTITION BY total_profit) AS SumPrice FROM unit ORDER BY 1, 2 DESC;
;
;
;
SELECT total_profit,
		name,
		COUNT(total_profit) OVER(PARTITION BY total_profit) AS CountTotalProfit,
		SUM(amount_sold) OVER(PARTITION BY total_profit) AS SumAmountSold,
		SUM(price) OVER(PARTITION BY total_profit) AS SumPrice
FROM unit
ORDER BY 1, 2 DESC;
