pragma enable_verification;
pragma verify_parallelism;
WITH evs AS (
  SELECT * FROM (VALUES
    ('1','123','7'),
    ('1','456','7')
  ) AS t("id", "type", "value" )
)
SELECT "id"
, COUNT(DISTINCT "value") FILTER (WHERE "type" = '456') AS type_456_count
FROM evs
GROUP BY "id";
WITH evs AS (
  SELECT * FROM (VALUES
    ('1','123','7'),
    ('1','456','7')
  ) AS t("id", "type", "value" )
)
SELECT "id"
, COUNT(DISTINCT "value") FILTER (WHERE "type" = '456') AS type_456_count
FROM evs
GROUP BY "id";
;
WITH evs AS (
  SELECT * FROM (VALUES
    ('1','123','7'),
    ('1','456','7')
  ) AS t("id", "type", "value" )
)
SELECT "id"
, COUNT(DISTINCT "value") FILTER (WHERE "type" = '456') AS type_456_count
FROM evs
GROUP BY "id";
WITH evs AS (SELECT * FROM (SELECT * FROM (VALUES ('1', '123', '7'), ('1', '456', '7')) AS valueslist) AS t(id, "type", "value"))SELECT id, count(DISTINCT "value") FILTER (WHERE ("type" = '456')) AS type_456_count FROM evs GROUP BY id;
;
;
;
;
WITH evs AS (
  SELECT * FROM (VALUES
    ('1','123','7'),
    ('1','456','7')
  ) AS t("id", "type", "value" )
)
SELECT "id"
, COUNT(DISTINCT "value") FILTER (WHERE "type" = '456') AS type_456_count
FROM evs
GROUP BY "id";
