SET default_null_order='nulls_first';;
PRAGMA enable_verification;
PRAGMA verify_external;
select mode();
select mode();
;
select mode();
select mode();
select mode();
select mode(NULL);
select mode(NULL);
;
select mode(NULL);
select mode(NULL);
SELECT mode(NULL);
;
;
;
;
select mode(NULL);
select mode(1);
select mode(1);
;
select mode(1);
select mode(1);
SELECT mode(1);
;
;
;
;
select mode(1);
select mode(*);
select mode(*);
;
select mode(*);
select mode(*);
select mode(*);
create table aggr(k int, v decimal(10,2));;
insert into aggr (k, v) values (1, 10), (1, 10), (1, 20), (1, 21);;
select mode(v) from aggr;;
select mode(v) from aggr;;
;
select mode(v) from aggr;;
select mode(v) from aggr;;
SELECT mode(v) FROM aggr;
;
;
;
;
select mode(v) from aggr;;
SELECT mode(2) FROM range(100);;
SELECT mode(2) FROM range(100);;
;
SELECT mode(2) FROM range(100);;
SELECT mode(2) FROM range(100);;
SELECT mode(2) FROM range(100);
;
;
;
;
SELECT mode(2) FROM range(100);;
insert into aggr (k, v) values (2, 20),(2, 20), (2, 25), (2, 30);;
SELECT CASE
       WHEN ( value = 10 or value = 20)
            THEN TRUE
            ELSE FALSE
       END
       FROM (select mode(v) as value from aggr) AS T;
SELECT CASE
       WHEN ( value = 10 or value = 20)
            THEN TRUE
            ELSE FALSE
       END
       FROM (select mode(v) as value from aggr) AS T;
;
SELECT CASE
       WHEN ( value = 10 or value = 20)
            THEN TRUE
            ELSE FALSE
       END
       FROM (select mode(v) as value from aggr) AS T;
SELECT CASE
       WHEN ( value = 10 or value = 20)
            THEN TRUE
            ELSE FALSE
       END
       FROM (select mode(v) as value from aggr) AS T;
SELECT CASE  WHEN ((("value" = 10) OR ("value" = 20))) THEN (CAST('t' AS BOOLEAN)) ELSE CAST('f' AS BOOLEAN) END FROM (SELECT mode(v) AS "value" FROM aggr) AS T;
;
;
;
;
SELECT CASE
       WHEN ( value = 10 or value = 20)
            THEN TRUE
            ELSE FALSE
       END
       FROM (select mode(v) as value from aggr) AS T;
insert into aggr (k, v) values (3, null);;
select k, mode(v)
    from aggr
    group by k
    order by k;;
select k, mode(v)
    from aggr
    group by k
    order by k;;
;
select k, mode(v)
    from aggr
    group by k
    order by k;;
select k, mode(v)
    from aggr
    group by k
    order by k;;
SELECT k, mode(v) FROM aggr GROUP BY k ORDER BY k;
;
;
;
;
select k, mode(v)
    from aggr
    group by k
    order by k;;
create table names (name string);
insert into names values ('pedro'), ('pedro'), ('pedro'),('hannes'),('hannes'),('mark'),(null);;
select mode(name) from names;;
select mode(name) from names;;
;
select mode(name) from names;;
select mode(name) from names;;
SELECT mode("name") FROM "names";
;
;
;
;
select mode(name) from names;;
select k, v, mode(v) over (partition by k)
    from aggr
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from aggr
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from aggr
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from aggr
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM aggr ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from aggr
    order by k, v;;
SELECT mode(i) FROM range(100) tbl(i) WHERE 1=0;;
SELECT mode(i) FROM range(100) tbl(i) WHERE 1=0;;
;
SELECT mode(i) FROM range(100) tbl(i) WHERE 1=0;;
SELECT mode(i) FROM range(100) tbl(i) WHERE 1=0;;
SELECT mode(i) FROM range(100) AS tbl(i) WHERE (1 = 0);
;
;
;
;
SELECT mode(i) FROM range(100) tbl(i) WHERE 1=0;;
create table dates (k int, v date);
insert into dates values
    (1, '2021-05-02'),
    (1, '2021-05-02'),
    (2, '2021-05-02'),
    (2, '2020-02-29'),
    (2, '2020-02-29'),
    (3, '2004-09-01'),
    (1, null);;
select mode(v) from dates;;
select mode(v) from dates;;
;
select mode(v) from dates;;
select mode(v) from dates;;
SELECT mode(v) FROM dates;
;
;
;
;
select mode(v) from dates;;
select k, mode(v) from dates group by k ORDER BY ALL;;
select k, mode(v) from dates group by k ORDER BY ALL;;
;
select k, mode(v) from dates group by k ORDER BY ALL;;
select k, mode(v) from dates group by k ORDER BY ALL;;
SELECT k, mode(v) FROM dates GROUP BY k ORDER BY COLUMNS(*);
;
;
;
;
select k, mode(v) from dates group by k ORDER BY ALL;;
select k, v, mode(v) over (partition by k)
    from dates
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from dates
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from dates
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from dates
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM dates ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from dates
    order by k, v;;
create table times (k int, v time);
insert into times values
    (1, '12:11:49.5'),
    (1, '12:11:49.5'),
    (2, '12:11:49.5'),
    (2, '06:30:00'),
    (2, '06:30:00'),
    (3, '21:15:22'),
    (1, null);;
select mode(v) from times;;
select mode(v) from times;;
;
select mode(v) from times;;
select mode(v) from times;;
SELECT mode(v) FROM times;
;
;
;
;
select mode(v) from times;;
select k, mode(v) from times group by k ORDER BY ALL;;
select k, mode(v) from times group by k ORDER BY ALL;;
;
select k, mode(v) from times group by k ORDER BY ALL;;
select k, mode(v) from times group by k ORDER BY ALL;;
SELECT k, mode(v) FROM times GROUP BY k ORDER BY COLUMNS(*);
;
;
;
;
select k, mode(v) from times group by k ORDER BY ALL;;
select k, v, mode(v) over (partition by k)
    from times
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from times
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from times
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from times
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM times ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from times
    order by k, v;;
create table timestamps (k int, v timestamp);
insert into timestamps values
    (1, '2021-05-02 12:11:49.5'),
    (1, '2021-05-02 12:11:49.5'),
    (2, '2021-05-02 12:11:49.5'),
    (2,'2020-02-29 06:30:00'),
    (2,'2020-02-29 06:30:00'),
    (3,'2004-09-01 21:15:22'),
    (1, null);;
select mode(v) from timestamps;;
select mode(v) from timestamps;;
;
select mode(v) from timestamps;;
select mode(v) from timestamps;;
SELECT mode(v) FROM timestamps;
;
;
;
;
select mode(v) from timestamps;;
select k, mode(v) from timestamps group by k ORDER BY ALL;;
select k, mode(v) from timestamps group by k ORDER BY ALL;;
;
select k, mode(v) from timestamps group by k ORDER BY ALL;;
select k, mode(v) from timestamps group by k ORDER BY ALL;;
SELECT k, mode(v) FROM timestamps GROUP BY k ORDER BY COLUMNS(*);
;
;
;
;
select k, mode(v) from timestamps group by k ORDER BY ALL;;
select k, v, mode(v) over (partition by k)
    from timestamps
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from timestamps
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from timestamps
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from timestamps
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM timestamps ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from timestamps
    order by k, v;;
create table intervals (k int, v interval);
insert into intervals values
    (1, INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds'),
    (1, INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds'),
    (2, INTERVAL '5 months 2 days 12 hours 11 minutes 49 seconds'),
    (2, INTERVAL '2 months 29 days 6 hours 30 minutes'),
    (2, INTERVAL '2 months 29 days 6 hours 30 minutes'),
    (3, INTERVAL '9 months 1 day 21 hours 15 minutes 22 seconds'),
    (1, null);;
select mode(v) from intervals;;
select mode(v) from intervals;;
;
select mode(v) from intervals;;
select mode(v) from intervals;;
SELECT mode(v) FROM intervals;
;
;
;
;
select mode(v) from intervals;;
select k, mode(v) from intervals group by k ORDER BY ALL;;
select k, mode(v) from intervals group by k ORDER BY ALL;;
;
select k, mode(v) from intervals group by k ORDER BY ALL;;
select k, mode(v) from intervals group by k ORDER BY ALL;;
SELECT k, mode(v) FROM intervals GROUP BY k ORDER BY COLUMNS(*);
;
;
;
;
select k, mode(v) from intervals group by k ORDER BY ALL;;
select k, v, mode(v) over (partition by k)
    from intervals
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from intervals
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from intervals
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from intervals
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM intervals ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from intervals
    order by k, v;;
create table hugeints (k int, v hugeint);
insert into hugeints values (1, 5), (1, 5), (2, 5), (2, 2), (2, 2), (3, 1), (1, null);;
select mode(v) from hugeints;;
select mode(v) from hugeints;;
;
select mode(v) from hugeints;;
select mode(v) from hugeints;;
SELECT mode(v) FROM hugeints;
;
;
;
;
select mode(v) from hugeints;;
select k, mode(v) from hugeints group by k ORDER BY ALL;;
select k, mode(v) from hugeints group by k ORDER BY ALL;;
;
select k, mode(v) from hugeints group by k ORDER BY ALL;;
select k, mode(v) from hugeints group by k ORDER BY ALL;;
SELECT k, mode(v) FROM hugeints GROUP BY k ORDER BY COLUMNS(*);
;
;
;
;
select k, mode(v) from hugeints group by k ORDER BY ALL;;
select k, v, mode(v) over (partition by k)
    from hugeints
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from hugeints
    order by k, v;;
;
select k, v, mode(v) over (partition by k)
    from hugeints
    order by k, v;;
select k, v, mode(v) over (partition by k)
    from hugeints
    order by k, v;;
SELECT k, v, mode(v) OVER (PARTITION BY k) FROM hugeints ORDER BY k, v;
;
;
;
;
select k, v, mode(v) over (partition by k)
    from hugeints
    order by k, v;;
SELECT MODE(order_occurrences ORDER BY order_occurrences DESC) FROM (
VALUES
	(500, 1),
	(1000, 2),
	(800, 3),
	(1000, 4),
	(500, 5),
	(550, 6),
	(400, 7),
	(200, 8),
	(10, 9)
)items_per_order(order_occurrences, item_count);;
SELECT MODE(order_occurrences ORDER BY order_occurrences DESC) FROM (
VALUES
	(500, 1),
	(1000, 2),
	(800, 3),
	(1000, 4),
	(500, 5),
	(550, 6),
	(400, 7),
	(200, 8),
	(10, 9)
)items_per_order(order_occurrences, item_count);;
;
SELECT MODE(order_occurrences ORDER BY order_occurrences DESC) FROM (
VALUES
	(500, 1),
	(1000, 2),
	(800, 3),
	(1000, 4),
	(500, 5),
	(550, 6),
	(400, 7),
	(200, 8),
	(10, 9)
)items_per_order(order_occurrences, item_count);;
SELECT MODE(order_occurrences ORDER BY order_occurrences DESC) FROM (
VALUES
	(500, 1),
	(1000, 2),
	(800, 3),
	(1000, 4),
	(500, 5),
	(550, 6),
	(400, 7),
	(200, 8),
	(10, 9)
)items_per_order(order_occurrences, item_count);;
SELECT mode(order_occurrences ORDER BY order_occurrences DESC) FROM (SELECT * FROM (VALUES (500, 1), (1000, 2), (800, 3), (1000, 4), (500, 5), (550, 6), (400, 7), (200, 8), (10, 9)) AS valueslist) AS items_per_order(order_occurrences, item_count);
;
;
;
;
SELECT MODE(order_occurrences ORDER BY order_occurrences DESC) FROM (
VALUES
	(500, 1),
	(1000, 2),
	(800, 3),
	(1000, 4),
	(500, 5),
	(550, 6),
	(400, 7),
	(200, 8),
	(10, 9)
)items_per_order(order_occurrences, item_count);;
