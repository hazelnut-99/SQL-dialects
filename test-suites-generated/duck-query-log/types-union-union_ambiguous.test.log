CREATE TABLE tbl(a UNION(b INT, c INT));;
INSERT INTO tbl VALUES (1), (2), (3);;
INSERT INTO tbl VALUES (union_value(b := 1)), (union_value(c := 2)), (union_value(b := 3));;
INSERT INTO tbl VALUES (union_value(b := 3)), (union_value(a := 4)), (union_value(b := 5));;
SELECT a.b FROM tbl;
SELECT a.c FROM tbl;
SELECT a FROM tbl;
CREATE TABLE tbl2(a UNION(b STRUCT(foo VARCHAR), c STRUCT(foo VARCHAR)));;
INSERT INTO tbl2 VALUES ({'foo': 'bar'}), ({'foo': 'baz'});;
INSERT INTO tbl2 VALUES (union_value(b := {'foo': 'bar'})), (union_value(c := {'foo': 'baz'})), (union_value(d := {'foo': 'qux'}));;
INSERT INTO tbl2 VALUES (union_value(b := {'foo': 'bar'})), (union_value(c := {'foo': 'baz'}));;
SELECT a.b.foo FROM tbl2;
SELECT a.c.foo FROM tbl2;
SELECT a FROM tbl2;
CREATE TABLE tbl3(a UNION(b INT, c STRUCT(b INT)));;
INSERT INTO tbl3 VALUES (1), (union_value(b := 2)), (union_value(c := {'b': 3}));;
SELECT a FROM tbl3;
