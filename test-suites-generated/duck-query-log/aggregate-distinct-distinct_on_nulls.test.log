PRAGMA enable_verification;
CREATE TABLE integers(i INTEGER, j INTEGER);;
INSERT INTO integers VALUES (2, 3), (4, 5), (2, NULL), (NULL, NULL);;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY j;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY j;
;
;
;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j;
;
;
;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i NULLS FIRST, j NULLS FIRST;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i NULLS FIRST, j NULLS FIRST;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i NULLS FIRST, j NULLS FIRST;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i NULLS FIRST, j NULLS FIRST;
;
;
;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i NULLS FIRST, j NULLS FIRST;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j NULLS FIRST;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j NULLS FIRST;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j NULLS FIRST;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j NULLS FIRST;
;
;
;
;
SELECT DISTINCT ON (i) i, j FROM integers ORDER BY i, j NULLS FIRST;
CREATE TABLE distinct_on_test(key INTEGER, v1 VARCHAR, v2 INTEGER[], v3 INTEGER);;
INSERT INTO distinct_on_test VALUES
	(1, 'hello', ARRAY[1], 42), -- ASC
	(1, 'hello', ARRAY[1], 42),
	(1, 'hello', ARRAY[1], 43), -- DESC
	(2, NULL, NULL, 0),     -- ASC
	(2, NULL, NULL, 1),
	(2, NULL, NULL, NULL),  -- DESC
	(3, 'thisisalongstring', NULL, 0),     -- ASC
	(3, 'thisisalongstringbutlonger', NULL, 1),
	(3, 'thisisalongstringbutevenlonger', ARRAY[1, 2, 3, 4, 5, 6, 7, 8, 9], 2)  -- DESC
;;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1, v2, v3;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON ("key") * FROM distinct_on_test ORDER BY "key", v1, v2, v3;
;
;
;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON (key) * FROM distinct_on_test  WHERE key <> 2 ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON (key) * FROM distinct_on_test  WHERE key <> 2 ORDER BY key, v1, v2, v3;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test  WHERE key <> 2 ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON ("key") * FROM distinct_on_test WHERE ("key" != 2) ORDER BY "key", v1, v2, v3;
;
;
;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test  WHERE key <> 2 ORDER BY key, v1, v2, v3;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
SELECT DISTINCT ON ("key") * FROM distinct_on_test ORDER BY "key", v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
;
;
;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
SELECT DISTINCT ON (key) * FROM distinct_on_test WHERE key <> 2 ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
SELECT DISTINCT ON (key) * FROM distinct_on_test WHERE key <> 2 ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test WHERE key <> 2 ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
SELECT DISTINCT ON ("key") * FROM distinct_on_test WHERE ("key" != 2) ORDER BY "key", v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
;
;
;
;
SELECT DISTINCT ON (key) * FROM distinct_on_test WHERE key <> 2 ORDER BY key, v1 DESC NULLS FIRST, v2 DESC NULLS FIRST, v3 DESC NULLS FIRST;
