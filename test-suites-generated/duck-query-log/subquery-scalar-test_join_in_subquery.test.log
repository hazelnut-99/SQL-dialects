PRAGMA enable_verification;
CREATE TABLE test AS FROM VALUES (1, 22), (1, 21), (2, 22) v(id, test_value);;
CREATE TABLE test2 AS FROM VALUES (1, 44), (2, 42) v(id, test2_value);;
SELECT * FROM test, test2 WHERE test.id=test2.id AND test_value*test2_value=(SELECT MIN(test_value*test2_value) FROM test AS a, test2 WHERE a.id=test.id AND a.id=test2.id);
SELECT * FROM test, test2 WHERE test.id=test2.id AND test_value*test2_value=(SELECT MIN(test_value*test2_value) FROM test AS a, test2 WHERE a.id=test.id AND a.id=test2.id);
;
SELECT * FROM test, test2 WHERE test.id=test2.id AND test_value*test2_value=(SELECT MIN(test_value*test2_value) FROM test AS a, test2 WHERE a.id=test.id AND a.id=test2.id);
SELECT * FROM test , test2 WHERE ((test.id = test2.id) AND ((test_value * test2_value) = (SELECT min((test_value * test2_value)) FROM test AS a , test2 WHERE ((a.id = test.id) AND (a.id = test2.id)))));
;
;
;
;
SELECT * FROM test, test2 WHERE test.id=test2.id AND test_value*test2_value=(SELECT MIN(test_value*test2_value) FROM test AS a, test2 WHERE a.id=test.id AND a.id=test2.id);
