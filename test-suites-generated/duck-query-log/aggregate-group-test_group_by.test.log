SET default_null_order='nulls_first';;
PRAGMA enable_verification;
PRAGMA verify_external;
CREATE TABLE test (a INTEGER, b INTEGER);;
INSERT INTO test VALUES (11, 22), (13, 22), (12, 21);
SELECT SUM(SUM(41)), COUNT(*);;
SELECT SUM(SUM(41)), COUNT(*);;
;
SELECT SUM(SUM(41)), COUNT(*);;
SELECT SUM(SUM(41)), COUNT(*);;
SELECT SUM(SUM(41)), COUNT(*);;
SELECT SUM(a), COUNT(*), AVG(a) FROM test;;
SELECT SUM(a), COUNT(*), AVG(a) FROM test;;
;
SELECT SUM(a), COUNT(*), AVG(a) FROM test;;
SELECT SUM(a), COUNT(*), AVG(a) FROM test;;
SELECT sum(a), count_star(), avg(a) FROM test;
;
;
;
;
SELECT SUM(a), COUNT(*), AVG(a) FROM test;;
SELECT COUNT(*) FROM test;;
SELECT COUNT(*) FROM test;;
;
SELECT COUNT(*) FROM test;;
SELECT COUNT(*) FROM test;;
SELECT count_star() FROM test;
;
;
;
;
SELECT COUNT(*) FROM test;;
SELECT SUM(a), COUNT(*) FROM test WHERE a = 11;;
SELECT SUM(a), COUNT(*) FROM test WHERE a = 11;;
;
SELECT SUM(a), COUNT(*) FROM test WHERE a = 11;;
SELECT SUM(a), COUNT(*) FROM test WHERE a = 11;;
SELECT sum(a), count_star() FROM test WHERE (a = 11);
;
;
;
;
SELECT SUM(a), COUNT(*) FROM test WHERE a = 11;;
SELECT SUM(a), SUM(b), SUM(a) + SUM (b) FROM test;;
SELECT SUM(a), SUM(b), SUM(a) + SUM (b) FROM test;;
;
SELECT SUM(a), SUM(b), SUM(a) + SUM (b) FROM test;;
SELECT SUM(a), SUM(b), SUM(a) + SUM (b) FROM test;;
SELECT sum(a), sum(b), (sum(a) + sum(b)) FROM test;
;
;
;
;
SELECT SUM(a), SUM(b), SUM(a) + SUM (b) FROM test;;
SELECT SUM(a+2), SUM(a) + 2 * COUNT(*) FROM test;;
SELECT SUM(a+2), SUM(a) + 2 * COUNT(*) FROM test;;
;
SELECT SUM(a+2), SUM(a) + 2 * COUNT(*) FROM test;;
SELECT SUM(a+2), SUM(a) + 2 * COUNT(*) FROM test;;
SELECT sum((a + 2)), (sum(a) + (2 * count_star())) FROM test;
;
;
;
;
SELECT SUM(a+2), SUM(a) + 2 * COUNT(*) FROM test;;
SELECT b, SUM(a), SUM(a+2), AVG(a) FROM test GROUP BY b ORDER BY b;;
SELECT b, SUM(a), SUM(a+2), AVG(a) FROM test GROUP BY b ORDER BY b;;
;
SELECT b, SUM(a), SUM(a+2), AVG(a) FROM test GROUP BY b ORDER BY b;;
SELECT b, SUM(a), SUM(a+2), AVG(a) FROM test GROUP BY b ORDER BY b;;
SELECT b, sum(a), sum((a + 2)), avg(a) FROM test GROUP BY b ORDER BY b;
;
;
;
;
SELECT b, SUM(a), SUM(a+2), AVG(a) FROM test GROUP BY b ORDER BY b;;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a);;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a);;
;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a);;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a);;
SELECT b, sum(a) FROM test GROUP BY b ORDER BY count(a);
;
;
;
;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a);;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT b, sum(a) FROM test GROUP BY b ORDER BY count(a) DESC;
;
;
;
;
SELECT b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test GROUP BY b ORDER BY b;;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test GROUP BY b ORDER BY b;;
SELECT b, sum(a), count_star(), sum((a + 2)) FROM test GROUP BY b ORDER BY b;
;
;
;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test GROUP BY b ORDER BY b;;
SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;;
SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;;
;
SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;;
SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;;
SELECT (b % 2) AS f, sum(a) FROM test GROUP BY f ORDER BY f;
;
;
;
;
SELECT b % 2 AS f, SUM(a) FROM test GROUP BY f ORDER BY f;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, sum(a), count_star(), sum((a + 2)) FROM test WHERE (a <= 12) GROUP BY b ORDER BY b;
;
;
;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b % 2 AS f, COUNT(SUM(a)) FROM test GROUP BY f;;
SELECT b % 2 AS f, COUNT(SUM(a)) FROM test GROUP BY f;;
;
SELECT b % 2 AS f, COUNT(SUM(a)) FROM test GROUP BY f;;
SELECT b % 2 AS f, COUNT(SUM(a)) FROM test GROUP BY f;;
SELECT b % 2 AS f, COUNT(SUM(a)) FROM test GROUP BY f;;
INSERT INTO test VALUES (12, 21), (12, 21), (12, 21);
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
SELECT b, sum(a), count_star(), sum((a + 2)) FROM test WHERE (a <= 12) GROUP BY b ORDER BY b;
;
;
;
;
SELECT b, SUM(a), COUNT(*), SUM(a+2) FROM test WHERE a <= 12 GROUP BY b ORDER BY b;;
CREATE TABLE integers(i INTEGER, j INTEGER);;
INSERT INTO integers VALUES (3, 4), (3, 4), (2, 4);;
SELECT i, i + 10 FROM integers GROUP BY i ORDER BY i;
SELECT i, i + 10 FROM integers GROUP BY i ORDER BY i;
;
SELECT i, i + 10 FROM integers GROUP BY i ORDER BY i;
SELECT i, i + 10 FROM integers GROUP BY i ORDER BY i;
SELECT i, (i + 10) FROM integers GROUP BY i ORDER BY i;
;
;
;
;
SELECT i, i + 10 FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), j FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), j FROM integers GROUP BY i ORDER BY i;
;
SELECT i, SUM(j), j FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), j FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), j FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), FIRST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), FIRST(j) FROM integers GROUP BY i ORDER BY i;
;
SELECT i, SUM(j), FIRST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), FIRST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, sum(j), first(j) FROM integers GROUP BY i ORDER BY i;
;
;
;
;
SELECT i, SUM(j), FIRST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), LAST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), LAST(j) FROM integers GROUP BY i ORDER BY i;
;
SELECT i, SUM(j), LAST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, SUM(j), LAST(j) FROM integers GROUP BY i ORDER BY i;
SELECT i, sum(j), last(j) FROM integers GROUP BY i ORDER BY i;
;
;
;
;
SELECT i, SUM(j), LAST(j) FROM integers GROUP BY i ORDER BY i;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k ORDER BY 2;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k ORDER BY 2;;
;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k ORDER BY 2;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k ORDER BY 2;;
SELECT 1 AS k, sum(i) FROM integers GROUP BY k ORDER BY 2;
;
;
;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k ORDER BY 2;;
SELECT 1 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 2;;
SELECT 1 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 2;;
;
SELECT 1 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 2;;
SELECT 1 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 2;;
SELECT 1 AS i, sum(i) FROM integers GROUP BY i ORDER BY 2;
;
;
;
SELECT 1 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 2;;
SELECT i % 2 AS k, SUM(i) FROM integers GROUP BY k, k ORDER BY 1;;
SELECT i % 2 AS k, SUM(i) FROM integers GROUP BY k, k ORDER BY 1;;
;
SELECT i % 2 AS k, SUM(i) FROM integers GROUP BY k, k ORDER BY 1;;
SELECT i % 2 AS k, SUM(i) FROM integers GROUP BY k, k ORDER BY 1;;
SELECT (i % 2) AS k, sum(i) FROM integers GROUP BY k ORDER BY 1;
;
;
;
SELECT i % 2 AS k, SUM(i) FROM integers GROUP BY k, k ORDER BY 1;;
DROP TABLE integers;;
CREATE TABLE integers(i INTEGER);;
INSERT INTO integers VALUES (1), (2), (3), (NULL);;
SELECT i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
;
SELECT i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, sum(i) FROM integers GROUP BY i ORDER BY 1;
;
;
;
SELECT i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, i % 2 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, i % 2 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
;
SELECT i, i % 2 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, i % 2 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT i, (i % 2) AS i, sum(i) FROM integers GROUP BY i ORDER BY 1;
;
;
;
SELECT i, i % 2 AS i, SUM(i) FROM integers GROUP BY i ORDER BY 1;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k+1 ORDER BY 2;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k+1 ORDER BY 2;;
;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k+1 ORDER BY 2;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k+1 ORDER BY 2;;
SELECT 1 AS k, SUM(i) FROM integers GROUP BY k+1 ORDER BY 2;;
SELECT test.b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT test.b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
;
SELECT test.b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT test.b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
SELECT test.b, sum(a) FROM test GROUP BY b ORDER BY count(a) DESC;
;
;
;
;
SELECT test.b, SUM(a) FROM test GROUP BY b ORDER BY COUNT(a) DESC;;
