SET default_null_order='nulls_first';;
CREATE TABLE tbl (a UNION(a INT, b INT));;
INSERT INTO tbl VALUES (union_value(b := 1)), (union_value(a := 4)), (union_value(a := 1)), (union_value(b := 2)), (union_value(a := 3)), (NULL);;
SELECT union_tag(a), a FROM tbl ORDER BY a ASC;;
SELECT union_tag(a), a FROM tbl ORDER BY a DESC;;
CREATE TABLE tbl5 (a UNION(lft INT, u UNION(lft VARCHAR, rght INT)));;
INSERT INTO tbl5 VALUES (union_value(lft := 1));
CREATE TABLE tbl2 (u UNION(lft INT, u UNION(lft VARCHAR, rght INT)));;
INSERT INTO tbl2 VALUES (union_value(lft := 1));;
INSERT INTO tbl2 VALUES (NULL);;
INSERT INTO tbl2 VALUES (union_value(u := union_value(rght := 2)));;
INSERT INTO tbl2 VALUES (union_value(u := union_value(lft := '3')));;
INSERT INTO tbl2 VALUES (union_value(u := '4'));;
SELECT u, union_tag(u), union_tag(u.u) FROM tbl2 ORDER BY u;;
