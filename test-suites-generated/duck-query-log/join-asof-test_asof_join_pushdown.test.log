PRAGMA enable_verification;
CREATE OR REPLACE TABLE right_pushdown(time INTEGER, value FLOAT);;
INSERT INTO right_pushdown VALUES
    (0, 0), 
    (1, NULL), 
;;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
SELECT d1."time", d2."time", d1."value", d2."value" FROM right_pushdown AS d1 ASOF INNER JOIN (SELECT * FROM right_pushdown WHERE ("value" IS NOT NULL)) AS d2 ON ((d1."time" >= d2."time"));
;
;
;
;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF LEFT JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF LEFT JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF LEFT JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
SELECT d1."time", d2."time", d1."value", d2."value" FROM right_pushdown AS d1 ASOF LEFT JOIN (SELECT * FROM right_pushdown WHERE ("value" IS NOT NULL)) AS d2 ON ((d1."time" >= d2."time"));
;
;
;
;
SELECT 
	d1.time,
	d2.time,
	d1.value, 
	d2.value
FROM right_pushdown d1 
ASOF LEFT JOIN (
	SELECT * FROM right_pushdown WHERE value is not NULL
	) d2
	ON d1.time >= d2.time;;
