PRAGMA enable_verification;
CREATE TABLE response(
	id BIGINT,
	response VARCHAR
);;
INSERT INTO response VALUES
	(1,'yes'),
	(1,'no'),
	(1,'yes'),
	(2,'no'),
	(2,'no');;
CREATE TABLE user_pq(
	id BIGINT,
	"name" VARCHAR
);;
INSERT INTO user_pq VALUES
	(1,'alice'),
	(2,'bob');;
SELECT id, response, COUNT(DISTINCT id)
FROM user_pq
JOIN response USING (id)
GROUP BY CUBE (id, response)
ORDER BY 1 NULLS LAST, 2 NULLS LAST, 3 NULLS LAST;
SELECT id, response, COUNT(DISTINCT id)
FROM user_pq
JOIN response USING (id)
GROUP BY CUBE (id, response)
ORDER BY 1 NULLS LAST, 2 NULLS LAST, 3 NULLS LAST;
;
SELECT id, response, COUNT(DISTINCT id)
FROM user_pq
JOIN response USING (id)
GROUP BY CUBE (id, response)
ORDER BY 1 NULLS LAST, 2 NULLS LAST, 3 NULLS LAST;
SELECT id, response, count(DISTINCT id) FROM user_pq INNER JOIN response USING (id) GROUP BY GROUPING SETS ((),(id),(id, response),(response)) ORDER BY 1 NULLS LAST, 2 NULLS LAST, 3 NULLS LAST;
;
;
;
SELECT id, response, COUNT(DISTINCT id)
FROM user_pq
JOIN response USING (id)
GROUP BY CUBE (id, response)
ORDER BY 1 NULLS LAST, 2 NULLS LAST, 3 NULLS LAST;
