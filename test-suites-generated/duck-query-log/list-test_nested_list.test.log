SET default_null_order='nulls_first';
PRAGMA enable_verification
PRAGMA threads=1
SELECT [{'i': 1,'j': [2, 3]}, NULL, {'i': 1, 'j': [2, 3]}];
SELECT [{'i': 1,'j': [2, 3]}, NULL, {'i': 1, 'j': [2, 3]}];

SELECT [{'i': 1,'j': [2, 3]}, NULL, {'i': 1, 'j': [2, 3]}];
SELECT main.list_value(main.struct_pack(i := 1, j := main.list_value(2, 3)), NULL, main.struct_pack(i := 1, j := main.list_value(2, 3)))




SELECT [{'i': 1,'j': [2, 3]}, NULL, {'i': 1, 'j': [2, 3]}];
CREATE TABLE list_data (g INTEGER, e INTEGER)
INSERT INTO list_data VALUES (1, 1), (1, 2), (2, 3), (2, 4), (2, 5), (3, 6), (5, NULL)
SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)
SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)

SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)
SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)




SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)
SELECT UNNEST(l1) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1
SELECT UNNEST(l1) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1

SELECT UNNEST(l1) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1
SELECT unnest(l1) FROM (SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)) AS t1




SELECT UNNEST(l1) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1
SELECT * FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT * FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2

SELECT * FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT * FROM (SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)) AS t1 , (SELECT list(b) AS l2 FROM (SELECT * FROM (VALUES (4), (5), (6), (7)) AS valueslist) AS t2(b)) AS t2




SELECT * FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT UNNEST(l1) u1, UNNEST(l2) u2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT UNNEST(l1) u1, UNNEST(l2) u2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2

SELECT UNNEST(l1) u1, UNNEST(l2) u2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT unnest(l1) AS u1, unnest(l2) AS u2 FROM (SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)) AS t1 , (SELECT list(b) AS l2 FROM (SELECT * FROM (VALUES (4), (5), (6), (7)) AS valueslist) AS t2(b)) AS t2




SELECT UNNEST(l1) u1, UNNEST(l2) u2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT UNNEST(l1), l2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, 	(SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT UNNEST(l1), l2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, 	(SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2

SELECT UNNEST(l1), l2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, 	(SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT unnest(l1), l2 FROM (SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)) AS t1 , (SELECT list(b) AS l2 FROM (SELECT * FROM (VALUES (4), (5), (6), (7)) AS valueslist) AS t2(b)) AS t2




SELECT UNNEST(l1), l2 FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, 	(SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT l1, UNNEST(l2) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT l1, UNNEST(l2) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2

SELECT l1, UNNEST(l2) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT l1, unnest(l2) FROM (SELECT list(a) AS l1 FROM (SELECT * FROM (VALUES (1), (2), (3)) AS valueslist) AS t1(a)) AS t1 , (SELECT list(b) AS l2 FROM (SELECT * FROM (VALUES (4), (5), (6), (7)) AS valueslist) AS t2(b)) AS t2




SELECT l1, UNNEST(l2) FROM (SELECT LIST(a) l1 FROM (VALUES (1), (2), (3)) AS t1 (a)) t1, (SELECT LIST(b) l2 FROM (VALUES (4), (5), (6), (7)) AS t2 (b)) t2
SELECT UNNEST(LIST(e)) ue, LIST(g) from list_data ORDER BY 1 NULLS LAST
SELECT UNNEST(LIST(e)) ue, LIST(g) from list_data ORDER BY 1 NULLS LAST

SELECT UNNEST(LIST(e)) ue, LIST(g) from list_data ORDER BY 1 NULLS LAST
SELECT unnest(list(e)) AS ue, list(g) FROM list_data ORDER BY 1 NULLS LAST



SELECT UNNEST(LIST(e)) ue, LIST(g) from list_data ORDER BY 1 NULLS LAST
SELECT g, LIST(e) from list_data GROUP BY g ORDER BY g
SELECT g, LIST(e) from list_data GROUP BY g ORDER BY g

SELECT g, LIST(e) from list_data GROUP BY g ORDER BY g
SELECT g, list(e) FROM list_data GROUP BY g ORDER BY g




SELECT g, LIST(e) from list_data GROUP BY g ORDER BY g
SELECT g, LIST(e) l1, LIST(e) l2 from list_data GROUP BY g ORDER BY g
SELECT g, LIST(e) l1, LIST(e) l2 from list_data GROUP BY g ORDER BY g

SELECT g, LIST(e) l1, LIST(e) l2 from list_data GROUP BY g ORDER BY g
SELECT g, list(e) AS l1, list(e) AS l2 FROM list_data GROUP BY g ORDER BY g




SELECT g, LIST(e) l1, LIST(e) l2 from list_data GROUP BY g ORDER BY g
SELECT g, LIST(e/2.0) from list_data GROUP BY g order by g
SELECT g, LIST(e/2.0) from list_data GROUP BY g order by g

SELECT g, LIST(e/2.0) from list_data GROUP BY g order by g
SELECT g, list((e / 2.0)) FROM list_data GROUP BY g ORDER BY g




SELECT g, LIST(e/2.0) from list_data GROUP BY g order by g
SELECT g, LIST(CAST(e AS VARCHAR)) from list_data GROUP BY g order by g
SELECT g, LIST(CAST(e AS VARCHAR)) from list_data GROUP BY g order by g

SELECT g, LIST(CAST(e AS VARCHAR)) from list_data GROUP BY g order by g
SELECT g, list(CAST(e AS VARCHAR)) FROM list_data GROUP BY g ORDER BY g




SELECT g, LIST(CAST(e AS VARCHAR)) from list_data GROUP BY g order by g
SELECT LIST(e) from list_data
SELECT LIST(e) from list_data

SELECT LIST(e) from list_data
SELECT list(e) FROM list_data




SELECT LIST(e) from list_data
SELECT UNNEST(LIST(e)) ue from list_data ORDER BY ue
SELECT UNNEST(LIST(e)) ue from list_data ORDER BY ue

SELECT UNNEST(LIST(e)) ue from list_data ORDER BY ue
SELECT unnest(list(e)) AS ue FROM list_data ORDER BY ue




SELECT UNNEST(LIST(e)) ue from list_data ORDER BY ue
SELECT LIST(e), LIST(g) from list_data
SELECT LIST(e), LIST(g) from list_data

SELECT LIST(e), LIST(g) from list_data
SELECT list(e), list(g) FROM list_data




SELECT LIST(e), LIST(g) from list_data
SELECT LIST(42)
SELECT LIST(42)

SELECT LIST(42)
SELECT list(42)




SELECT LIST(42)
SELECT LIST(42) FROM list_data
SELECT LIST(42) FROM list_data

SELECT LIST(42) FROM list_data
SELECT list(42) FROM list_data




SELECT LIST(42) FROM list_data
SELECT UNNEST(LIST(42))
SELECT UNNEST(LIST(42))

SELECT UNNEST(LIST(42))
SELECT unnest(list(42))




SELECT UNNEST(LIST(42))
SELECT UNLIST(LIST(42))
SELECT UNLIST(LIST(42))

SELECT UNLIST(LIST(42))
SELECT unlist(list(42))




SELECT UNLIST(LIST(42))
SELECT UNNEST(LIST(e)) ue, UNNEST(LIST(g)) ug from list_data ORDER BY ue
SELECT UNNEST(LIST(e)) ue, UNNEST(LIST(g)) ug from list_data ORDER BY ue

SELECT UNNEST(LIST(e)) ue, UNNEST(LIST(g)) ug from list_data ORDER BY ue
SELECT unnest(list(e)) AS ue, unnest(list(g)) AS ug FROM list_data ORDER BY ue




SELECT UNNEST(LIST(e)) ue, UNNEST(LIST(g)) ug from list_data ORDER BY ue
SELECT g, UNNEST(LIST(e)) ue, UNNEST(LIST(e+1)) ue2 from list_data GROUP BY g ORDER BY ue
SELECT g, UNNEST(LIST(e)) ue, UNNEST(LIST(e+1)) ue2 from list_data GROUP BY g ORDER BY ue

SELECT g, UNNEST(LIST(e)) ue, UNNEST(LIST(e+1)) ue2 from list_data GROUP BY g ORDER BY ue
SELECT g, unnest(list(e)) AS ue, unnest(list((e + 1))) AS ue2 FROM list_data GROUP BY g ORDER BY ue




SELECT g, UNNEST(LIST(e)) ue, UNNEST(LIST(e+1)) ue2 from list_data GROUP BY g ORDER BY ue
SELECT g, UNNEST(l) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, UNNEST(l) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u

SELECT g, UNNEST(l) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, unnest(l) AS u FROM (SELECT g, list(e) AS l FROM list_data GROUP BY g) AS u1 ORDER BY u




SELECT g, UNNEST(l) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, UNNEST(l)+1 u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, UNNEST(l)+1 u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u

SELECT g, UNNEST(l)+1 u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, (unnest(l) + 1) AS u FROM (SELECT g, list(e) AS l FROM list_data GROUP BY g) AS u1 ORDER BY u




SELECT g, UNNEST(l)+1 u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 ORDER BY u
SELECT g, STRUCT_PACK(a := g, b := le) sl FROM (SELECT g, LIST(e) le from list_data GROUP BY g) xx WHERE g < 3 ORDER BY g
SELECT g, STRUCT_PACK(a := g, b := le) sl FROM (SELECT g, LIST(e) le from list_data GROUP BY g) xx WHERE g < 3 ORDER BY g

SELECT g, STRUCT_PACK(a := g, b := le) sl FROM (SELECT g, LIST(e) le from list_data GROUP BY g) xx WHERE g < 3 ORDER BY g
SELECT g, struct_pack(a := g, b := le) AS sl FROM (SELECT g, list(e) AS le FROM list_data GROUP BY g) AS xx WHERE (g < 3) ORDER BY g




SELECT g, STRUCT_PACK(a := g, b := le) sl FROM (SELECT g, LIST(e) le from list_data GROUP BY g) xx WHERE g < 3 ORDER BY g
SELECT LIST(STRUCT_PACK(a := g, b := le)) mind_blown FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT LIST(STRUCT_PACK(a := g, b := le)) mind_blown FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx

SELECT LIST(STRUCT_PACK(a := g, b := le)) mind_blown FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT list(struct_pack(a := g, b := le)) AS mind_blown FROM (SELECT g, list(e) AS le FROM list_data GROUP BY g ORDER BY g) AS xx




SELECT LIST(STRUCT_PACK(a := g, b := le)) mind_blown FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data GROUP BY g ORDER BY g
SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data GROUP BY g ORDER BY g

SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data GROUP BY g ORDER BY g
SELECT g, list(struct_pack(a := e, b := (e + 1))) AS ls FROM list_data GROUP BY g ORDER BY g




SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data GROUP BY g ORDER BY g
SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data WHERE g > 2 GROUP BY g ORDER BY g
SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data WHERE g > 2 GROUP BY g ORDER BY g

SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data WHERE g > 2 GROUP BY g ORDER BY g
SELECT g, list(struct_pack(a := e, b := (e + 1))) AS ls FROM list_data WHERE (g > 2) GROUP BY g ORDER BY g




SELECT g, LIST(STRUCT_PACK(a := e, b := e+1)) ls from list_data WHERE g > 2 GROUP BY g ORDER BY g
SELECT g2, LIST(le) FROM (SELECT g % 2 g2, LIST(e) le from list_data GROUP BY g ORDER BY g) sq 	GROUP BY g2 ORDER BY g2
SELECT g2, LIST(le) FROM (SELECT g % 2 g2, LIST(e) le from list_data GROUP BY g ORDER BY g) sq 	GROUP BY g2 ORDER BY g2

SELECT g2, LIST(le) FROM (SELECT g % 2 g2, LIST(e) le from list_data GROUP BY g ORDER BY g) sq 	GROUP BY g2 ORDER BY g2
SELECT g2, list(le) FROM (SELECT (g % 2) AS g2, list(e) AS le FROM list_data GROUP BY g ORDER BY g) AS sq GROUP BY g2 ORDER BY g2




SELECT g2, LIST(le) FROM (SELECT g % 2 g2, LIST(e) le from list_data GROUP BY g ORDER BY g) sq 	GROUP BY g2 ORDER BY g2
SELECT SUM(ue) FROM (SELECT UNNEST(le) ue FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx) xy
SELECT SUM(ue) FROM (SELECT UNNEST(le) ue FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx) xy

SELECT SUM(ue) FROM (SELECT UNNEST(le) ue FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx) xy
SELECT sum(ue) FROM (SELECT unnest(le) AS ue FROM (SELECT g, list(e) AS le FROM list_data GROUP BY g ORDER BY g) AS xx) AS xy




SELECT SUM(ue) FROM (SELECT UNNEST(le) ue FROM (SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx) xy
SELECT SUM(UNNEST(le)) FROM ( SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT SUM(UNNEST(le)) FROM ( SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx

SELECT SUM(UNNEST(le)) FROM ( SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT SUM(UNNEST(le)) FROM ( SELECT g, LIST(e) le from list_data  GROUP BY g ORDER BY g) xx
SELECT LIST(LIST(42))
SELECT LIST(LIST(42))

SELECT LIST(LIST(42))
SELECT LIST(LIST(42))
SELECT LIST()
SELECT LIST()

SELECT LIST()
SELECT LIST()
SELECT LIST() FROM list_data
SELECT LIST() FROM list_data

SELECT LIST() FROM list_data
SELECT LIST() FROM list_data
SELECT LIST(e, g) FROM list_data
SELECT LIST(e, g) FROM list_data

SELECT LIST(e, g) FROM list_data
SELECT LIST(e, g) FROM list_data
SELECT g, UNNEST(l+1) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST(l+1) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1

SELECT g, UNNEST(l+1) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST(l+1) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST(g) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST(g) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1

SELECT g, UNNEST(g) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST(g) u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST() u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST() u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1

SELECT g, UNNEST() u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT g, UNNEST() u FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1
SELECT UNNEST(42)
SELECT UNNEST(42)

SELECT UNNEST(42)
SELECT UNNEST(42)
SELECT UNNEST()
SELECT UNNEST()

SELECT UNNEST()
SELECT UNNEST()
SELECT UNNEST(42) from list_data
SELECT UNNEST(42) from list_data

SELECT UNNEST(42) from list_data
SELECT UNNEST(42) from list_data
SELECT UNNEST() from list_data
SELECT UNNEST() from list_data

SELECT UNNEST() from list_data
SELECT UNNEST() from list_data
SELECT g FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 where UNNEST(l) > 42
SELECT g FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 where UNNEST(l) > 42

SELECT g FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 where UNNEST(l) > 42
SELECT g FROM (SELECT g, LIST(e) l FROM list_data GROUP BY g) u1 where UNNEST(l) > 42
