PRAGMA enable_verification;
SELECT SETSEED(0.8675309);;
SELECT SETSEED(0.8675309);;
;
SELECT SETSEED(0.8675309);;
SELECT setseed(0.8675309);
;
;
;
;
SELECT SETSEED(0.8675309);;
CREATE TABLE raw_data (
  ts TIMESTAMP_S NOT NULL,
  hits INTEGER NOT NULL
);;
INSERT INTO raw_data
SELECT *, (random() * 500)::INTEGER
FROM RANGE(TIMESTAMP '2023-11-01', TIMESTAMP '2023-11-06', INTERVAL 1 MINUTE);;
CREATE TABLE timeseries AS (
  SELECT DATE_TRUNC('hour', ts) AS bucket, SUM(hits)::BIGINT AS total
  FROM raw_data
  GROUP BY bucket
);;
SELECT * 
FROM timeseries
ORDER BY ALL
LIMIT 5;
SELECT * 
FROM timeseries
ORDER BY ALL
LIMIT 5;
;
SELECT * 
FROM timeseries
ORDER BY ALL
LIMIT 5;
SELECT * FROM timeseries ORDER BY COLUMNS(*) LIMIT 5;
;
;
;
;
SELECT * 
FROM timeseries
ORDER BY ALL
LIMIT 5;
COPY (
  SELECT * FROM timeseries
) TO 'duckdb_unittest_tempdir/54760/hive' (
  FORMAT 'PARQUET', COMPRESSION 'SNAPPY', PARTITION_BY (bucket), OVERWRITE_OR_IGNORE
);;
SELECT * 
FROM read_parquet('duckdb_unittest_tempdir/54760/hive/*/*.parquet') 
ORDER BY ALL
LIMIT 5;
SELECT * 
FROM read_parquet('duckdb_unittest_tempdir/54760/hive/*/*.parquet') 
ORDER BY ALL
LIMIT 5;
;
SELECT * 
FROM read_parquet('duckdb_unittest_tempdir/54760/hive/*/*.parquet') 
ORDER BY ALL
LIMIT 5;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54760/hive/*/*.parquet') ORDER BY COLUMNS(*) LIMIT 5;
;
;
;
;
SELECT * 
FROM read_parquet('duckdb_unittest_tempdir/54760/hive/*/*.parquet') 
ORDER BY ALL
LIMIT 5;
