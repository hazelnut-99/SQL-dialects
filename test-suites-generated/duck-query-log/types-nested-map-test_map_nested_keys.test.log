PRAGMA enable_verification;
SELECT MAP(
	[
		[1],[2],[3]
	],
	[
		4,2,0
	]
);;
SELECT MAP(
	[
		[1],[2],[3]
	],
	[
		4,2,0
	]
);;
;
SELECT MAP(
	[
		[1],[2],[3]
	],
	[
		4,2,0
	]
);;
SELECT map(main.list_value(main.list_value(1), main.list_value(2), main.list_value(3)), main.list_value(4, 2, 0));
;
;
;
;
SELECT MAP(
	[
		[1],[2],[3]
	],
	[
		4,2,0
	]
);;
CREATE TABLE tbl(a INT[][], b VARCHAR[]);;
INSERT INTO tbl VALUES([[2],[3],[4]], ['a', 'b', 'c']);;
INSERT INTO tbl VALUES([[5],[6],[7]], ['d', 'e', 'f']);;
INSERT INTO tbl VALUES([[8],[9],[10]], ['g', 'h', 'i']);;
SELECT MAP(a, b) from tbl;;
SELECT MAP(a, b) from tbl;;
;
SELECT MAP(a, b) from tbl;;
SELECT map(a, b) FROM tbl;
;
;
;
;
SELECT MAP(a, b) from tbl;;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],[1,2]
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],[1,2]
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],[1,2]
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],[1,2]
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],NULL
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],NULL
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],NULL
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		[1,2],[2,1],[3,1],[4,2],[4,2,0],NULL
	],
	[
		NULL,NULL,NULL,NULL,NULL,NULL
	]
);;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}
	],
	[
		4,2,0
	]
);;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}
	],
	[
		4,2,0
	]
);;
;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}
	],
	[
		4,2,0
	]
);;
SELECT map(main.list_value(main.struct_pack(foo := CAST('t' AS BOOLEAN)), main.struct_pack(foo := CAST('f' AS BOOLEAN)), main.struct_pack(foo := NULL)), main.list_value(4, 2, 0));
;
;
;
;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}
	],
	[
		4,2,0
	]
);;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}, {'foo': True}
	],
	[
		'n', 'o', 'p', 'e'
	]
);;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}, {'foo': True}
	],
	[
		'n', 'o', 'p', 'e'
	]
);;
;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}, {'foo': True}
	],
	[
		'n', 'o', 'p', 'e'
	]
);;
SELECT MAP(
	[
		{'foo': True}, {'foo': False}, {'foo': NULL}, {'foo': True}
	],
	[
		'n', 'o', 'p', 'e'
	]
);;
SELECT MAP(
	[
		{'foo': 0}, {'foo': 1}, NULL, {'foo': 2}, {'foo': 3}
	],
	[
		'e', 'r', 'r', 'o', 'r'
	]
);;
SELECT MAP(
	[
		{'foo': 0}, {'foo': 1}, NULL, {'foo': 2}, {'foo': 3}
	],
	[
		'e', 'r', 'r', 'o', 'r'
	]
);;
;
SELECT MAP(
	[
		{'foo': 0}, {'foo': 1}, NULL, {'foo': 2}, {'foo': 3}
	],
	[
		'e', 'r', 'r', 'o', 'r'
	]
);;
SELECT MAP(
	[
		{'foo': 0}, {'foo': 1}, NULL, {'foo': 2}, {'foo': 3}
	],
	[
		'e', 'r', 'r', 'o', 'r'
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
SELECT map(main.list_value(map(main.list_value(5), main.list_value(4)), map(main.list_value(10), main.list_value(2)), map(main.list_value(2, 3), main.list_value(3, 2)), map(main.list_value(10), main.list_value(3)), map(main.list_value(3, 2), main.list_value(2, 3))), main.list_value(0, 1, 2, 3, 4));
;
;
;
;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3]), MAP([5],[4])
	],
	[
		0,1,2,3,4,5
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3]), MAP([5],[4])
	],
	[
		0,1,2,3,4,5
	]
);;
;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3]), MAP([5],[4])
	],
	[
		0,1,2,3,4,5
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), MAP([10],[3]), MAP([3,2], [2,3]), MAP([5],[4])
	],
	[
		0,1,2,3,4,5
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), NULL, MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), NULL, MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), NULL, MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
SELECT MAP(
	[
		MAP([5],[4]), MAP([10],[2]), MAP([2,3],[3,2]), NULL, MAP([3,2], [2,3])
	],
	[
		0,1,2,3,4
	]
);;
