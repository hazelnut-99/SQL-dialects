SET default_null_order='nulls_first';;
PRAGMA enable_verification;
PRAGMA verify_external;
SELECT STRING_AGG();
SELECT STRING_AGG();
;
SELECT STRING_AGG();
SELECT STRING_AGG();
SELECT STRING_AGG();
SELECT STRING_AGG('a', 'b', 'c');
SELECT STRING_AGG('a', 'b', 'c');
;
SELECT STRING_AGG('a', 'b', 'c');
SELECT STRING_AGG('a', 'b', 'c');
SELECT STRING_AGG('a', 'b', 'c');
SELECT STRING_AGG(STRING_AGG('a',','));
SELECT STRING_AGG(STRING_AGG('a',','));
;
SELECT STRING_AGG(STRING_AGG('a',','));
SELECT STRING_AGG(STRING_AGG('a',','));
SELECT STRING_AGG(STRING_AGG('a',','));
SELECT STRING_AGG('a',',');
SELECT STRING_AGG('a',',');
;
SELECT STRING_AGG('a',',');
SELECT STRING_AGG('a',',');
SELECT string_agg('a', ',');
;
;
;
;
SELECT STRING_AGG('a',',');
SELECT STRING_AGG('a',','), STRING_AGG(NULL,','), STRING_AGG('a', NULL), STRING_AGG(NULL,NULL);
SELECT STRING_AGG('a',','), STRING_AGG(NULL,','), STRING_AGG('a', NULL), STRING_AGG(NULL,NULL);
;
SELECT STRING_AGG('a',','), STRING_AGG(NULL,','), STRING_AGG('a', NULL), STRING_AGG(NULL,NULL);
SELECT STRING_AGG('a',','), STRING_AGG(NULL,','), STRING_AGG('a', NULL), STRING_AGG(NULL,NULL);
SELECT string_agg('a', ','), string_agg(NULL, ','), string_agg('a', NULL), string_agg(NULL, NULL);
;
;
;
;
SELECT STRING_AGG('a',','), STRING_AGG(NULL,','), STRING_AGG('a', NULL), STRING_AGG(NULL,NULL);
CREATE TABLE strings(g INTEGER, x VARCHAR, y VARCHAR);;
INSERT INTO strings VALUES (1,'a','/'), (1,'b','-'), (2,'i','/'), (2,NULL,'-'), (2,'j','+'), (3,'p','/'), (4,'x','/'), (4,'y','-'), (4,'z','+');
SELECT STRING_AGG(x,','), STRING_AGG(x,y) FROM strings;
SELECT STRING_AGG(x,','), STRING_AGG(x,y) FROM strings;
;
SELECT STRING_AGG(x,','), STRING_AGG(x,y) FROM strings;
SELECT STRING_AGG(x,','), STRING_AGG(x,y) FROM strings;
SELECT STRING_AGG(x,','), STRING_AGG(x,y) FROM strings;
SELECT g, STRING_AGG(x,'|') FROM strings GROUP BY g ORDER BY g;
SELECT g, STRING_AGG(x,'|') FROM strings GROUP BY g ORDER BY g;
;
SELECT g, STRING_AGG(x,'|') FROM strings GROUP BY g ORDER BY g;
SELECT g, STRING_AGG(x,'|') FROM strings GROUP BY g ORDER BY g;
SELECT g, string_agg(x, '|') FROM strings GROUP BY g ORDER BY g;
;
;
;
;
SELECT g, STRING_AGG(x,'|') FROM strings GROUP BY g ORDER BY g;
SELECT STRING_AGG(x,',') FROM strings WHERE g > 100;
SELECT STRING_AGG(x,',') FROM strings WHERE g > 100;
;
SELECT STRING_AGG(x,',') FROM strings WHERE g > 100;
SELECT STRING_AGG(x,',') FROM strings WHERE g > 100;
SELECT string_agg(x, ',') FROM strings WHERE (g > 100);
;
;
;
;
SELECT STRING_AGG(x,',') FROM strings WHERE g > 100;
SELECT STRING_AGG(1, 2);
SELECT STRING_AGG(1, 2);
;
SELECT STRING_AGG(1, 2);
SELECT STRING_AGG(1, 2);
SELECT STRING_AGG(1, 2);
SELECT GROUP_CONCAT('a', ',');
SELECT GROUP_CONCAT('a', ',');
;
SELECT GROUP_CONCAT('a', ',');
SELECT GROUP_CONCAT('a', ',');
SELECT group_concat('a', ',');
;
;
;
;
SELECT GROUP_CONCAT('a', ',');
SELECT GROUP_CONCAT('a');
SELECT GROUP_CONCAT('a');
;
SELECT GROUP_CONCAT('a');
SELECT GROUP_CONCAT('a');
SELECT group_concat('a');
;
;
;
;
SELECT GROUP_CONCAT('a');
SELECT g, GROUP_CONCAT(x) FROM strings GROUP BY g ORDER BY g;
SELECT g, GROUP_CONCAT(x) FROM strings GROUP BY g ORDER BY g;
;
SELECT g, GROUP_CONCAT(x) FROM strings GROUP BY g ORDER BY g;
SELECT g, GROUP_CONCAT(x) FROM strings GROUP BY g ORDER BY g;
SELECT g, group_concat(x) FROM strings GROUP BY g ORDER BY g;
;
;
;
;
SELECT g, GROUP_CONCAT(x) FROM strings GROUP BY g ORDER BY g;
PRAGMA verify_parallelism;
SELECT STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings;
SELECT STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings;
;
SELECT STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings;
SELECT STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings;
SELECT string_agg(x ORDER BY x ASC), string_agg(x, '|' ORDER BY x ASC) FROM strings;
;
;
;
;
SELECT STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings;
SELECT STRING_AGG(x ORDER BY x DESC), STRING_AGG(x,'|' ORDER BY x DESC) FROM strings;
SELECT STRING_AGG(x ORDER BY x DESC), STRING_AGG(x,'|' ORDER BY x DESC) FROM strings;
;
SELECT STRING_AGG(x ORDER BY x DESC), STRING_AGG(x,'|' ORDER BY x DESC) FROM strings;
SELECT STRING_AGG(x ORDER BY x DESC), STRING_AGG(x,'|' ORDER BY x DESC) FROM strings;
SELECT string_agg(x ORDER BY x DESC), string_agg(x, '|' ORDER BY x DESC) FROM strings;
;
;
;
;
SELECT STRING_AGG(x ORDER BY x DESC), STRING_AGG(x,'|' ORDER BY x DESC) FROM strings;
SELECT g, STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
;
SELECT g, STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, string_agg(x ORDER BY x ASC), string_agg(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
;
;
;
SELECT g, STRING_AGG(x ORDER BY x ASC), STRING_AGG(x, '|' ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x ORDER BY x DESC), STRING_AGG(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x ORDER BY x DESC), STRING_AGG(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
;
SELECT g, STRING_AGG(x ORDER BY x DESC), STRING_AGG(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x ORDER BY x DESC), STRING_AGG(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, string_agg(x ORDER BY x DESC), string_agg(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
;
;
;
SELECT g, STRING_AGG(x ORDER BY x DESC), STRING_AGG(x, '|' ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
;
SELECT g, STRING_AGG(x, y ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x ASC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
;
SELECT g, STRING_AGG(x, y ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT g, STRING_AGG(x, y ORDER BY x DESC) FROM strings GROUP BY g ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY CONCAT(x, y) ASC) FROM strings ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY CONCAT(x, y) ASC) FROM strings ORDER BY 1;
;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY CONCAT(x, y) ASC) FROM strings ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY CONCAT(x, y) ASC) FROM strings ORDER BY 1;
SELECT string_agg(CAST(g AS VARCHAR), ',' ORDER BY concat(x, y) ASC) FROM strings ORDER BY 1;
;
;
;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY CONCAT(x, y) ASC) FROM strings ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY x, y) FROM strings ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY x, y) FROM strings ORDER BY 1;
;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY x, y) FROM strings ORDER BY 1;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY x, y) FROM strings ORDER BY 1;
SELECT string_agg(CAST(g AS VARCHAR), ',' ORDER BY x, y) FROM strings ORDER BY 1;
;
;
;
SELECT STRING_AGG(g::VARCHAR, ',' ORDER BY x, y) FROM strings ORDER BY 1;
SELECT STRING_AGG(x, ',' ORDER BY x DESC), STRING_AGG(x, ',' ORDER BY x ASC) FROM strings;;
SELECT STRING_AGG(x, ',' ORDER BY x DESC), STRING_AGG(x, ',' ORDER BY x ASC) FROM strings;;
;
SELECT STRING_AGG(x, ',' ORDER BY x DESC), STRING_AGG(x, ',' ORDER BY x ASC) FROM strings;;
SELECT STRING_AGG(x, ',' ORDER BY x DESC), STRING_AGG(x, ',' ORDER BY x ASC) FROM strings;;
SELECT string_agg(x, ',' ORDER BY x DESC), string_agg(x, ',' ORDER BY x ASC) FROM strings;
;
;
;
;
SELECT STRING_AGG(x, ',' ORDER BY x DESC), STRING_AGG(x, ',' ORDER BY x ASC) FROM strings;;
SELECT y, STRING_AGG(x, ',' ORDER BY x DESC) FILTER (WHERE g < 3)
FROM strings
GROUP BY y
ORDER BY 1;
SELECT y, STRING_AGG(x, ',' ORDER BY x DESC) FILTER (WHERE g < 3)
FROM strings
GROUP BY y
ORDER BY 1;
;
SELECT y, STRING_AGG(x, ',' ORDER BY x DESC) FILTER (WHERE g < 3)
FROM strings
GROUP BY y
ORDER BY 1;
SELECT y, STRING_AGG(x, ',' ORDER BY x DESC) FILTER (WHERE g < 3)
FROM strings
GROUP BY y
ORDER BY 1;
SELECT y, string_agg(x, ',' ORDER BY x DESC) FILTER (WHERE (g < 3)) FROM strings GROUP BY y ORDER BY 1;
;
;
;
SELECT y, STRING_AGG(x, ',' ORDER BY x DESC) FILTER (WHERE g < 3)
FROM strings
GROUP BY y
ORDER BY 1;
SELECT g, STRING_AGG(DISTINCT y, ',' ORDER BY x DESC) FILTER (WHERE g < 4)
FROM strings
GROUP BY g
ORDER BY 1;
SELECT g, STRING_AGG(DISTINCT y, ',' ORDER BY x DESC) FILTER (WHERE g < 4)
FROM strings
GROUP BY g
ORDER BY 1;
;
SELECT g, STRING_AGG(DISTINCT y, ',' ORDER BY x DESC) FILTER (WHERE g < 4)
FROM strings
GROUP BY g
ORDER BY 1;
SELECT g, STRING_AGG(DISTINCT y, ',' ORDER BY x DESC) FILTER (WHERE g < 4)
FROM strings
GROUP BY g
ORDER BY 1;
SELECT g, STRING_AGG(DISTINCT y, ',' ORDER BY x DESC) FILTER (WHERE g < 4)
FROM strings
GROUP BY g
ORDER BY 1;
CREATE TABLE integers(i INTEGER);;
INSERT INTO integers (VALUES (1), (2), (3), (NULL));;
SELECT i1.i, (SELECT STRING_AGG(i::VARCHAR, ',' ORDER BY i1.i+i) FROM integers WHERE i<=i1.i) c1
FROM integers i1
ORDER BY 1 NULLS LAST;
SELECT i1.i, (SELECT STRING_AGG(i::VARCHAR, ',' ORDER BY i1.i+i) FROM integers WHERE i<=i1.i) c1
FROM integers i1
ORDER BY 1 NULLS LAST;
;
SELECT i1.i, (SELECT STRING_AGG(i::VARCHAR, ',' ORDER BY i1.i+i) FROM integers WHERE i<=i1.i) c1
FROM integers i1
ORDER BY 1 NULLS LAST;
SELECT i1.i, (SELECT STRING_AGG(i::VARCHAR, ',' ORDER BY i1.i+i) FROM integers WHERE i<=i1.i) c1
FROM integers i1
ORDER BY 1 NULLS LAST;
SELECT i1.i, (SELECT string_agg(CAST(i AS VARCHAR), ',' ORDER BY (i1.i + i)) FROM integers WHERE (i <= i1.i)) AS c1 FROM integers AS i1 ORDER BY 1 NULLS LAST;
;
;
;
SELECT i1.i, (SELECT STRING_AGG(i::VARCHAR, ',' ORDER BY i1.i+i) FROM integers WHERE i<=i1.i) c1
FROM integers i1
ORDER BY 1 NULLS LAST;
