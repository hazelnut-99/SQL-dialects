SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    store_rejects = true, auto_detect=true);;
SELECT * EXCLUDE (scan_id) FROM reject_errors;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad2.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'INTEGER'},
    store_rejects = true, auto_detect=false);;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad*.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    store_rejects = true, auto_detect=false);;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad*.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    store_rejects = true,rejects_limit=2, ignore_errors=true, auto_detect=false);;
SELECT COUNT(*) FROM reject_errors;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT SUM(num) FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/big_bad.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true, auto_detect=false);;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT SUM(num) FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/big_bad2.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true,  auto_detect=false);
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT SUM(num) FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/big_*.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true, auto_detect=false);;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT *
FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/small1.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true) as L
JOIN read_csv(
    'test/sql/copy/csv/data/error/mismatch/small2.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
   store_rejects = true) as R
ON L.num = R.num;;
SELECT * EXCLUDE (scan_id) FROM reject_scans ORDER BY ALL;;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
SELECT *
FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/small1.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true) as L
JOIN read_csv(
    'test/sql/copy/csv/data/error/mismatch/small2.csv',
    columns = {'num': 'INTEGER', 'str': 'VARCHAR'},
    store_rejects = true, rejects_limit=1) as R
ON L.num = R.num;;
SELECT * EXCLUDE (scan_id) FROM reject_errors ORDER BY ALL;;
DROP TABLE reject_errors;;
DROP TABLE reject_scans;;
