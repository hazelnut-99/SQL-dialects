select map_concat(map([3,4,5], ['a', 'b', 'c']), map([1], ['d']));
select map_concat(map([3,4,5], ['a', 'b', 'c']), map([], []));
select map_concat(map([], []), map([], []))
select map_concat(map([], []), map([3,4,5], ['a', 'b', 'c']));
select map_concat(map([], []), NULL);
select map_concat(NULL, NULL);
select map_concat(map([1], [1]), NULL);
select map_concat(
	map([3,4,5], ['a', 'b', 'c']),
	map([3,4,5], ['a', 'b', 'c']),
	map([3,4,5], ['a', 'b', 'd'])
);
select map_concat();
select map_concat(map([], []));
create table tbl(
	x map(BIGINT, VARCHAR),
	y map(BIGINT, VARCHAR),
	z map(BIGINT, VARCHAR),
);
insert into tbl values
(
	map([3,4,2], ['abc', 'over_twelve_characters', 'input']),
	map([3,1,5,2], ['cba', 'a', 'b', 'c']),
	map([3,7,6], ['1', NULL, '123'])
),
(
	map([42, 1, 0], ['tiny', 'small', 'bigger']),
	map([0, 42, 1], ['tiny', 'small', 'bigger']),
	map([1], ['this is a long string'])
),
(
	map([5, 1337, 0], ['long', 'longer', 'longest']),
	map([], []),
	NULL
);
select map_concat(x, y, z) from tbl;
select map_concat(x, y, z) from tbl where rowid != 0;
select map_concat(x, y, z) from tbl where rowid == 1;
drop table tbl;
create table tbl as select
	map(lower_range, lower_range) as c1,
	map(upper_range, upper_range) as c2 from (
		select
			range(3000) as lower_range,
			[i + 3000 for i in range(3000)] as upper_range
	)
select map_concat(c1, c2) from tbl;
select map(range(6000), range(6000));
drop table tbl;
create table tbl as select
	map([i], [i]) as c1,
	map([i + 1], [i + 1]) as c2 from (
		select * from range(3000) tbl(i)
	)
select map_concat(c1, c2) from tbl;
select map(range(i, i+2), range(i, i+2)) from (
	select * from range(3000) tbl(i)
);
select map(c1, c1) as val from test_vector_types(NULL::VARCHAR[]) tbl(c1) where c1 != [] and c1 != [NULL]
select map_concat(val, val, val) from (
	select map(c1, c1) as val from test_vector_types(NULL::VARCHAR[]) tbl(c1) where c1 != [] and c1 != [NULL]
)
prepare q1 as select map_concat($1, $2, $3);
execute q1(
	MAP([1,2,7], ['a', 'b', 'non_inlined_string']),
	MAP([], []),
	MAP([2,3,4,5], ['a', 'b', 'c', 'd'])
)
