CREATE TABLE strings(s STRING, g INTEGER);
INSERT INTO strings VALUES ('hello', 0), ('world', 1), (NULL, 0), ('r', 1);
SELECT COUNT(*), COUNT(s), MIN(s), MAX(s) FROM strings;
SELECT COUNT(*), COUNT(s), MIN(s), MAX(s) FROM strings WHERE s IS NULL;
SELECT STRING_AGG(s, ' '), STRING_AGG(s, ''), STRING_AGG('', ''), STRING_AGG('hello', ' ') FROM strings;
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(s, ' ') FROM strings GROUP BY g ORDER BY g;
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(DISTINCT g::VARCHAR ORDER BY g::VARCHAR DESC) FROM strings GROUP BY g ORDER BY g;;
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(DISTINCT s ORDER BY s ASC) FROM strings GROUP BY g ORDER BY g;;
SELECT g, COUNT(*), COUNT(s), MIN(s), MAX(s), STRING_AGG(s, ' ') FROM strings WHERE s IS NULL OR s <> 'hello' GROUP BY g ORDER BY g;
SELECT SUM(s) FROM strings GROUP BY g ORDER BY g;
SELECT AVG(s) FROM strings GROUP BY g ORDER BY g;
CREATE TABLE booleans(b BOOLEAN, g INTEGER);
INSERT INTO booleans VALUES (false, 0), (true, 1), (NULL, 0), (false, 1);
SELECT COUNT(*), COUNT(b), MIN(b), MAX(b) FROM booleans;
SELECT COUNT(*), COUNT(b), MIN(b), MAX(b) FROM booleans WHERE b IS NULL;
SELECT g, COUNT(*), COUNT(b), MIN(b), MAX(b) FROM booleans GROUP BY g ORDER BY g;
SELECT g, COUNT(*), COUNT(b), MIN(b), MAX(b) FROM booleans WHERE b IS NULL OR b=true GROUP BY g ORDER BY g;
SELECT SUM(b) FROM booleans GROUP BY g ORDER BY g;
SELECT AVG(b) FROM booleans GROUP BY g ORDER BY g;
CREATE TABLE integers(i INTEGER, g INTEGER);
INSERT INTO integers VALUES (12, 0), (22, 1), (NULL, 0), (14, 1);
SELECT COUNT(*), COUNT(i), MIN(i), MAX(i), SUM(i) FROM integers;
SELECT COUNT(*), COUNT(i), MIN(i), MAX(i), SUM(i) FROM INTEGERS WHERE i IS NULL;
SELECT g, COUNT(*), COUNT(i), MIN(i), MAX(i), SUM(i) FROM integers GROUP BY g ORDER BY g;
SELECT g, COUNT(*), COUNT(i), MIN(i), MAX(i), SUM(i) FROM integers WHERE i IS NULL OR i > 15 GROUP BY g ORDER BY g;
