PRAGMA enable_verification
SELECT UNNEST({'a': 42, 'b': 88})
SELECT UNNEST({'a': 42, 'b': 88})

SELECT UNNEST({'a': 42, 'b': 88})
SELECT unnest(main.struct_pack(a := 42, b := 88))




SELECT UNNEST({'a': 42, 'b': 88})
SELECT a, b FROM (SELECT UNNEST({'a': 42, 'b': 88}))
SELECT a, b FROM (SELECT UNNEST({'a': 42, 'b': 88}))

SELECT a, b FROM (SELECT UNNEST({'a': 42, 'b': 88}))
SELECT a, b FROM (SELECT unnest(main.struct_pack(a := 42, b := 88)))




SELECT a, b FROM (SELECT UNNEST({'a': 42, 'b': 88}))
SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}})
SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}})

SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}})
SELECT unnest(main.struct_pack(a := 42, b := main.struct_pack(c := 88, d := 99)))




SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}})
SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true)
SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true)

SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true)
SELECT unnest(main.struct_pack(a := 42, b := main.struct_pack(c := 88, d := 99)), "recursive" := CAST('t' AS BOOLEAN))



SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true)
SELECT UNNEST({'a': 42, 'b': {'c': {'x': 4}, 'd': 99}}, max_depth := 2)
SELECT UNNEST({'a': 42, 'b': {'c': {'x': 4}, 'd': 99}}, max_depth := 2)

SELECT UNNEST({'a': 42, 'b': {'c': {'x': 4}, 'd': 99}}, max_depth := 2)
SELECT unnest(main.struct_pack(a := 42, b := main.struct_pack(c := main.struct_pack(x := 4), d := 99)), max_depth := 2)



SELECT UNNEST({'a': 42, 'b': {'c': {'x': 4}, 'd': 99}}, max_depth := 2)
SELECT a, c, d FROM (SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true))
SELECT a, c, d FROM (SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true))

SELECT a, c, d FROM (SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true))
SELECT a, c, d FROM (SELECT unnest(main.struct_pack(a := 42, b := main.struct_pack(c := 88, d := 99)), "recursive" := CAST('t' AS BOOLEAN)))



SELECT a, c, d FROM (SELECT UNNEST({'a': 42, 'b': {'c': 88, 'd': 99}}, recursive := true))
SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}])
SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}])

SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}])
SELECT unnest(main.list_value(main.struct_pack(a := 42, b := 88), main.struct_pack(a := NULL, b := 99)))




SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}])
SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}], recursive := true)
SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}], recursive := true)

SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}], recursive := true)
SELECT unnest(main.list_value(main.struct_pack(a := 42, b := 88), main.struct_pack(a := NULL, b := 99)), "recursive" := CAST('t' AS BOOLEAN))



SELECT UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}], recursive := true)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=1)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=1)

SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=1)
SELECT unnest(main.list_value(main.list_value(main.struct_pack(a := 42, b := main.struct_pack(x := 99)), main.struct_pack(a := NULL, b := main.struct_pack(x := NULL)))), max_depth := 1)



SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=1)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=2)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=2)

SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=2)
SELECT unnest(main.list_value(main.list_value(main.struct_pack(a := 42, b := main.struct_pack(x := 99)), main.struct_pack(a := NULL, b := main.struct_pack(x := NULL)))), max_depth := 2)



SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=2)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=3)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=3)

SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=3)
SELECT unnest(main.list_value(main.list_value(main.struct_pack(a := 42, b := main.struct_pack(x := 99)), main.struct_pack(a := NULL, b := main.struct_pack(x := NULL)))), max_depth := 3)



SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=3)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=4)
SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=4)

SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=4)
SELECT unnest(main.list_value(main.list_value(main.struct_pack(a := 42, b := main.struct_pack(x := 99)), main.struct_pack(a := NULL, b := main.struct_pack(x := NULL)))), max_depth := 4)



SELECT UNNEST([[{'a': 42, 'b': {'x': 99}}, {'a': NULL, 'b': {'x': NULL}}]], max_depth:=4)
SELECT UNNEST({'a': [1, 2, 3]}, recursive := true)
SELECT UNNEST({'a': [1, 2, 3]}, recursive := true)

SELECT UNNEST({'a': [1, 2, 3]}, recursive := true)
SELECT unnest(main.struct_pack(a := main.list_value(1, 2, 3)), "recursive" := CAST('t' AS BOOLEAN))



SELECT UNNEST({'a': [1, 2, 3]}, recursive := true)
SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([1, 2, 3])
SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([1, 2, 3])

SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([1, 2, 3])
SELECT unnest(main.struct_pack(a := 44, b := 88)), unnest(main.list_value(1, 2, 3))




SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([1, 2, 3])
SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([[1, 2, 3], [4, 5]], recursive := true)
SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([[1, 2, 3], [4, 5]], recursive := true)

SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([[1, 2, 3], [4, 5]], recursive := true)
SELECT unnest(main.struct_pack(a := 44, b := 88)), unnest(main.list_value(main.list_value(1, 2, 3), main.list_value(4, 5)), "recursive" := CAST('t' AS BOOLEAN))



SELECT UNNEST({'a': 44, 'b': 88}), UNNEST([[1, 2, 3], [4, 5]], recursive := true)
SELECT a, "a_1", b FROM (SELECT UNNEST({'a': 42, 'b': {'a': 88, 'b': 99}}, recursive := true))
SELECT a, "a_1", b FROM (SELECT UNNEST({'a': 42, 'b': {'a': 88, 'b': 99}}, recursive := true))

SELECT a, "a_1", b FROM (SELECT UNNEST({'a': 42, 'b': {'a': 88, 'b': 99}}, recursive := true))
SELECT a, a_1, b FROM (SELECT unnest(main.struct_pack(a := 42, b := main.struct_pack(a := 88, b := 99)), "recursive" := CAST('t' AS BOOLEAN)))



SELECT a, "a_1", b FROM (SELECT UNNEST({'a': 42, 'b': {'a': 88, 'b': 99}}, recursive := true))
SELECT UNNEST({'a': 42, 'b': 88}) + 42
SELECT UNNEST({'a': 42, 'b': 88}) + 42

SELECT UNNEST({'a': 42, 'b': 88}) + 42
SELECT UNNEST({'a': 42, 'b': 88}) + 42
SELECT UNNEST(UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}]))
SELECT UNNEST(UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}]))

SELECT UNNEST(UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}]))
SELECT UNNEST(UNNEST([{'a': 42, 'b': 88}, {'a': NULL, 'b': 99}]))
