PRAGMA enable_verification;
SELECT Prompt FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
SELECT Prompt FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
;
SELECT Prompt FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
SELECT Prompt FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');
;
;
;
;
SELECT Prompt FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
FROM read_csv('test/sql/copy/csv/data/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d') limit 1;;
FROM read_csv('test/sql/copy/csv/data/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d') limit 1;;
;
FROM read_csv('test/sql/copy/csv/data/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d') limit 1;;
SELECT * FROM read_csv('test/sql/copy/csv/data/real/lineitem_sample.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = '|'), ("quote" = '"'), ("escape" = '"'), (new_line = '\n'), ("skip" = 0), ("header" = CAST('f' AS BOOLEAN)), ("columns" = main.struct_pack(column00 := 'BIGINT', column01 := 'BIGINT', column02 := 'BIGINT', column03 := 'BIGINT', column04 := 'BIGINT', column05 := 'DOUBLE', column06 := 'DOUBLE', column07 := 'DOUBLE', column08 := 'VARCHAR', column09 := 'VARCHAR', column10 := 'DATE', column11 := 'DATE', column12 := 'DATE', column13 := 'VARCHAR', column14 := 'VARCHAR', column15 := 'VARCHAR')), (dateformat = '%Y-%m-%d')) LIMIT 1;
;
;
;
;
FROM read_csv('test/sql/copy/csv/data/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d') limit 1;;
FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
;
FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
SELECT * FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/real/lineitem_sample.csv');;
FROM sniff_csv('test/sql/copy/csv/data/real/non_ecziste.csv');;
FROM sniff_csv('test/sql/copy/csv/data/real/non_ecziste.csv');;
;
FROM sniff_csv('test/sql/copy/csv/data/real/non_ecziste.csv');;
FROM sniff_csv('test/sql/copy/csv/data/real/non_ecziste.csv');;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=1);;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=1);;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=1);;
SELECT * FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', (sample_size = 1));
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=1);;
FROM read_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=0, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);;
FROM read_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=0, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);;
;
FROM read_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=0, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);;
FROM read_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=0, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=10000);;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=10000);;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=10000);;
SELECT * FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', (sample_size = 10000));
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=10000);;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=-1);;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=-1);;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=-1);;
SELECT * FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', (sample_size = -1));
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/error/mismatch/big_bad.csv', sample_size=-1);;
FROM sniff_csv('test/sql/copy/csv/data/test/dateformat.csv');
FROM sniff_csv('test/sql/copy/csv/data/test/dateformat.csv');
;
FROM sniff_csv('test/sql/copy/csv/data/test/dateformat.csv');
SELECT * FROM sniff_csv('test/sql/copy/csv/data/test/dateformat.csv');
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/test/dateformat.csv');
FROM read_csv('test/sql/copy/csv/data/test/dateformat.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');;
FROM read_csv('test/sql/copy/csv/data/test/dateformat.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');;
;
FROM read_csv('test/sql/copy/csv/data/test/dateformat.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');;
SELECT * FROM read_csv('test/sql/copy/csv/data/test/dateformat.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = ','), ("quote" = '"'), ("escape" = '"'), (new_line = '\n'), ("skip" = 0), ("header" = CAST('f' AS BOOLEAN)), ("columns" = main.struct_pack(column0 := 'DATE')), (dateformat = '%d/%m/%Y'));
;
;
;
;
FROM read_csv('test/sql/copy/csv/data/test/dateformat.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');;
FROM sniff_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv');
FROM sniff_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv');
;
FROM sniff_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv');
SELECT * FROM sniff_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv');
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv');
FROM read_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');;
FROM read_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');;
;
FROM read_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');;
SELECT * FROM read_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = ','), ("quote" = '"'), ("escape" = '"'), (new_line = '\n'), ("skip" = 0), ("header" = CAST('t' AS BOOLEAN)), ("columns" = main.struct_pack(a := 'BIGINT', b := 'VARCHAR', t := 'TIME', d := 'DATE', ts := 'TIMESTAMP')), (dateformat = '%Y.%m.%d'), (timestampformat = '%Y.%m.%d %H:%M:%S'));
;
;
;
;
FROM read_csv('test/sql/copy/csv/data/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');;
FROM sniff_csv('data/csv/inconsistent_cells.csv');
FROM sniff_csv('data/csv/inconsistent_cells.csv');
;
FROM sniff_csv('data/csv/inconsistent_cells.csv');
SELECT * FROM sniff_csv('data/csv/inconsistent_cells.csv');
;
;
;
;
FROM sniff_csv('data/csv/inconsistent_cells.csv');
FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=3, header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});;
FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=3, header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});;
;
FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=3, header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});;
SELECT * FROM read_csv('data/csv/inconsistent_cells.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = ','), ("quote" = '"'), ("escape" = '"'), (new_line = '\n'), ("skip" = 3), ("header" = CAST('f' AS BOOLEAN)), ("columns" = main.struct_pack(column0 := 'BIGINT', column1 := 'BIGINT', column2 := 'BIGINT', column3 := 'BIGINT', column4 := 'BIGINT')));
;
;
;
;
FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=3, header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});;
FROM sniff_csv('data/csv/timings.csv');
FROM sniff_csv('data/csv/timings.csv');
;
FROM sniff_csv('data/csv/timings.csv');
SELECT * FROM sniff_csv('data/csv/timings.csv');
;
;
;
;
FROM sniff_csv('data/csv/timings.csv');
FROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d') order by all limit 1;;
FROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d') order by all limit 1;;
;
FROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d') order by all limit 1;;
SELECT * FROM read_csv('data/csv/timings.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = '|'), ("quote" = '"'), ("escape" = '\'), (new_line = '\n'), ("skip" = 0), ("header" = CAST('t' AS BOOLEAN)), ("columns" = main.struct_pack(tool := 'VARCHAR', sf := 'BIGINT', "day" := 'DATE', batch_type := 'VARCHAR', q := 'VARCHAR', parameters := 'VARCHAR', "time" := 'DOUBLE')), (dateformat = '%Y-%m-%d')) ORDER BY COLUMNS(*) LIMIT 1;
;
;
;
;
FROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d') order by all limit 1;;
FROM sniff_csv('test/sql/copy/csv/data/auto/backslash_escape.csv');
FROM sniff_csv('test/sql/copy/csv/data/auto/backslash_escape.csv');
;
FROM sniff_csv('test/sql/copy/csv/data/auto/backslash_escape.csv');
SELECT * FROM sniff_csv('test/sql/copy/csv/data/auto/backslash_escape.csv');
;
;
;
;
FROM sniff_csv('test/sql/copy/csv/data/auto/backslash_escape.csv');
FROM read_csv('test/sql/copy/csv/data/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});;
FROM read_csv('test/sql/copy/csv/data/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});;
;
FROM read_csv('test/sql/copy/csv/data/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});;
SELECT * FROM read_csv('test/sql/copy/csv/data/auto/backslash_escape.csv', (auto_detect = CAST('f' AS BOOLEAN)), (delim = '|'), ("quote" = '"'), ("escape" = '\'), (new_line = '\n'), ("skip" = 0), ("header" = CAST('f' AS BOOLEAN)), ("columns" = main.struct_pack(column0 := 'BIGINT', column1 := 'VARCHAR', column2 := 'VARCHAR')));
;
;
;
;
FROM read_csv('test/sql/copy/csv/data/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='"', escape='\', new_line='\n', skip=0, header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});;
