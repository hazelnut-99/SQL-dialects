PRAGMA enable_verification;
CREATE VIEW v1 AS
SELECT map([2], [{'key1': map([3,4],[1,2]), 'key2':2}]) AS x;
SELECT * FROM v1;;
SELECT * FROM v1;;
;
SELECT * FROM v1;;
SELECT * FROM v1;
;
;
;
;
SELECT * FROM v1;;
COPY v1
TO 'duckdb_unittest_tempdir/54761/map.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54761/map.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
CREATE VIEW v2 AS
SELECT map([2], [{'key1': map([3,4],[1,2]), 'key2':2}]) AS x
UNION ALL
SELECT map([2], [{'key1': map([3,4],[1,2]), 'key2':2}]);
SELECT * FROM v2;;
SELECT * FROM v2;;
;
SELECT * FROM v2;;
SELECT * FROM v2;
;
;
;
;
SELECT * FROM v2;;
COPY v2
TO 'duckdb_unittest_tempdir/54761/map.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54761/map.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
CREATE VIEW v3 AS
SELECT {'key': [2], 'val': [{'key1': {'key': [3,4], 'val': [1,2]}, 'key2':2}]} AS x;
SELECT * FROM v3;;
SELECT * FROM v3;;
;
SELECT * FROM v3;;
SELECT * FROM v3;
;
;
;
;
SELECT * FROM v3;;
COPY v3
TO 'duckdb_unittest_tempdir/54761/map.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54761/map.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
CREATE VIEW v4 AS
SELECT {'key': [2], 'val': [{'key1': {'key': [3,4], 'val': [1,2]}, 'key2':[2]}]} AS x;
SELECT * FROM v4;;
SELECT * FROM v4;;
;
SELECT * FROM v4;;
SELECT * FROM v4;
;
;
;
;
SELECT * FROM v4;;
COPY v4
TO 'duckdb_unittest_tempdir/54761/map.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
SELECT * FROM "duckdb_unittest_tempdir/54761/map.parquet";
;
;
;
;
SELECT * FROM 'duckdb_unittest_tempdir/54761/map.parquet';;
