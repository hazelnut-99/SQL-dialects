SET default_null_order='nulls_first';;
PRAGMA enable_verification;
PRAGMA verify_external;
create table quantiles as select range r, random() FROM range(10000) union all values (NULL, 0.1), (NULL, 0.5), (NULL, 0.9) order by 2;;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(d::decimal(4,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(4,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::decimal(4,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(4,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS DECIMAL(4,1)), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::decimal(4,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(8,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(8,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::decimal(8,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(8,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS DECIMAL(8,1)), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::decimal(8,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(12,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(12,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::decimal(12,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(12,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS DECIMAL(12,1)), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::decimal(12,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(18,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(18,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::decimal(18,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(18,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS DECIMAL(18,1)), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::decimal(18,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(24,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(24,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::decimal(24,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::decimal(24,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS DECIMAL(24,1)), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::decimal(24,1), [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(col, [-.25, -.5, -.75])
FROM VALUES (11000), (3100), (2900), (2800), (2600), (2500) AS tab(col);;
SELECT quantile_disc(col, [-.25, -.5, -.75])
FROM VALUES (11000), (3100), (2900), (2800), (2600), (2500) AS tab(col);;
;
SELECT quantile_disc(col, [-.25, -.5, -.75])
FROM VALUES (11000), (3100), (2900), (2800), (2600), (2500) AS tab(col);;
SELECT quantile_disc(col, [-.25, -.5, -.75])
FROM VALUES (11000), (3100), (2900), (2800), (2600), (2500) AS tab(col);;
SELECT quantile_disc(col, main.list_value(-.25, -.5, -.75)) FROM (SELECT * FROM (VALUES (11000), (3100), (2900), (2800), (2600), (2500)) AS valueslist) AS tab(col);
;
;
;
;
SELECT quantile_disc(col, [-.25, -.5, -.75])
FROM VALUES (11000), (3100), (2900), (2800), (2600), (2500) AS tab(col);;
SELECT quantile_disc(d::VARCHAR, [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::VARCHAR, [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
;
SELECT quantile_disc(d::VARCHAR, [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(d::VARCHAR, [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT quantile_disc(CAST(d AS VARCHAR), main.list_value(0.1, 0.5, 0.9)) FROM range(0, 100) AS tbl(d);
;
;
;
;
SELECT quantile_disc(d::VARCHAR, [0.1, 0.5, 0.9])
FROM range(0,100) tbl(d);
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r, 10) AS g, quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles GROUP BY 1 ORDER BY 1;
;
;
;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles WHERE (1 = 0);
;
;
;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, []) FROM quantiles;
;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, main.list_value()) FROM quantiles;
;
;
;
;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc('2021-01-01'::TIMESTAMP + interval (r) hour, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('2021-01-01'::TIMESTAMP + interval (r) hour, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc('2021-01-01'::TIMESTAMP + interval (r) hour, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('2021-01-01'::TIMESTAMP + interval (r) hour, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc((CAST('2021-01-01' AS TIMESTAMP) + to_hours(CAST(trunc(CAST(r AS DOUBLE)) AS BIGINT))), main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc('2021-01-01'::TIMESTAMP + interval (r) hour, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('1990-01-01'::DATE + interval (r) day, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('1990-01-01'::DATE + interval (r) day, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc('1990-01-01'::DATE + interval (r) day, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('1990-01-01'::DATE + interval (r) day, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc((CAST('1990-01-01' AS DATE) + to_days(CAST(trunc(CAST(r AS DOUBLE)) AS INTEGER))), main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc('1990-01-01'::DATE + interval (r) day, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('00:00:00'::TIME + interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('00:00:00'::TIME + interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc('00:00:00'::TIME + interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc('00:00:00'::TIME + interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc((CAST('00:00:00' AS TIME) + to_seconds(CAST(r AS DOUBLE))), main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc('00:00:00'::TIME + interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(to_seconds(CAST(r AS DOUBLE)), main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(interval (r) second, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(('2021-01-01'::TIMESTAMP + interval (r) hour)::TIMESTAMPTZ, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(('2021-01-01'::TIMESTAMP + interval (r) hour)::TIMESTAMPTZ, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(('2021-01-01'::TIMESTAMP + interval (r) hour)::TIMESTAMPTZ, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(('2021-01-01'::TIMESTAMP + interval (r) hour)::TIMESTAMPTZ, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(CAST((CAST('2021-01-01' AS TIMESTAMP) + to_hours(CAST(trunc(CAST(r AS DOUBLE)) AS BIGINT))) AS TIMESTAMP WITH TIME ZONE), main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(('2021-01-01'::TIMESTAMP + interval (r) hour)::TIMESTAMPTZ, [0.1, 0.5, 0.9]) FROM quantiles;
pragma threads=4;
PRAGMA verify_parallelism;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT mod(r, 10) AS g, quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles GROUP BY 1 ORDER BY 1;
;
;
;
SELECT mod(r,10) as g, quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles GROUP BY 1 ORDER BY 1;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(1, main.list_value(0.1, 0.5, 0.9)) FROM quantiles;
;
;
;
;
SELECT quantile_disc(1, [0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, main.list_value(0.1, 0.5, 0.9)) FROM quantiles WHERE (1 = 0);
;
;
;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9]) FROM quantiles WHERE 1=0;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, []) FROM quantiles;
;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(r, main.list_value()) FROM quantiles;
;
;
;
;
SELECT quantile_disc(r, []) FROM quantiles;
SELECT quantile_disc(col, [0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1])
FROM VALUES (0), (1), (2), (10) AS tab(col);;
SELECT quantile_disc(col, [0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1])
FROM VALUES (0), (1), (2), (10) AS tab(col);;
;
SELECT quantile_disc(col, [0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1])
FROM VALUES (0), (1), (2), (10) AS tab(col);;
SELECT quantile_disc(col, [0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1])
FROM VALUES (0), (1), (2), (10) AS tab(col);;
SELECT quantile_disc(col, main.list_value(0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1)) FROM (SELECT * FROM (VALUES (0), (1), (2), (10)) AS valueslist) AS tab(col);
;
;
;
;
SELECT quantile_disc(col, [0.1, 0.32, 0.33, 0.34, 0.49, .5, .51, 0.75, 0.9, 0.999, 1])
FROM VALUES (0), (1), (2), (10) AS tab(col);;
SELECT quantile_disc(42::UTINYINT, 0.5);;
SELECT quantile_disc(42::UTINYINT, 0.5);;
;
SELECT quantile_disc(42::UTINYINT, 0.5);;
SELECT quantile_disc(42::UTINYINT, 0.5);;
SELECT quantile_disc(CAST(42 AS UTINYINT), 0.5);
;
;
;
;
SELECT quantile_disc(42::UTINYINT, 0.5);;
SELECT quantile_disc(r, [-0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [-0.1, 0.5, 0.9]) FROM quantiles;
;
SELECT quantile_disc(r, [-0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [-0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, [-0.1, 0.5, 0.9]) FROM quantiles;
SELECT quantile_disc(r, (0.1, 0.5, 1.1)) FROM quantiles;
SELECT quantile_disc(r, (0.1, 0.5, 1.1)) FROM quantiles;
;
SELECT quantile_disc(r, (0.1, 0.5, 1.1)) FROM quantiles;
SELECT quantile_disc(r, (0.1, 0.5, 1.1)) FROM quantiles;
SELECT quantile_disc(r, (0.1, 0.5, 1.1)) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, NULL]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, NULL]) FROM quantiles;
;
SELECT quantile_disc(r, [0.1, 0.5, NULL]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, NULL]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, NULL]) FROM quantiles;
SELECT quantile_disc(r, ["0.1", "0.5", "0.9"]) FROM quantiles;
SELECT quantile_disc(r, ["0.1", "0.5", "0.9"]) FROM quantiles;
;
SELECT quantile_disc(r, ["0.1", "0.5", "0.9"]) FROM quantiles;
SELECT quantile_disc(r, ["0.1", "0.5", "0.9"]) FROM quantiles;
SELECT quantile_disc(r, ["0.1", "0.5", "0.9"]) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9], 50) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9], 50) FROM quantiles;
;
SELECT quantile_disc(r, [0.1, 0.5, 0.9], 50) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9], 50) FROM quantiles;
SELECT quantile_disc(r, [0.1, 0.5, 0.9], 50) FROM quantiles;
