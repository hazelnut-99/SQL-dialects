create type enum_numstrings as enum ('1', '2', '3', '4');
create table t1 as select range as a from range(10);
create table t2 (a enum_numstrings);
insert into t2 values ('1'), ('2'), ('3');
select t1.a, count(*) as num_matches from t1, t2 where t1.a != t2.a group by t1.a order by t1.a;
insert into t2 values ('1'), ('2');
select * from t1, t2 where t1.a = t2.a order by t1.a;
delete from t2 where 1=1;
insert into t2 values (NULL), ('1');
select * from t1, t2 order by t1.a, t2.a NULLS FIRST;
insert into t2 values  ('2'), ('3'), ('4');
select * from t1, t2 where t2.a NOT IN ('2', '3', '4') order by t1.a, t2.a NULLS FIRST;
insert into t2 values ('1'), ('2'), ('3');
EXPLAIN select * from t1, t2 where t2.a = '2' order by t1.a;
drop table t1
drop table t2
create type enum_strings as enum ('hello', 'goodbye', 'mr duck');
create table t1 as select range as a from range(500);
create table t2 (a enum_strings);
insert into t2 values ('hello'), ('goodbye'), ('mr duck'),  ('mr duck'), ('hello'), ('goodbye');
Select * from t1, t2 where t1.a = t2.a;
Select * from t1, t2 where t1.a::VARCHAR = t2.a;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::varchar as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::tinyint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::smallint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::integer as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::bigint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::hugeint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::utinyint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::usmallint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::uinteger as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('1', '2', '3', '4', '5');
create table t1 as select range::ubigint as a from range(8);
create table t2 as select (range%4+1)::VARCHAR::new_type as b from range(8);
select a from t1, t2 where t1.a = t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR < t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR <= t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR > t2.b;
select count(*) from t1, t2 where t1.a::VARCHAR >= t2.b;
drop type new_type;
drop table t1; 
drop table t2; 
create type new_type as enum ('294247-01-10 04:00:54.775806', '83 years 3 months 999 days 00:16:39.999999', '1677-09-21 00:12:43.145225', 'other enum type', 'another 1', '~~~');
create table t1 as select date, time, timestamp, timestamp_s, timestamp_ms, timestamp_ns, time_tz, timestamp_tz, interval, blob, bool from test_all_types();
create table t2 as select * from VALUES ('294247-01-10 04:00:54.775806'::new_type), ('83 years 3 months 999 days 00:16:39.999999'::new_type), ('1677-09-21 00:12:43.145225'::new_type), ('other enum type'::new_type), ('another 1'::new_type), ('~~~'::new_type) t(b);
select count(*) from t1, t2 where t1.date = t2.b;
select count(*) from t1, t2 where t1.time = t2.b;
select count(*) from t1, t2 where t1.timestamp = t2.b;
select count(*) from t1, t2 where t1.timestamp_s = t2.b;
select count(*) from t1, t2 where t1.timestamp_ms = t2.b;
select count(*) from t1, t2 where t1.timestamp_ns = t2.b;
select count(*) from t1, t2 where t1.time_tz = t2.b;
select count(*) from t1, t2 where t1.timestamp_tz = t2.b;
select count(*) from t1, t2 where t1.interval = t2.b;
select count(*) from t1, t2 where t1.blob = t2.b;
drop table t1;
drop table t2;
create type enum_bits as enum ('11001010110', '110', '0101001010101', 'some enum val that cannot be cast to bit');
create table t1 as select * from values ('110010'::BIT), ('110'::BIT), ('110110110011'::BIT) t(a);
create table t2 as select * from values ('11001010110'::enum_bits), ('110'::enum_bits), ('0101001010101'::enum_bits), ('some enum val that cannot be cast to bit'::enum_bits) t(b);
select count(*) from t1, t2 where t1.a = t2.b;
