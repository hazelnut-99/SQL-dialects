pragma enable_verification;;
create table insertconflicttest(
	key int4,
	fruit text,
	other int4,
	unique (key, fruit)
);;
insert into insertconflicttest values(0, 'Crowberry', 0) on conflict (key) do nothing;;
insert into insertconflicttest values(0, 'Crowberry', 0) on conflict (fruit) do nothing;;
insert into insertconflicttest values(0, 'Crowberry', 0) on conflict (key, fruit) do nothing;;
insert into insertconflicttest values(0, 'Crowberry', 0) on conflict (fruit, key, fruit, key) do nothing;;
insert into insertconflicttest
values (0, 'Crowberry', 0) on conflict (key, fruit) do update set other = 1 where exists (select 1 from insertconflicttest ii where ii.key = excluded.key);;
insert into insertconflicttest values (7, 'Raspberry', 0) on conflict (key, fruit) do update set other = 1;
insert into insertconflicttest values (8, 'Lime', 0) on conflict (fruit, key) do update set other = 1;
insert into insertconflicttest values (9, 'Banana', 0) on conflict (key) do update set other = 1;
insert into insertconflicttest values (10, 'Blueberry', 0) on conflict (key, key, key) do update set other = 1;
insert into insertconflicttest values (11, 'Cherry', 0) on conflict (key, fruit) do update set other = 1;
insert into insertconflicttest values (12, 'Date', 0) on conflict (fruit, key) do update set other = 1;
create unique index expr_key_index on insertconflicttest(fruit);;
insert into insertconflicttest values (20, 'Quince', 0) on conflict (fruit) do update set other = 1;
insert into insertconflicttest values (21, 'Pomegranate', 0) on conflict (fruit, fruit) do update set other = 1;
create unique index expr_comp_key_index on insertconflicttest(key, fruit);;
create unique index tricky_expr_comp_key_index on insertconflicttest(key, fruit, fruit);;
insert into insertconflicttest values (24, 'Plum', 0) on conflict (key, fruit) do update set other = 1;
insert into insertconflicttest values (25, 'Peach', 0) on conflict (fruit, key) do update set other = 1;
insert into insertconflicttest values (26, 'Fig', 0) on conflict (fruit, key, fruit, key) do update set other = 1;
