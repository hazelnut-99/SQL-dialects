PRAGMA verify_external;
CREATE TABLE tinyints(i TINYINT);
INSERT INTO tinyints VALUES(1), (8), (3), (12), (7), (1), (2), (8);
SELECT BITSTRING_AGG(i) FROM tinyints;
SELECT BITSTRING_AGG(i) FROM tinyints;
SELECT bitstring_agg(i) FROM tinyints;
;
SELECT BITSTRING_AGG(i) FROM tinyints;
SELECT bit_count(BITSTRING_AGG(i)) FROM tinyints WHERE i <= 7;
SELECT bit_count(BITSTRING_AGG(i)) FROM tinyints WHERE i <= 7;
SELECT bit_count(bitstring_agg(i)) FROM tinyints WHERE (i <= 7);
;
SELECT bit_count(BITSTRING_AGG(i)) FROM tinyints WHERE i <= 7;
CREATE TABLE smallints(i SMALLINT);
INSERT INTO smallints VALUES(1), (8), (-3), (12), (7), (1), (-1), (-9), (NULL), (-2), (8);
SELECT BITSTRING_AGG(i) FROM smallints;
SELECT BITSTRING_AGG(i) FROM smallints;
SELECT bitstring_agg(i) FROM smallints;
;
SELECT BITSTRING_AGG(i) FROM smallints;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints WHERE i = 8;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints WHERE i = 8;
SELECT bit_count(bitstring_agg(i)) FROM smallints WHERE (i = 8);
;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints WHERE i = 8;
CREATE TABLE ints(i INTEGER);;
INSERT INTO ints VALUES(10), (-5), (11), (NULL), (30), (11), (23), (17), (27), (15), (5), (14);
SELECT BITSTRING_AGG(i) FROM ints;
SELECT BITSTRING_AGG(i) FROM ints;
SELECT bitstring_agg(i) FROM ints;
;
SELECT BITSTRING_AGG(i) FROM ints;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints WHERE i > 20 AND i < 28;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints WHERE i > 20 AND i < 28;
SELECT bit_count(bitstring_agg(i)) FROM ints WHERE ((i > 20) AND (i < 28));
;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints WHERE i > 20 AND i < 28;
CREATE TABLE bigints(i BIGINT);;
INSERT INTO bigints VALUES(2378097), (2378100), (2378095), (2378104), (NULL), (2378113), (2378100), (2378095), (2378105), (2378097);
SELECT BITSTRING_AGG(i) FROM bigints;
SELECT BITSTRING_AGG(i) FROM bigints;
SELECT bitstring_agg(i) FROM bigints;
;
SELECT BITSTRING_AGG(i) FROM bigints;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints WHERE i = 100;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints WHERE i = 100;
SELECT bit_count(bitstring_agg(i)) FROM bigints WHERE (i = 100);
;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints WHERE i = 100;
CREATE TABLE hugeints(i HUGEINT);;
INSERT INTO hugeints VALUES(12243372036854775807), (12243372036854778191), (12243372036854730332), (12243372036854773737), (12243372036854737711), (12243372036854722124), (12243372036854778191);
SELECT bit_length(BITSTRING_AGG(i)) FROM hugeints;
SELECT bit_length(BITSTRING_AGG(i)) FROM hugeints;
SELECT bit_length(bitstring_agg(i)) FROM hugeints;
;
SELECT bit_length(BITSTRING_AGG(i)) FROM hugeints;
CREATE TABLE uhugeints(i UHUGEINT);;
INSERT INTO uhugeints VALUES(12243372036854775807), (12243372036854778191), (12243372036854730332), (12243372036854773737), (12243372036854737711), (12243372036854722124), (12243372036854778191);
SELECT bit_length(BITSTRING_AGG(i)) FROM uhugeints;
SELECT bit_length(BITSTRING_AGG(i)) FROM uhugeints;
SELECT bit_length(bitstring_agg(i)) FROM uhugeints;
;
SELECT bit_length(BITSTRING_AGG(i)) FROM uhugeints;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints;
SELECT bit_count(bitstring_agg(i)) FROM smallints;
;
SELECT bit_count(BITSTRING_AGG(i)) FROM smallints;
SELECT COUNT(DISTINCT i) FROM smallints;
SELECT COUNT(DISTINCT i) FROM smallints;
SELECT count(DISTINCT i) FROM smallints;
;
SELECT COUNT(DISTINCT i) FROM smallints;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints;
SELECT bit_count(bitstring_agg(i)) FROM ints;
;
SELECT bit_count(BITSTRING_AGG(i)) FROM ints;
SELECT COUNT(DISTINCT i) FROM ints;
SELECT COUNT(DISTINCT i) FROM ints;
SELECT count(DISTINCT i) FROM ints;
;
SELECT COUNT(DISTINCT i) FROM ints;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints;
SELECT bit_count(bitstring_agg(i)) FROM bigints;
;
SELECT bit_count(BITSTRING_AGG(i)) FROM bigints;
SELECT COUNT(DISTINCT i) FROM bigints;
SELECT COUNT(DISTINCT i) FROM bigints;
SELECT count(DISTINCT i) FROM bigints;
;
SELECT COUNT(DISTINCT i) FROM bigints;
SELECT bit_count(BITSTRING_AGG(i)) FROM hugeints;
SELECT bit_count(BITSTRING_AGG(i)) FROM hugeints;
SELECT bit_count(bitstring_agg(i)) FROM hugeints;
;
SELECT bit_count(BITSTRING_AGG(i)) FROM hugeints;
SELECT COUNT(DISTINCT i) FROM hugeints;
SELECT COUNT(DISTINCT i) FROM hugeints;
SELECT count(DISTINCT i) FROM hugeints;
;
SELECT COUNT(DISTINCT i) FROM hugeints;
SELECT BITSTRING_AGG(i, -5, 30) FROM ints;
SELECT BITSTRING_AGG(i, -5, 30) FROM ints;
SELECT bitstring_agg(i, -5, 30) FROM ints;
;
SELECT BITSTRING_AGG(i, -5, 30) FROM ints;
SELECT BITSTRING_AGG(i, -10, 40) FROM ints;
SELECT BITSTRING_AGG(i, -10, 40) FROM ints;
SELECT bitstring_agg(i, -10, 40) FROM ints;
;
SELECT BITSTRING_AGG(i, -10, 40) FROM ints;
SELECT BITSTRING_AGG(i, -10, 20) FROM ints;
SELECT BITSTRING_AGG(i, -10, 20) FROM ints;
SELECT BITSTRING_AGG(i, -10, 20) FROM ints;
SELECT BITSTRING_AGG(i, 0, 15) FROM tinyints;
SELECT BITSTRING_AGG(i, 0, 15) FROM tinyints;
SELECT bitstring_agg(i, 0, 15) FROM tinyints;
;
SELECT BITSTRING_AGG(i, 0, 15) FROM tinyints;
SELECT BITSTRING_AGG(i, 2, 15) FROM tinyints;
SELECT BITSTRING_AGG(i, 2, 15) FROM tinyints;
SELECT BITSTRING_AGG(i, 2, 15) FROM tinyints;
SELECT BITSTRING_AGG(i, 2378080, 2378150) FROM bigints;
SELECT BITSTRING_AGG(i, 2378080, 2378150) FROM bigints;
SELECT bitstring_agg(i, 2378080, 2378150) FROM bigints;
;
SELECT BITSTRING_AGG(i, 2378080, 2378150) FROM bigints;
SELECT BITSTRING_AGG(3);
SELECT BITSTRING_AGG(3);
SELECT bitstring_agg(3);
;
SELECT BITSTRING_AGG(3);
SELECT BITSTRING_AGG(2, 0, 5);
SELECT BITSTRING_AGG(2, 0, 5);
SELECT bitstring_agg(2, 0, 5);
;
SELECT BITSTRING_AGG(2, 0, 5);
CREATE TABLE null_table(i INT);;
INSERT INTO null_table VALUES(NULL);
SELECT BITSTRING_AGG(i) FROM null_table;
SELECT BITSTRING_AGG(i) FROM null_table;
SELECT bitstring_agg(i) FROM null_table;
;
SELECT BITSTRING_AGG(i) FROM null_table;
INSERT INTO null_table VALUES(6), (NULL), (NULL), (NULL), (NULL);
SELECT BITSTRING_AGG(i) FROM null_table;
SELECT BITSTRING_AGG(i) FROM null_table;
SELECT bitstring_agg(i) FROM null_table;
;
SELECT BITSTRING_AGG(i) FROM null_table;
COPY (SELECT i FROM ints) TO 'duckdb_unittest_tempdir/53437/bitstring_agg.csv' (HEADER 0);;
SELECT BITSTRING_AGG(column0) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT BITSTRING_AGG(column0) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT BITSTRING_AGG(column0) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT BITSTRING_AGG(column0, -10, 40) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT BITSTRING_AGG(column0, -10, 40) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT bitstring_agg(column0, -10, 40) FROM "duckdb_unittest_tempdir/53437/bitstring_agg.csv";
;
SELECT BITSTRING_AGG(column0, -10, 40) FROM 'duckdb_unittest_tempdir/53437/bitstring_agg.csv';;
SELECT BITSTRING_AGG();
SELECT BITSTRING_AGG();
SELECT BITSTRING_AGG();
SELECT BITSTRING_AGG(1, 3, 4, 8, 0);
SELECT BITSTRING_AGG(1, 3, 4, 8, 0);
SELECT BITSTRING_AGG(1, 3, 4, 8, 0);
CREATE TABLE groups(i INT, g VARCHAR);;
INSERT INTO groups VALUES(10, 'a'), (13, 'b'), (9, 'a'), (16, 'c'), (NULL, 'd'), (2, 'a'), (6, 'c'), (9, 'b');
SELECT g, BITSTRING_AGG(i) FROM groups GROUP BY g ORDER BY g;
SELECT g, BITSTRING_AGG(i) FROM groups GROUP BY g ORDER BY g;
SELECT g, bitstring_agg(i) FROM "groups" GROUP BY g ORDER BY g;
;
SELECT g, BITSTRING_AGG(i) FROM groups GROUP BY g ORDER BY g;
PRAGMA disable_optimizer;
SELECT BITSTRING_AGG(i) FROM ints;
SELECT BITSTRING_AGG(i) FROM ints;
SELECT bitstring_agg(i) FROM ints;
;
SELECT BITSTRING_AGG(i) FROM ints;
SELECT BITSTRING_AGG(i, -5, 32) FROM ints;
SELECT BITSTRING_AGG(i, -5, 32) FROM ints;
SELECT bitstring_agg(i, -5, 32) FROM ints;
;
SELECT BITSTRING_AGG(i, -5, 32) FROM ints;
