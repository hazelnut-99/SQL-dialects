CREATE TABLE tbl(u UNION(num INTEGER, str STRING));
INSERT INTO tbl VALUES (union_value(num := 1));
INSERT INTO tbl VALUES (union_value());
INSERT INTO tbl VALUES (union_value(num := 1, other := 2))
INSERT INTO tbl VALUES (union_value(key := 1))
INSERT INTO tbl VALUES (union_value(num := 1)), (1), (union_value(str := 'hello')), (2), ('world');
INSERT INTO tbl SELECT 
    union_value(num := 1)::UNION(num INTEGER, str STRING) 
UNION ALL SELECT 
    union_value(str := 'hello')::UNION(num INTEGER, str STRING) 
SELECT CASE WHEN union_tag(u) = 'num' THEN u ELSE NULL END AS num FROM tbl;
CREATE TABLE tbl3 (u UNION(num INTEGER, str STRING));
INSERT INTO tbl3 VALUES 
    (union_value(num := 1)),
    (union_value(num := NULL)),
    (union_value(str := '3')),
    (union_value(str := NULL)),
SELECT u from tbl3 where u = NULL
SELECT union_value(str := NULL) IS NULL;
SELECT union_tag(union_value(str := NULL))
SELECT union_tag(u), u FROM tbl3;
