PRAGMA enable_verification;
CREATE TABLE integers(i INTEGER);;
INSERT INTO integers VALUES (1), (2), (3), (NULL);
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS LAST');
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS LAST');
;
;
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS FIRST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS FIRST');
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS FIRST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS FIRST');
;
;
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'ASC NULLS FIRST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS LAST');
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS LAST');
;
;
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS LAST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS FIRST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS FIRST');
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS FIRST');
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM integers ORDER BY create_sort_key(i, 'DESC NULLS FIRST');
CREATE TABLE varchars(v VARCHAR);;
INSERT INTO varchars VALUES ('hello'), ('hello' || chr(0) || chr(0)), ('world'), (''), (NULL);
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS LAST');
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS LAST');
;
;
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS FIRST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS FIRST');
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS FIRST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS FIRST');
;
;
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'ASC NULLS FIRST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS LAST');
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS LAST');
;
;
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS LAST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS FIRST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS FIRST');
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS FIRST');
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM varchars ORDER BY create_sort_key(v, 'DESC NULLS FIRST');
CREATE TABLE int_list(l INT[]);;
INSERT INTO int_list VALUES ([1, 2, 3]), ([]), ([1]), ([2]), ([NULL]), (NULL);;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS LAST');
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS LAST');
;
;
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS LAST');
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS LAST');
;
;
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS LAST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS FIRST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS FIRST');
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS FIRST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS FIRST');
;
;
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'ASC NULLS FIRST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
;
;
;
SELECT l FROM int_list ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
CREATE TABLE structs(s ROW(i INT, v VARCHAR));;
INSERT INTO structs VALUES ({'i': 42, v: 'hello'}), ({'i': 42, v: 'hello' || chr(0)}), ({'i': 43, v: ''}), (NULL), ({'i': 42, v: NULL}), ({'i': NULL, v: ''});
SELECT * FROM structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
SELECT * FROM structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
;
;
SELECT * FROM structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'ASC NULLS LAST', s.v, 'ASC NULLS LAST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'ASC NULLS LAST', s.v, 'ASC NULLS LAST');
;
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'ASC NULLS LAST', s.v, 'ASC NULLS LAST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'ASC NULLS LAST', s.v, 'ASC NULLS LAST');
;
;
;
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'ASC NULLS LAST', s.v, 'ASC NULLS LAST');
SELECT * FROM structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
SELECT * FROM structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'DESC NULLS FIRST', s.v, 'DESC NULLS FIRST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'DESC NULLS FIRST', s.v, 'DESC NULLS FIRST');
;
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'DESC NULLS FIRST', s.v, 'DESC NULLS FIRST');
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'DESC NULLS FIRST', s.v, 'DESC NULLS FIRST');
;
;
;
SELECT s.i, s.v FROM structs ORDER BY create_sort_key(s.i, 'DESC NULLS FIRST', s.v, 'DESC NULLS FIRST');
CREATE TABLE list_of_structs(s ROW(i INT, v VARCHAR)[]);;
INSERT INTO list_of_structs VALUES
([{'i': 42, v: 'hello'}]),
([]),
([{'i': 42, v: 'hello'}, {'i': 84, v: ''}]),
([{'i': 43, v: ''}]),
(NULL),
([NULL]),
([{'i': 42, v: NULL}]),
([{'i': NULL, v: ''}]),
([{'i': 42, v: 'hello'}, {'i': 84, v: chr(0)}]),
([{'i': 42, v: 'hello'}, NULL, {'i': 84, v: ''}]);
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
;
;
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM list_of_structs ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
CREATE TABLE nested_lists(s INT[][]);;
INSERT INTO nested_lists VALUES
([]),
([[], []]),
(NULL),
([NULL]),
([[NULL]]),
([[42, 84]]),
([[42], [84]]),
([[42], NULL, [84]]),
([[42], [NULL], [84]]),
([[1, 2, 3, 4, 5, 6, 7, 8, 9]]);
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'ASC NULLS LAST');
;
;
;
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'ASC NULLS LAST');
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM nested_lists ORDER BY create_sort_key(s, 'DESC NULLS FIRST');
CREATE TABLE blobs(b BLOB, c BLOB);;
INSERT INTO blobs VALUES (NULL, NULL), ('hello\x00\x00\x00\x00\x00', NULL), ('hello', 'world'), ('hello\x01\x01\x01', 'world'), ('', ''), ('hello\x00\x00\x00\x00\x00', 'world'), ('hello\x00', NULL);
SELECT b FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST');
SELECT b FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST');
;
SELECT b FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST');
SELECT b FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST');
;
;
;
SELECT b FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST');
SELECT b FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST');
SELECT b FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST');
;
SELECT b FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST');
SELECT b FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST');
;
;
;
SELECT b FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST', c, 'ASC NULLS LAST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST', c, 'ASC NULLS LAST');
;
SELECT * FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST', c, 'ASC NULLS LAST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST', c, 'ASC NULLS LAST');
;
;
;
SELECT * FROM blobs ORDER BY create_sort_key(b, 'ASC NULLS LAST', c, 'ASC NULLS LAST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST', c, 'DESC NULLS FIRST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST', c, 'DESC NULLS FIRST');
;
SELECT * FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST', c, 'DESC NULLS FIRST');
SELECT * FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST', c, 'DESC NULLS FIRST');
;
;
;
SELECT * FROM blobs ORDER BY create_sort_key(b, 'DESC NULLS FIRST', c, 'DESC NULLS FIRST');
CREATE TABLE arrays(l INT[3]);;
INSERT INTO arrays VALUES ([1, 2, 3]), (NULL), ([NULL, NULL, NULL]), ([1, NULL, 3]), ([2, 3, 4]);;
SELECT l FROM arrays ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM arrays ORDER BY create_sort_key(l, 'ASC NULLS LAST');
;
SELECT l FROM arrays ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM arrays ORDER BY create_sort_key(l, 'ASC NULLS LAST');
;
;
;
SELECT l FROM arrays ORDER BY create_sort_key(l, 'ASC NULLS LAST');
SELECT l FROM arrays ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
SELECT l FROM arrays ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
;
SELECT l FROM arrays ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
SELECT l FROM arrays ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
;
;
;
SELECT l FROM arrays ORDER BY create_sort_key(l, 'DESC NULLS FIRST');
