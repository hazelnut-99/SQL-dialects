select i, j, replace(filename, '\', '/') from parquet_scan('data/parquet-testing/glob*/t?.parquet', FILENAME=1) order by i;;
select i, j, replace(filename, '\', '/') as file from parquet_scan('data/parquet-testing/glob*/t?.parquet', FILENAME=1) where file='data/parquet-testing/glob2/t1.parquet';;
SELECT count(filename) FROM parquet_scan('data/parquet-testing/p2.parquet', FILENAME=1) where id < 1000;;
SELECT count(id) FROM parquet_scan('data/parquet-testing/p2.parquet', FILENAME=1) where filename >= 'data';;
select replace(filename, '\', '/') from parquet_scan('data/parquet-testing/glob*/t?.parquet', FILENAME=1) where i=2;;
CREATE TABLE test_csv AS SELECT 1 as id, 'test_csv_content' as filename;;
COPY test_csv TO 'duckdb_unittest_tempdir/54776/filename_as_column.csv' WITH HEADER;;
SELECT id, filename FROM read_csv_auto('duckdb_unittest_tempdir/54776/filename_as_column.csv',  FILENAME=1);;
CREATE TABLE test AS SELECT 1 as id, 'test' as filename;;
COPY test TO 'duckdb_unittest_tempdir/54776/filename_as_column.parquet';;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54776/filename_as_column.parquet', FILENAME=1);;
CREATE TABLE test_copy (i INT, j VARCHAR, filename VARCHAR);;
INSERT INTO test_copy FROM read_parquet('data/parquet-testing/glob/t1.parquet', filename=1, binary_as_string=1);;
SELECT i, j, replace(filename, '\', '/') FROM test_copy;
INSERT INTO test_copy FROM read_parquet('data/parquet-testing/glob/t1.parquet', filename=1);;
SELECT i, j, replace(filename, '\', '/') FROM test_copy;
COPY test_copy FROM 'data/parquet-testing/glob/t1.parquet';;
CREATE TABLE test_table_large AS SELECT * FROM range(0,10000) tbl(i);;
COPY test_table_large TO 'duckdb_unittest_tempdir/54776/test_table_large.parquet' (ROW_GROUP_SIZE 1000);;
SELECT sum(i), max(regexp_replace(filename, '^.*/', '')) FROM parquet_scan('duckdb_unittest_tempdir/54776/test_table_large.parquet', FILENAME=1) where i>5000;;
SELECT i, j, replace(filename, '\', '/') as file FROM parquet_scan(['data/parquet-testing/glob/t1.parquet', 'data/parquet-testing/glob/t1.parquet', 'data/parquet-testing/glob/t2.parquet'], FILENAME=1) where file like '%t1%';
