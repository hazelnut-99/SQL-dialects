pragma enable_verification;
create table tt (x int, y int, z int);;
insert into tt select nullif(r % 3, 0), nullif (r % 5, 0), r from range(10) tbl(r);;
select * 
from tt t1 left join tt t2 
on t1.x < t2.x and t1.y < t2.y 
order by t1.x nulls first, t1.y nulls first, t1.z, t2.x, t2.y, t2.z;;
select * 
from tt t1 left join tt t2 
on t1.x < t2.x and t1.y < t2.y 
order by t1.x nulls first, t1.y nulls first, t1.z, t2.x, t2.y, t2.z;;
;
select * 
from tt t1 left join tt t2 
on t1.x < t2.x and t1.y < t2.y 
order by t1.x nulls first, t1.y nulls first, t1.z, t2.x, t2.y, t2.z;;
SELECT * FROM tt AS t1 LEFT JOIN tt AS t2 ON (((t1.x < t2.x) AND (t1.y < t2.y))) ORDER BY t1.x NULLS FIRST, t1.y NULLS FIRST, t1.z, t2.x, t2.y, t2.z;
;
;
;
;
select * 
from tt t1 left join tt t2 
on t1.x < t2.x and t1.y < t2.y 
order by t1.x nulls first, t1.y nulls first, t1.z, t2.x, t2.y, t2.z;;
pragma disable_optimizer;;
create table tt2 (x int);;
insert into tt2 select * from range(10);;
select t1.x, t1.y
from (
    select (case when x < 100 then null else 99 end) x, (case when x < 100 then 99 else 99 end) y
    from tt2
) t1 left join tt2 t2
on t1.x < t2.x and t1.y < t2.x
order by t1.x nulls first, t1.y nulls first;;
select t1.x, t1.y
from (
    select (case when x < 100 then null else 99 end) x, (case when x < 100 then 99 else 99 end) y
    from tt2
) t1 left join tt2 t2
on t1.x < t2.x and t1.y < t2.x
order by t1.x nulls first, t1.y nulls first;;
;
select t1.x, t1.y
from (
    select (case when x < 100 then null else 99 end) x, (case when x < 100 then 99 else 99 end) y
    from tt2
) t1 left join tt2 t2
on t1.x < t2.x and t1.y < t2.x
order by t1.x nulls first, t1.y nulls first;;
SELECT t1.x, t1.y FROM (SELECT CASE  WHEN ((x < 100)) THEN (NULL) ELSE 99 END AS x, CASE  WHEN ((x < 100)) THEN (99) ELSE 99 END AS y FROM tt2) AS t1 LEFT JOIN tt2 AS t2 ON (((t1.x < t2.x) AND (t1.y < t2.x))) ORDER BY t1.x NULLS FIRST, t1.y NULLS FIRST;
;
;
;
;
select t1.x, t1.y
from (
    select (case when x < 100 then null else 99 end) x, (case when x < 100 then 99 else 99 end) y
    from tt2
) t1 left join tt2 t2
on t1.x < t2.x and t1.y < t2.x
order by t1.x nulls first, t1.y nulls first;;
