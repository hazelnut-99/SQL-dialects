PRAGMA enable_verification;
PRAGMA add_parquet_key('my_cool_key', '42');
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/encrypted.parquet' (ENCRYPTION_CONFIG {column_keys: {key_name: ['col0', 'col1']}});
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/encrypted.parquet' (ENCRYPTION_CONFIG {footer_key: 'nonexistant'});
PRAGMA add_parquet_key('key128', '0123456789112345');
PRAGMA add_parquet_key('key192', '012345678911234501234567');
PRAGMA add_parquet_key('key256', '01234567891123450123456789112345');
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/encrypted128.parquet' (ENCRYPTION_CONFIG {footer_key: 'key128'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key128'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key128'});
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key128'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', (encryption_config = main.struct_pack(footer_key := 'key128')));
;
;
;
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key128'});
CREATE OR REPLACE TABLE test (i INTEGER);
COPY test FROM 'duckdb_unittest_tempdir/54756/encrypted128.parquet' (ENCRYPTION_CONFIG {footer_key: 'key128'});
SELECT * FROM test;
SELECT * FROM test;
;
SELECT * FROM test;
SELECT * FROM test;
;
;
;
;
SELECT * FROM test;
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/encrypted192.parquet' (ENCRYPTION_CONFIG {footer_key: 'key192'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted192.parquet', encryption_config={footer_key: 'key192'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted192.parquet', encryption_config={footer_key: 'key192'});
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted192.parquet', encryption_config={footer_key: 'key192'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted192.parquet', (encryption_config = main.struct_pack(footer_key := 'key192')));
;
;
;
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted192.parquet', encryption_config={footer_key: 'key192'});
CREATE OR REPLACE TABLE test (i INTEGER);
COPY test FROM 'duckdb_unittest_tempdir/54756/encrypted192.parquet' (ENCRYPTION_CONFIG {footer_key: 'key192'});
SELECT * FROM test;
SELECT * FROM test;
;
SELECT * FROM test;
SELECT * FROM test;
;
;
;
;
SELECT * FROM test;
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/encrypted256.parquet' (ENCRYPTION_CONFIG {footer_key: 'key256'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted256.parquet', encryption_config={footer_key: 'key256'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted256.parquet', encryption_config={footer_key: 'key256'});
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted256.parquet', encryption_config={footer_key: 'key256'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted256.parquet', (encryption_config = main.struct_pack(footer_key := 'key256')));
;
;
;
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted256.parquet', encryption_config={footer_key: 'key256'});
CREATE OR REPLACE TABLE test (i INTEGER);
COPY test FROM 'duckdb_unittest_tempdir/54756/encrypted256.parquet' (ENCRYPTION_CONFIG {footer_key: 'key256'});
SELECT * FROM test;
SELECT * FROM test;
;
SELECT * FROM test;
SELECT * FROM test;
;
;
;
;
SELECT * FROM test;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet');
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet');
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet');
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet');
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key192'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key192'});
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key192'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/encrypted128.parquet', encryption_config={footer_key: 'key192'});
COPY (SELECT 42 i) to 'duckdb_unittest_tempdir/54756/unencrypted.parquet';
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/unencrypted.parquet', encryption_config={footer_key: 'key256'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/unencrypted.parquet', encryption_config={footer_key: 'key256'});
;
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/unencrypted.parquet', encryption_config={footer_key: 'key256'});
SELECT * FROM read_parquet('duckdb_unittest_tempdir/54756/unencrypted.parquet', encryption_config={footer_key: 'key256'});
