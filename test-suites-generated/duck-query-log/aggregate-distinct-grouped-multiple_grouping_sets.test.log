SET default_null_order='nulls_first';;
pragma enable_verification;
pragma verify_parallelism;
create table students (
	course VARCHAR,
	type VARCHAR,
	value BIGINT
);;
insert into students
		(course, type, value)
	values
		('CS', 'Bachelor', 20),
		('CS', 'Bachelor', 10),
		('CS', 'PhD', -20),
		('Math', 'Masters', 10),
		('CS', NULL, -15),
		('CS', NULL, 10),
		('Math', NULL, 15);;
select course, type, count(*), sum(distinct value) from students group by course, type order by all;;
select course, type, count(*), sum(distinct value) from students group by course, type order by all;;
;
select course, type, count(*), sum(distinct value) from students group by course, type order by all;;
SELECT course, "type", count_star(), sum(DISTINCT "value") FROM students GROUP BY course, "type" ORDER BY COLUMNS(*);
;
;
;
;
select course, type, count(*), sum(distinct value) from students group by course, type order by all;;
select course, type, count(*), sum(distinct value) from students group by (course, type) order by all;;
select course, type, count(*), sum(distinct value) from students group by (course, type) order by all;;
;
select course, type, count(*), sum(distinct value) from students group by (course, type) order by all;;
SELECT course, "type", count_star(), sum(DISTINCT "value") FROM students GROUP BY course, "type" ORDER BY COLUMNS(*);
;
;
;
;
select course, type, count(*), sum(distinct value) from students group by (course, type) order by all;;
select course, count(*), sum(distinct value) from students group by (), course, () order by all;;
select course, count(*), sum(distinct value) from students group by (), course, () order by all;;
;
select course, count(*), sum(distinct value) from students group by (), course, () order by all;;
SELECT course, count_star(), sum(DISTINCT "value") FROM students GROUP BY course ORDER BY COLUMNS(*);
;
;
;
;
select course, count(*), sum(distinct value) from students group by (), course, () order by all;;
select count(*), course, type, sum(distinct value)
	from students
	group by grouping sets ((course), (type))
	order by all;;
select count(*), course, type, sum(distinct value)
	from students
	group by grouping sets ((course), (type))
	order by all;;
;
select count(*), course, type, sum(distinct value)
	from students
	group by grouping sets ((course), (type))
	order by all;;
SELECT count_star(), course, "type", sum(DISTINCT "value") FROM students GROUP BY GROUPING SETS ((course),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), course, type, sum(distinct value)
	from students
	group by grouping sets ((course), (type))
	order by all;;
select sum(distinct value), count(*), course, avg(distinct value), type
	from students
	group by grouping sets (course), grouping sets(type)
	order by all;;
select sum(distinct value), count(*), course, avg(distinct value), type
	from students
	group by grouping sets (course), grouping sets(type)
	order by all;;
;
select sum(distinct value), count(*), course, avg(distinct value), type
	from students
	group by grouping sets (course), grouping sets(type)
	order by all;;
SELECT sum(DISTINCT "value"), count_star(), course, avg(DISTINCT "value"), "type" FROM students GROUP BY course, "type" ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value), count(*), course, avg(distinct value), type
	from students
	group by grouping sets (course), grouping sets(type)
	order by all;;
select sum(distinct value), count(*), count(distinct value), course, type
	from students
	group by course, grouping sets(type)
	order by all;;
select sum(distinct value), count(*), count(distinct value), course, type
	from students
	group by course, grouping sets(type)
	order by all;;
;
select sum(distinct value), count(*), count(distinct value), course, type
	from students
	group by course, grouping sets(type)
	order by all;;
SELECT sum(DISTINCT "value"), count_star(), count(DISTINCT "value"), course, "type" FROM students GROUP BY course, "type" ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value), count(*), count(distinct value), course, type
	from students
	group by course, grouping sets(type)
	order by all;;
select count(*), ARG_MIN(distinct value%5, value), course, sum(distinct value), type
	from students
	group by course, grouping sets(type, ())
	order by all;;
select count(*), ARG_MIN(distinct value%5, value), course, sum(distinct value), type
	from students
	group by course, grouping sets(type, ())
	order by all;;
;
select count(*), ARG_MIN(distinct value%5, value), course, sum(distinct value), type
	from students
	group by course, grouping sets(type, ())
	order by all;;
SELECT count_star(), arg_min(DISTINCT ("value" % 5), "value"), course, sum(DISTINCT "value"), "type" FROM students GROUP BY GROUPING SETS ((course, "type"),(course)) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), ARG_MIN(distinct value%5, value), course, sum(distinct value), type
	from students
	group by course, grouping sets(type, ())
	order by all;;
select sum(distinct value), count(*), course, type
	from students
	group by grouping sets((course, type), (course))
	order by all;;
select sum(distinct value), count(*), course, type
	from students
	group by grouping sets((course, type), (course))
	order by all;;
;
select sum(distinct value), count(*), course, type
	from students
	group by grouping sets((course, type), (course))
	order by all;;
SELECT sum(DISTINCT "value"), count_star(), course, "type" FROM students GROUP BY GROUPING SETS ((course, "type"),(course)) ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value), count(*), course, type
	from students
	group by grouping sets((course, type), (course))
	order by all;;
select count(*), count(distinct value), count(value), course, sum(distinct value), type
	from students
	group by grouping sets (grouping sets(course), grouping sets(type))
	order by all;;
select count(*), count(distinct value), count(value), course, sum(distinct value), type
	from students
	group by grouping sets (grouping sets(course), grouping sets(type))
	order by all;;
;
select count(*), count(distinct value), count(value), course, sum(distinct value), type
	from students
	group by grouping sets (grouping sets(course), grouping sets(type))
	order by all;;
SELECT count_star(), count(DISTINCT "value"), count("value"), course, sum(DISTINCT "value"), "type" FROM students GROUP BY GROUPING SETS ((course),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), count(distinct value), count(value), course, sum(distinct value), type
	from students
	group by grouping sets (grouping sets(course), grouping sets(type))
	order by all;;
select count(*), avg(distinct value) FILTER (where value < 5), avg(distinct value), course, avg(value), type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type))
        order by all;;
select count(*), avg(distinct value) FILTER (where value < 5), avg(distinct value), course, avg(value), type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type))
        order by all;;
;
select count(*), avg(distinct value) FILTER (where value < 5), avg(distinct value), course, avg(value), type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type))
        order by all;;
SELECT count_star(), avg(DISTINCT "value") FILTER (WHERE ("value" < 5)), avg(DISTINCT "value"), course, avg("value"), "type" FROM students GROUP BY GROUPING SETS ((course),(),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), avg(distinct value) FILTER (where value < 5), avg(distinct value), course, avg(value), type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type))
        order by all;;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets ((course), (), (type))
        order by all;;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets ((course), (), (type))
        order by all;;
;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets ((course), (), (type))
        order by all;;
SELECT count_star(), sum(DISTINCT "value"), course, "type" FROM students GROUP BY GROUPING SETS ((course),(),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets ((course), (), (type))
        order by all;;
select count(*), count(distinct value), sum(distinct value), course, type
        from students
        group by grouping sets(course, ()), grouping sets(type)
        order by all;;
select count(*), count(distinct value), sum(distinct value), course, type
        from students
        group by grouping sets(course, ()), grouping sets(type)
        order by all;;
;
select count(*), count(distinct value), sum(distinct value), course, type
        from students
        group by grouping sets(course, ()), grouping sets(type)
        order by all;;
SELECT count_star(), count(DISTINCT "value"), sum(DISTINCT "value"), course, "type" FROM students GROUP BY GROUPING SETS ((course, "type"),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), count(distinct value), sum(distinct value), course, type
        from students
        group by grouping sets(course, ()), grouping sets(type)
        order by all;;
select sum(distinct value), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets(course, ()), type
        order by all;;
select sum(distinct value), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets(course, ()), type
        order by all;;
;
select sum(distinct value), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets(course, ()), type
        order by all;;
SELECT sum(DISTINCT "value"), count_star(), course, "type", sum(DISTINCT "value") FROM students GROUP BY GROUPING SETS ((course, "type"),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets(course, ()), type
        order by all;;
select sum(distinct value) FILTER (where value % 10 != 0), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets((course, type), (type))
        order by all;;
select sum(distinct value) FILTER (where value % 10 != 0), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets((course, type), (type))
        order by all;;
;
select sum(distinct value) FILTER (where value % 10 != 0), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets((course, type), (type))
        order by all;;
SELECT sum(DISTINCT "value") FILTER (WHERE (("value" % 10) != 0)), count_star(), course, "type", sum(DISTINCT "value") FROM students GROUP BY GROUPING SETS ((course, "type"),("type")) ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value) FILTER (where value % 10 != 0), count(*), course, type, sum(distinct value)
        from students
        group by grouping sets((course, type), (type))
        order by all;;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets((3, 4), (4))
        order by all;;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets((3, 4), (4))
        order by all;;
;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets((3, 4), (4))
        order by all;;
SELECT count_star(), sum(DISTINCT "value"), course, "type" FROM students GROUP BY GROUPING SETS ((3, 4),(4)) ORDER BY COLUMNS(*);
;
;
;
select count(*), sum(distinct value), course, type
        from students
        group by grouping sets((3, 4), (4))
        order by all;;
select count(*), course AS crs, sum(distinct value), type AS tp
        from students
        group by grouping sets((crs, tp), (tp))
        order by all;;
select count(*), course AS crs, sum(distinct value), type AS tp
        from students
        group by grouping sets((crs, tp), (tp))
        order by all;;
;
select count(*), course AS crs, sum(distinct value), type AS tp
        from students
        group by grouping sets((crs, tp), (tp))
        order by all;;
SELECT count_star(), course AS crs, sum(DISTINCT "value"), "type" AS tp FROM students GROUP BY GROUPING SETS ((crs, tp),(tp)) ORDER BY COLUMNS(*);
;
;
;
;
select count(*), course AS crs, sum(distinct value), type AS tp
        from students
        group by grouping sets((crs, tp), (tp))
        order by all;;
select sum(distinct value), count(*), course, type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type, ()))
        order by all;;
select sum(distinct value), count(*), course, type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type, ()))
        order by all;;
;
select sum(distinct value), count(*), course, type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type, ()))
        order by all;;
SELECT sum(DISTINCT "value"), count_star(), course, "type" FROM students GROUP BY GROUPING SETS ((course),(),("type"),()) ORDER BY COLUMNS(*);
;
;
;
;
select sum(distinct value), count(*), course, type
        from students
        group by grouping sets (grouping sets(course, ()), grouping sets(type, ()))
        order by all;;
