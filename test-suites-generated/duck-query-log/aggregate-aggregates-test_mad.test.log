PRAGMA enable_verification;
SELECT mad(NULL), mad(1);
SELECT mad(NULL), mad(1);
;
SELECT mad(NULL), mad(1);
SELECT mad(NULL), mad(1);
;
;
;
;
SELECT mad(NULL), mad(1);
SELECT mad(NULL), mad(1) FROM range(2000);
SELECT mad(NULL), mad(1) FROM range(2000);
;
SELECT mad(NULL), mad(1) FROM range(2000);
SELECT mad(NULL), mad(1) FROM range(2000);
;
;
;
;
SELECT mad(NULL), mad(1) FROM range(2000);
create table tinys as
	select range r, random()
	from range(100)
	union all values (NULL, 0.1), (NULL, 0.5), (NULL, 0.9)
	order by 2;;
SELECT mad(r::tinyint) FROM tinys;
SELECT mad(r::tinyint) FROM tinys;
;
SELECT mad(r::tinyint) FROM tinys;
SELECT mad(CAST(r AS TINYINT)) FROM tinys;
;
;
;
;
SELECT mad(r::tinyint) FROM tinys;
SELECT mad(NULL::tinyint) FROM tinys;
SELECT mad(NULL::tinyint) FROM tinys;
;
SELECT mad(NULL::tinyint) FROM tinys;
SELECT mad(CAST(NULL AS TINYINT)) FROM tinys;
;
;
;
;
SELECT mad(NULL::tinyint) FROM tinys;
SELECT mad(42::tinyint) FROM tinys;
SELECT mad(42::tinyint) FROM tinys;
;
SELECT mad(42::tinyint) FROM tinys;
SELECT mad(CAST(42 AS TINYINT)) FROM tinys;
;
;
;
;
SELECT mad(42::tinyint) FROM tinys;
SELECT mad(r::decimal(4,1)) FROM tinys;
SELECT mad(r::decimal(4,1)) FROM tinys;
;
SELECT mad(r::decimal(4,1)) FROM tinys;
SELECT mad(CAST(r AS DECIMAL(4,1))) FROM tinys;
;
;
;
;
SELECT mad(r::decimal(4,1)) FROM tinys;
SELECT mad(NULL::decimal(4,1)) FROM tinys;
SELECT mad(NULL::decimal(4,1)) FROM tinys;
;
SELECT mad(NULL::decimal(4,1)) FROM tinys;
SELECT mad(CAST(NULL AS DECIMAL(4,1))) FROM tinys;
;
;
;
;
SELECT mad(NULL::decimal(4,1)) FROM tinys;
SELECT mad(42::decimal(4,1)) FROM tinys;
SELECT mad(42::decimal(4,1)) FROM tinys;
;
SELECT mad(42::decimal(4,1)) FROM tinys;
SELECT mad(CAST(42 AS DECIMAL(4,1))) FROM tinys;
;
;
;
;
SELECT mad(42::decimal(4,1)) FROM tinys;
create table numerics as
	select range r, random()
	from range(10000)
	union all values (NULL, 0.1), (NULL, 0.5), (NULL, 0.9)
	order by 2;;
SELECT mad(r::smallint) FROM numerics;
SELECT mad(r::smallint) FROM numerics;
;
SELECT mad(r::smallint) FROM numerics;
SELECT mad(CAST(r AS SMALLINT)) FROM numerics;
;
;
;
;
SELECT mad(r::smallint) FROM numerics;
SELECT mad(NULL::smallint) FROM numerics;
SELECT mad(NULL::smallint) FROM numerics;
;
SELECT mad(NULL::smallint) FROM numerics;
SELECT mad(CAST(NULL AS SMALLINT)) FROM numerics;
;
;
;
;
SELECT mad(NULL::smallint) FROM numerics;
SELECT mad(42::smallint) FROM numerics;
SELECT mad(42::smallint) FROM numerics;
;
SELECT mad(42::smallint) FROM numerics;
SELECT mad(CAST(42 AS SMALLINT)) FROM numerics;
;
;
;
;
SELECT mad(42::smallint) FROM numerics;
SELECT mad(r::integer) FROM numerics;
SELECT mad(r::integer) FROM numerics;
;
SELECT mad(r::integer) FROM numerics;
SELECT mad(CAST(r AS INTEGER)) FROM numerics;
;
;
;
;
SELECT mad(r::integer) FROM numerics;
SELECT mad(NULL::integer) FROM numerics;
SELECT mad(NULL::integer) FROM numerics;
;
SELECT mad(NULL::integer) FROM numerics;
SELECT mad(CAST(NULL AS INTEGER)) FROM numerics;
;
;
;
;
SELECT mad(NULL::integer) FROM numerics;
SELECT mad(42::integer) FROM numerics;
SELECT mad(42::integer) FROM numerics;
;
SELECT mad(42::integer) FROM numerics;
SELECT mad(CAST(42 AS INTEGER)) FROM numerics;
;
;
;
;
SELECT mad(42::integer) FROM numerics;
SELECT mad(r::bigint) FROM numerics;
SELECT mad(r::bigint) FROM numerics;
;
SELECT mad(r::bigint) FROM numerics;
SELECT mad(CAST(r AS BIGINT)) FROM numerics;
;
;
;
;
SELECT mad(r::bigint) FROM numerics;
SELECT mad(NULL::bigint) FROM numerics;
SELECT mad(NULL::bigint) FROM numerics;
;
SELECT mad(NULL::bigint) FROM numerics;
SELECT mad(CAST(NULL AS BIGINT)) FROM numerics;
;
;
;
;
SELECT mad(NULL::bigint) FROM numerics;
SELECT mad(42::bigint) FROM numerics;
SELECT mad(42::bigint) FROM numerics;
;
SELECT mad(42::bigint) FROM numerics;
SELECT mad(CAST(42 AS BIGINT)) FROM numerics;
;
;
;
;
SELECT mad(42::bigint) FROM numerics;
SELECT mad(r::hugeint) FROM numerics;
SELECT mad(r::hugeint) FROM numerics;
;
SELECT mad(r::hugeint) FROM numerics;
SELECT mad(CAST(r AS HUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(r::hugeint) FROM numerics;
SELECT mad(NULL::hugeint) FROM numerics;
SELECT mad(NULL::hugeint) FROM numerics;
;
SELECT mad(NULL::hugeint) FROM numerics;
SELECT mad(CAST(NULL AS HUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(NULL::hugeint) FROM numerics;
SELECT mad(42::hugeint) FROM numerics;
SELECT mad(42::hugeint) FROM numerics;
;
SELECT mad(42::hugeint) FROM numerics;
SELECT mad(CAST(42 AS HUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(42::hugeint) FROM numerics;
SELECT mad(r::uhugeint) FROM numerics;
SELECT mad(r::uhugeint) FROM numerics;
;
SELECT mad(r::uhugeint) FROM numerics;
SELECT mad(CAST(r AS UHUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(r::uhugeint) FROM numerics;
SELECT mad(NULL::uhugeint) FROM numerics;
SELECT mad(NULL::uhugeint) FROM numerics;
;
SELECT mad(NULL::uhugeint) FROM numerics;
SELECT mad(CAST(NULL AS UHUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(NULL::uhugeint) FROM numerics;
SELECT mad(42::uhugeint) FROM numerics;
SELECT mad(42::uhugeint) FROM numerics;
;
SELECT mad(42::uhugeint) FROM numerics;
SELECT mad(CAST(42 AS UHUGEINT)) FROM numerics;
;
;
;
;
SELECT mad(42::uhugeint) FROM numerics;
SELECT mad(r::float) FROM numerics;
SELECT mad(r::float) FROM numerics;
;
SELECT mad(r::float) FROM numerics;
SELECT mad(CAST(r AS FLOAT)) FROM numerics;
;
;
;
;
SELECT mad(r::float) FROM numerics;
SELECT mad(NULL::float) FROM numerics;
SELECT mad(NULL::float) FROM numerics;
;
SELECT mad(NULL::float) FROM numerics;
SELECT mad(CAST(NULL AS FLOAT)) FROM numerics;
;
;
;
;
SELECT mad(NULL::float) FROM numerics;
SELECT mad(42::float) FROM numerics;
SELECT mad(42::float) FROM numerics;
;
SELECT mad(42::float) FROM numerics;
SELECT mad(CAST(42 AS FLOAT)) FROM numerics;
;
;
;
;
SELECT mad(42::float) FROM numerics;
SELECT mad(r::double) FROM numerics;
SELECT mad(r::double) FROM numerics;
;
SELECT mad(r::double) FROM numerics;
SELECT mad(CAST(r AS DOUBLE)) FROM numerics;
;
;
;
;
SELECT mad(r::double) FROM numerics;
SELECT mad(NULL::double) FROM numerics;
SELECT mad(NULL::double) FROM numerics;
;
SELECT mad(NULL::double) FROM numerics;
SELECT mad(CAST(NULL AS DOUBLE)) FROM numerics;
;
;
;
;
SELECT mad(NULL::double) FROM numerics;
SELECT mad(42::double) FROM numerics;
SELECT mad(42::double) FROM numerics;
;
SELECT mad(42::double) FROM numerics;
SELECT mad(CAST(42 AS DOUBLE)) FROM numerics;
;
;
;
;
SELECT mad(42::double) FROM numerics;
SELECT mad(r::decimal(8,1)) FROM numerics;
SELECT mad(r::decimal(8,1)) FROM numerics;
;
SELECT mad(r::decimal(8,1)) FROM numerics;
SELECT mad(CAST(r AS DECIMAL(8,1))) FROM numerics;
;
;
;
;
SELECT mad(r::decimal(8,1)) FROM numerics;
SELECT mad(NULL::decimal(8,1)) FROM numerics;
SELECT mad(NULL::decimal(8,1)) FROM numerics;
;
SELECT mad(NULL::decimal(8,1)) FROM numerics;
SELECT mad(CAST(NULL AS DECIMAL(8,1))) FROM numerics;
;
;
;
;
SELECT mad(NULL::decimal(8,1)) FROM numerics;
SELECT mad(42::decimal(8,1)) FROM numerics;
SELECT mad(42::decimal(8,1)) FROM numerics;
;
SELECT mad(42::decimal(8,1)) FROM numerics;
SELECT mad(CAST(42 AS DECIMAL(8,1))) FROM numerics;
;
;
;
;
SELECT mad(42::decimal(8,1)) FROM numerics;
SELECT mad(r::decimal(12,1)) FROM numerics;
SELECT mad(r::decimal(12,1)) FROM numerics;
;
SELECT mad(r::decimal(12,1)) FROM numerics;
SELECT mad(CAST(r AS DECIMAL(12,1))) FROM numerics;
;
;
;
;
SELECT mad(r::decimal(12,1)) FROM numerics;
SELECT mad(NULL::decimal(12,1)) FROM numerics;
SELECT mad(NULL::decimal(12,1)) FROM numerics;
;
SELECT mad(NULL::decimal(12,1)) FROM numerics;
SELECT mad(CAST(NULL AS DECIMAL(12,1))) FROM numerics;
;
;
;
;
SELECT mad(NULL::decimal(12,1)) FROM numerics;
SELECT mad(42::decimal(12,1)) FROM numerics;
SELECT mad(42::decimal(12,1)) FROM numerics;
;
SELECT mad(42::decimal(12,1)) FROM numerics;
SELECT mad(CAST(42 AS DECIMAL(12,1))) FROM numerics;
;
;
;
;
SELECT mad(42::decimal(12,1)) FROM numerics;
SELECT mad(r::decimal(18,1)) FROM numerics;
SELECT mad(r::decimal(18,1)) FROM numerics;
;
SELECT mad(r::decimal(18,1)) FROM numerics;
SELECT mad(CAST(r AS DECIMAL(18,1))) FROM numerics;
;
;
;
;
SELECT mad(r::decimal(18,1)) FROM numerics;
SELECT mad(NULL::decimal(18,1)) FROM numerics;
SELECT mad(NULL::decimal(18,1)) FROM numerics;
;
SELECT mad(NULL::decimal(18,1)) FROM numerics;
SELECT mad(CAST(NULL AS DECIMAL(18,1))) FROM numerics;
;
;
;
;
SELECT mad(NULL::decimal(18,1)) FROM numerics;
SELECT mad(42::decimal(18,1)) FROM numerics;
SELECT mad(42::decimal(18,1)) FROM numerics;
;
SELECT mad(42::decimal(18,1)) FROM numerics;
SELECT mad(CAST(42 AS DECIMAL(18,1))) FROM numerics;
;
;
;
;
SELECT mad(42::decimal(18,1)) FROM numerics;
SELECT mad(r::decimal(24,1)) FROM numerics;
SELECT mad(r::decimal(24,1)) FROM numerics;
;
SELECT mad(r::decimal(24,1)) FROM numerics;
SELECT mad(CAST(r AS DECIMAL(24,1))) FROM numerics;
;
;
;
;
SELECT mad(r::decimal(24,1)) FROM numerics;
SELECT mad(NULL::decimal(24,1)) FROM numerics;
SELECT mad(NULL::decimal(24,1)) FROM numerics;
;
SELECT mad(NULL::decimal(24,1)) FROM numerics;
SELECT mad(CAST(NULL AS DECIMAL(24,1))) FROM numerics;
;
;
;
;
SELECT mad(NULL::decimal(24,1)) FROM numerics;
SELECT mad(42::decimal(24,1)) FROM numerics;
SELECT mad(42::decimal(24,1)) FROM numerics;
;
SELECT mad(42::decimal(24,1)) FROM numerics;
SELECT mad(CAST(42 AS DECIMAL(24,1))) FROM numerics;
;
;
;
;
SELECT mad(42::decimal(24,1)) FROM numerics;
SELECT mad(('2018-01-01'::DATE + INTERVAL (r) DAY)::DATE) FROM numerics;
SELECT mad(('2018-01-01'::DATE + INTERVAL (r) DAY)::DATE) FROM numerics;
;
SELECT mad(('2018-01-01'::DATE + INTERVAL (r) DAY)::DATE) FROM numerics;
SELECT mad(CAST((CAST('2018-01-01' AS DATE) + to_days(CAST(trunc(CAST(r AS DOUBLE)) AS INTEGER))) AS DATE)) FROM numerics;
;
;
;
;
SELECT mad(('2018-01-01'::DATE + INTERVAL (r) DAY)::DATE) FROM numerics;
SELECT mad('2018-01-01'::TIMESTAMP + INTERVAL (r) HOUR) FROM numerics;
SELECT mad('2018-01-01'::TIMESTAMP + INTERVAL (r) HOUR) FROM numerics;
;
SELECT mad('2018-01-01'::TIMESTAMP + INTERVAL (r) HOUR) FROM numerics;
SELECT mad((CAST('2018-01-01' AS TIMESTAMP) + to_hours(CAST(trunc(CAST(r AS DOUBLE)) AS BIGINT)))) FROM numerics;
;
;
;
;
SELECT mad('2018-01-01'::TIMESTAMP + INTERVAL (r) HOUR) FROM numerics;
SELECT mad('00:00:00'::TIME + INTERVAL (r) SECOND) FROM numerics;
SELECT mad('00:00:00'::TIME + INTERVAL (r) SECOND) FROM numerics;
;
SELECT mad('00:00:00'::TIME + INTERVAL (r) SECOND) FROM numerics;
SELECT mad((CAST('00:00:00' AS TIME) + to_seconds(CAST(r AS DOUBLE)))) FROM numerics;
;
;
;
;
SELECT mad('00:00:00'::TIME + INTERVAL (r) SECOND) FROM numerics;
select mad(x) from (values ('127'::DECIMAL(3,0)), ('-128'::DECIMAL(3,0))) tbl(x);;
select mad(x) from (values ('127'::DECIMAL(3,0)), ('-128'::DECIMAL(3,0))) tbl(x);;
;
select mad(x) from (values ('127'::DECIMAL(3,0)), ('-128'::DECIMAL(3,0))) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('127' AS DECIMAL(3,0))), (CAST('-128' AS DECIMAL(3,0)))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values ('127'::DECIMAL(3,0)), ('-128'::DECIMAL(3,0))) tbl(x);;
select mad(x) from (values ('32767'::DECIMAL(5,0)), ('-32768'::DECIMAL(5,0))) tbl(x);;
select mad(x) from (values ('32767'::DECIMAL(5,0)), ('-32768'::DECIMAL(5,0))) tbl(x);;
;
select mad(x) from (values ('32767'::DECIMAL(5,0)), ('-32768'::DECIMAL(5,0))) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('32767' AS DECIMAL(5,0))), (CAST('-32768' AS DECIMAL(5,0)))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values ('32767'::DECIMAL(5,0)), ('-32768'::DECIMAL(5,0))) tbl(x);;
select mad(x) from (values ('2147483647'::DECIMAL(10,0)), ('-2147483648'::DECIMAL(10,0))) tbl(x);;
select mad(x) from (values ('2147483647'::DECIMAL(10,0)), ('-2147483648'::DECIMAL(10,0))) tbl(x);;
;
select mad(x) from (values ('2147483647'::DECIMAL(10,0)), ('-2147483648'::DECIMAL(10,0))) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('2147483647' AS DECIMAL(10,0))), (CAST('-2147483648' AS DECIMAL(10,0)))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values ('2147483647'::DECIMAL(10,0)), ('-2147483648'::DECIMAL(10,0))) tbl(x);;
select mad(x) from (values (-1e308), (1e308)) tbl(x);;
select mad(x) from (values (-1e308), (1e308)) tbl(x);;
;
select mad(x) from (values (-1e308), (1e308)) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (-1e+308), (1e+308)) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values (-1e308), (1e308)) tbl(x);;
select mad(x) from (values ('294247-01-10'::date), ('290309-12-22 (BC)'::date)) tbl(x);;
select mad(x) from (values ('294247-01-10'::date), ('290309-12-22 (BC)'::date)) tbl(x);;
;
select mad(x) from (values ('294247-01-10'::date), ('290309-12-22 (BC)'::date)) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('294247-01-10' AS DATE)), (CAST('290309-12-22 (BC)' AS DATE))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values ('294247-01-10'::date), ('290309-12-22 (BC)'::date)) tbl(x);;
select mad(x) from (values
	('294247-01-10 04:00:54.775806'::timestamp),
	('290309-12-22 (BC) 00:00:00'::timestamp)
	) tbl(x);;
select mad(x) from (values
	('294247-01-10 04:00:54.775806'::timestamp),
	('290309-12-22 (BC) 00:00:00'::timestamp)
	) tbl(x);;
;
select mad(x) from (values
	('294247-01-10 04:00:54.775806'::timestamp),
	('290309-12-22 (BC) 00:00:00'::timestamp)
	) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('294247-01-10 04:00:54.775806' AS TIMESTAMP)), (CAST('290309-12-22 (BC) 00:00:00' AS TIMESTAMP))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values
	('294247-01-10 04:00:54.775806'::timestamp),
	('290309-12-22 (BC) 00:00:00'::timestamp)
	) tbl(x);;
select mad(x) from (values ('23:59:59.999999'::time), ('00:00:00'::time)) tbl(x);;
select mad(x) from (values ('23:59:59.999999'::time), ('00:00:00'::time)) tbl(x);;
;
select mad(x) from (values ('23:59:59.999999'::time), ('00:00:00'::time)) tbl(x);;
SELECT mad(x) FROM (SELECT * FROM (VALUES (CAST('23:59:59.999999' AS TIME)), (CAST('00:00:00' AS TIME))) AS valueslist) AS tbl(x);
;
;
;
;
select mad(x) from (values ('23:59:59.999999'::time), ('00:00:00'::time)) tbl(x);;
