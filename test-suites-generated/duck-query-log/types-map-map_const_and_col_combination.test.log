PRAGMA enable_verification;;
CREATE TABLE ints (i INT);;
INSERT INTO ints VALUES (1), (2), (3);;
SELECT MAP(['name'], [i]) FROM ints;;
SELECT MAP(['name'], [i]) FROM ints;;
;
SELECT MAP(['name'], [i]) FROM ints;;
SELECT map(main.list_value('name'), main.list_value(i)) FROM ints;
;
;
;
;
SELECT MAP(['name'], [i]) FROM ints;;
SELECT MAP(['x', 'y'], [i] ) FROM ints;;
SELECT MAP(['x', 'y'], [i] ) FROM ints;;
;
SELECT MAP(['x', 'y'], [i] ) FROM ints;;
SELECT MAP(['x', 'y'], [i] ) FROM ints;;
SELECT MAP([i], ['name'] ) FROM ints;;
SELECT MAP([i], ['name'] ) FROM ints;;
;
SELECT MAP([i], ['name'] ) FROM ints;;
SELECT map(main.list_value(i), main.list_value('name')) FROM ints;
;
;
;
;
SELECT MAP([i], ['name'] ) FROM ints;;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints;;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints;;
;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints;;
SELECT map(main.list_value(i, (i + 1)), main.list_value('x', 'y')) FROM ints;
;
;
;
;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints;;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints WHERE i > 1;;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints WHERE i > 1;;
;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints WHERE i > 1;;
SELECT map(main.list_value(i, (i + 1)), main.list_value('x', 'y')) FROM ints WHERE (i > 1);
;
;
;
;
SELECT MAP([i, i+1], ['x', 'y']) FROM ints WHERE i > 1;;
SELECT MAP(['x'], [m]) FROM (SELECT MAP([i], ['y']) m FROM ints WHERE i <> 1);;
SELECT MAP(['x'], [m]) FROM (SELECT MAP([i], ['y']) m FROM ints WHERE i <> 1);;
;
SELECT MAP(['x'], [m]) FROM (SELECT MAP([i], ['y']) m FROM ints WHERE i <> 1);;
SELECT map(main.list_value('x'), main.list_value(m)) FROM (SELECT map(main.list_value(i), main.list_value('y')) AS m FROM ints WHERE (i != 1));
;
;
;
;
SELECT MAP(['x'], [m]) FROM (SELECT MAP([i], ['y']) m FROM ints WHERE i <> 1);;
SELECT MAP(['key'], [range]) FROM range(5) WHERE range > 2;;
SELECT MAP(['key'], [range]) FROM range(5) WHERE range > 2;;
;
SELECT MAP(['key'], [range]) FROM range(5) WHERE range > 2;;
SELECT map(main.list_value('key'), main.list_value("range")) FROM range(5) WHERE ("range" > 2);
;
;
;
;
SELECT MAP(['key'], [range]) FROM range(5) WHERE range > 2;;
SELECT MAP(['ü¶Ü', 'ü¶§', 'üêì'], [i, i+1, i+2]) FROM ints;;
SELECT MAP(['ü¶Ü', 'ü¶§', 'üêì'], [i, i+1, i+2]) FROM ints;;
;
SELECT MAP(['ü¶Ü', 'ü¶§', 'üêì'], [i, i+1, i+2]) FROM ints;;
SELECT map(main.list_value('ü¶Ü', 'ü¶§', 'üêì'), main.list_value(i, (i + 1), (i + 2))) FROM ints;
;
;
;
;
SELECT MAP(['ü¶Ü', 'ü¶§', 'üêì'], [i, i+1, i+2]) FROM ints;;
SELECT MAP([10, i, i+1, 9], [i, 3.14, 0.12, 8.0]) FROM ints;;
SELECT MAP([10, i, i+1, 9], [i, 3.14, 0.12, 8.0]) FROM ints;;
;
SELECT MAP([10, i, i+1, 9], [i, 3.14, 0.12, 8.0]) FROM ints;;
SELECT map(main.list_value(10, i, (i + 1), 9), main.list_value(i, 3.14, 0.12, 8.0)) FROM ints;
;
;
;
;
SELECT MAP([10, i, i+1, 9], [i, 3.14, 0.12, 8.0]) FROM ints;;
CREATE TABLE tbl (v VARCHAR[]);;
INSERT INTO tbl VALUES (ARRAY['test', 'string']), (ARRAY['foo', 'bar']);;
SELECT MAP(['x', 'y'], v ) FROM tbl;;
SELECT MAP(['x', 'y'], v ) FROM tbl;;
;
SELECT MAP(['x', 'y'], v ) FROM tbl;;
SELECT map(main.list_value('x', 'y'), v) FROM tbl;
;
;
;
;
SELECT MAP(['x', 'y'], v ) FROM tbl;;
CREATE TABLE MAP_input (keys INT[], values INT[]);;
INSERT INTO MAP_input VALUES ([1, 0], [2]), ([3], [4, 9]);;
SELECT MAP(keys, values) FROM MAP_input;;
SELECT MAP(keys, values) FROM MAP_input;;
;
SELECT MAP(keys, values) FROM MAP_input;;
SELECT MAP(keys, values) FROM MAP_input;;
CREATE TABLE groups (category INT, score INT);;
INSERT INTO groups VALUES (1,2), (1,8), (1,3), (2,3), (2,4), (2,5), (3,6), (3,1), (3,9);
SELECT MAP(['category', 'min', 'max'], [category, MIN(score), MAX(score)]) FROM groups GROUP BY category ORDER BY ALL;;
SELECT MAP(['category', 'min', 'max'], [category, MIN(score), MAX(score)]) FROM groups GROUP BY category ORDER BY ALL;;
;
SELECT MAP(['category', 'min', 'max'], [category, MIN(score), MAX(score)]) FROM groups GROUP BY category ORDER BY ALL;;
SELECT map(main.list_value('category', 'min', 'max'), main.list_value(category, min(score), max(score))) FROM "groups" GROUP BY category ORDER BY COLUMNS(*);
;
;
;
;
SELECT MAP(['category', 'min', 'max'], [category, MIN(score), MAX(score)]) FROM groups GROUP BY category ORDER BY ALL;;
SELECT MAP([range], ['a']) FROM range(10000) WHERE range = 9999;;
SELECT MAP([range], ['a']) FROM range(10000) WHERE range = 9999;;
;
SELECT MAP([range], ['a']) FROM range(10000) WHERE range = 9999;;
SELECT map(main.list_value("range"), main.list_value('a')) FROM range(10000) WHERE ("range" = 9999);
;
;
;
;
SELECT MAP([range], ['a']) FROM range(10000) WHERE range = 9999;;
CREATE TABLE align_tbl (i INT[]);;
INSERT INTO align_tbl VALUES ([1, 2]), ([100, 200]);;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
SELECT map(main.list_value('x', 'y'), i) FROM align_tbl;
;
;
;
;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
INSERT INTO align_tbl VALUES ([1, 2, 3, 4, 5, 6]), ([20, 30, 40, 50]);;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
SELECT MAP(['x', 'y'], i) FROM align_tbl;;
SELECT MAP(['x', 'y', '1', '2', '3', '4'], i) FROM align_tbl;;
SELECT MAP(['x', 'y', '1', '2', '3', '4'], i) FROM align_tbl;;
;
SELECT MAP(['x', 'y', '1', '2', '3', '4'], i) FROM align_tbl;;
SELECT MAP(['x', 'y', '1', '2', '3', '4'], i) FROM align_tbl;;
SELECT MAP(i, ['x', 'y']) FROM align_tbl;;
SELECT MAP(i, ['x', 'y']) FROM align_tbl;;
;
SELECT MAP(i, ['x', 'y']) FROM align_tbl;;
SELECT MAP(i, ['x', 'y']) FROM align_tbl;;
CREATE TABLE allconst (i INT);;
INSERT INTO allconst VALUES (1), (2), (3);;
SELECT MAP(['name'], [2]) FROM allconst;;
SELECT MAP(['name'], [2]) FROM allconst;;
;
SELECT MAP(['name'], [2]) FROM allconst;;
SELECT map(main.list_value('name'), main.list_value(2)) FROM allconst;
;
;
;
;
SELECT MAP(['name'], [2]) FROM allconst;;
