SET default_null_order='nulls_first';;
PRAGMA enable_verification;
select (select MIN(val) from unnest((select a)) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select (select MIN(val) from unnest((select a)) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
;
select (select MIN(val) from unnest((select a)) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
SELECT (SELECT min(val) FROM unnest((SELECT a)) AS t(val)) FROM (SELECT (ARRAY[1, 2, 3, NULL])) AS t(a);
;
;
;
;
select (select MIN(val) from unnest((select a)) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
SELECT (SELECT min(val) FROM unnest(a) AS t(val)) FROM (SELECT (ARRAY[1, 2, 3, NULL])) AS t(a);
;
;
;
;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select * from (select 42) t(a), (select t.a + 1);;
select * from (select 42) t(a), (select t.a + 1);;
;
select * from (select 42) t(a), (select t.a + 1);;
SELECT * FROM (SELECT 42) AS t(a) , (SELECT (t.a + 1));
;
;
;
;
select * from (select 42) t(a), (select t.a + 1);;
select * from (select 42) t(a) cross join lateral (select t.a + 1);;
select * from (select 42) t(a) cross join lateral (select t.a + 1);;
;
select * from (select 42) t(a) cross join lateral (select t.a + 1);;
SELECT * FROM (SELECT 42) AS t(a) , (SELECT (t.a + 1));
;
;
;
;
select * from (select 42) t(a) cross join lateral (select t.a + 1);;
select * from (select 42 union all select 84) t(a), (select t.a + 1) ORDER BY ALL;;
select * from (select 42 union all select 84) t(a), (select t.a + 1) ORDER BY ALL;;
;
select * from (select 42 union all select 84) t(a), (select t.a + 1) ORDER BY ALL;;
SELECT * FROM ((SELECT 42) UNION ALL (SELECT 84)) AS t(a) , (SELECT (t.a + 1)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select 42 union all select 84) t(a), (select t.a + 1) ORDER BY ALL;;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
SELECT (SELECT min(val) FROM unnest(a) AS t(val)) FROM (SELECT (ARRAY[1, 2, 3, NULL])) AS t(a);
;
;
;
;
select (select MIN(val) from unnest(a) t(val)) from (select ARRAY[1, 2, 3, NULL]) t(a);;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) order by all;;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) order by all;;
;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) order by all;;
SELECT * FROM (SELECT main.list_value(42, 43, 44)) AS t(a) , (SELECT unnest(t.a)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) order by all;;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) t2(b) where b=43;;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) t2(b) where b=43;;
;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) t2(b) where b=43;;
SELECT * FROM (SELECT main.list_value(42, 43, 44)) AS t(a) , (SELECT unnest(t.a)) AS t2(b) WHERE (b = 43);
;
;
;
;
select * from (select [42, 43, 44]) t(a), (select unnest(t.a)) t2(b) where b=43;;
select * from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) order by all;;
select * from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) order by all;;
;
select * from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) order by all;;
SELECT * FROM ((SELECT main.list_value(42, 43, 44)) UNION ALL (SELECT main.list_value(45, NULL, 46))) AS t(a) , (SELECT unnest(t.a)) AS t2(b) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) order by all;;
select sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b);;
select sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b);;
;
select sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b);;
SELECT sum(b) FROM ((SELECT main.list_value(42, 43, 44)) UNION ALL (SELECT main.list_value(45, NULL, 46))) AS t(a) , (SELECT unnest(t.a)) AS t2(b);
;
;
;
;
select sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b);;
select a, sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) group by a order by a;;
select a, sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) group by a order by a;;
;
select a, sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) group by a order by a;;
SELECT a, sum(b) FROM ((SELECT main.list_value(42, 43, 44)) UNION ALL (SELECT main.list_value(45, NULL, 46))) AS t(a) , (SELECT unnest(t.a)) AS t2(b) GROUP BY a ORDER BY a;
;
;
;
;
select a, sum(b) from (select [42, 43, 44] union all select [45, NULL, 46]) t(a), (select unnest(t.a)) t2(b) group by a order by a;;
select * from (select array[42, 43, 44]) t(a) join (select unnest(t.a)) t2(b) on (true) order by all;;
select * from (select array[42, 43, 44]) t(a) join (select unnest(t.a)) t2(b) on (true) order by all;;
;
select * from (select array[42, 43, 44]) t(a) join (select unnest(t.a)) t2(b) on (true) order by all;;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT unnest(t.a)) AS t2(b) ON (CAST('t' AS BOOLEAN)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select array[42, 43, 44]) t(a) join (select unnest(t.a)) t2(b) on (true) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (true) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (true) order by all;;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (true) order by all;;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT unnest(t.a)) AS t2(b) ON (CAST('t' AS BOOLEAN)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (true) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]=b);;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]=b);;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]=b);;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT unnest(t.a)) AS t2(b) ON ((a[1] = b));
;
;
;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]=b);;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]<b) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]<b) order by all;;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]<b) order by all;;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT unnest(t.a)) AS t2(b) ON ((a[1] < b)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (a[1]<b) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (false) order by all;;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (false) order by all;;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (false) order by all;;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT unnest(t.a)) AS t2(b) ON (CAST('f' AS BOOLEAN)) ORDER BY COLUMNS(*);
;
;
;
;
select * from (select array[42, 43, 44]) t(a) join lateral (select unnest(t.a)) t2(b) on (false) order by all;;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (true);;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (true);;
;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (true);;
SELECT * FROM (SELECT 42) AS t(a) INNER JOIN (SELECT (t.a + 1)) AS t2(b) ON (CAST('t' AS BOOLEAN));
;
;
;
;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (true);;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (a+b>=80);;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (a+b>=80);;
;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (a+b>=80);;
SELECT * FROM (SELECT 42) AS t(a) INNER JOIN (SELECT (t.a + 1)) AS t2(b) ON (((a + b) >= 80));
;
;
;
;
select * from (select 42) t(a) join lateral (select t.a + 1) t2(b) on (a+b>=80);;
select * from (select ARRAY[42, 43, 44]) t(a) join lateral (select * from unnest(t.a)) t2(b) on (true) ORDER BY b;;
select * from (select ARRAY[42, 43, 44]) t(a) join lateral (select * from unnest(t.a)) t2(b) on (true) ORDER BY b;;
;
select * from (select ARRAY[42, 43, 44]) t(a) join lateral (select * from unnest(t.a)) t2(b) on (true) ORDER BY b;;
SELECT * FROM (SELECT (ARRAY[42, 43, 44])) AS t(a) INNER JOIN (SELECT * FROM unnest(t.a)) AS t2(b) ON (CAST('t' AS BOOLEAN)) ORDER BY b;
;
;
;
;
select * from (select ARRAY[42, 43, 44]) t(a) join lateral (select * from unnest(t.a)) t2(b) on (true) ORDER BY b;;
CREATE TABLE students(id INTEGER, name VARCHAR, major VARCHAR, year INTEGER);
CREATE TABLE exams(sid INTEGER, course VARCHAR, curriculum VARCHAR, grade INTEGER, year INTEGER);
INSERT INTO students VALUES (1, 'Mark', 'CS', 2017);
INSERT INTO students VALUES (2, 'Dirk', 'CS', 2017);
INSERT INTO exams VALUES (1, 'Database Systems', 'CS', 10, 2015);
INSERT INTO exams VALUES (1, 'Graphics', 'CS', 9, 2016);
INSERT INTO exams VALUES (2, 'Database Systems', 'CS', 7, 2015);
INSERT INTO exams VALUES (2, 'Graphics', 'CS', 7, 2016);
SELECT name, total FROM students JOIN LATERAL (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ON true ORDER BY total DESC;;
SELECT name, total FROM students JOIN LATERAL (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ON true ORDER BY total DESC;;
;
SELECT name, total FROM students JOIN LATERAL (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ON true ORDER BY total DESC;;
SELECT "name", total FROM students INNER JOIN (SELECT sum(grade) AS total FROM exams WHERE (exams.sid = students.id)) AS grades ON (CAST('t' AS BOOLEAN)) ORDER BY total DESC;
;
;
;
;
SELECT name, total FROM students JOIN LATERAL (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ON true ORDER BY total DESC;;
SELECT name, total FROM students, (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ORDER BY total DESC;;
SELECT name, total FROM students, (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ORDER BY total DESC;;
;
SELECT name, total FROM students, (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ORDER BY total DESC;;
SELECT "name", total FROM students , (SELECT sum(grade) AS total FROM exams WHERE (exams.sid = students.id)) AS grades ORDER BY total DESC;
;
;
;
;
SELECT name, total FROM students, (SELECT SUM(grade) AS total FROM exams WHERE exams.sid=students.id) grades ORDER BY total DESC;;
