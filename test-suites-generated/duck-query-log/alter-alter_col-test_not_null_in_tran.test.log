PRAGMA enable_verification;
CREATE TABLE t(i INTEGER, j INTEGER);
INSERT INTO t SELECT i, i FROM RANGE(2048) tbl(i);
BEGIN TRANSACTION;
INSERT INTO t VALUES(9999, NULL);
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
ROLLBACK;
INSERT INTO t VALUES(9999, NULL);
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
SELECT i FROM t WHERE j IS NULL;
SELECT i FROM t WHERE j IS NULL;
;
SELECT i FROM t WHERE j IS NULL;
SELECT i FROM t WHERE (j IS NULL);
;
;
;
;
SELECT i FROM t WHERE j IS NULL;
DROP TABLE IF EXISTS t;
CREATE TABLE t(i INTEGER, j INTEGER);
INSERT INTO t SELECT i, i FROM RANGE(2048) tbl(i);
BEGIN TRANSACTION;
INSERT INTO t values(8888, 8888);
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
COMMIT;
INSERT INTO t VALUES(9999, NULL);
SELECT * FROM t WHERE j = 8888;
SELECT * FROM t WHERE j = 8888;
;
SELECT * FROM t WHERE j = 8888;
SELECT * FROM t WHERE (j = 8888);
;
;
;
;
SELECT * FROM t WHERE j = 8888;
DROP TABLE IF EXISTS t;
CREATE TABLE t(i int, j int);
INSERT INTO T SELECT 1,1 FROM RANGE(2048);
BEGIN TRANSACTION;
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
INSERT INTO t VALUES(2, 2);
ALTER TABLE t ALTER COLUMN j DROP NOT NULL;
INSERT INTO t values(3, NULL);
COMMIT;
INSERT INTO t VALUES(4, NULL);
SELECT * FROM t WHERE j IS NULL;
SELECT * FROM t WHERE j IS NULL;
;
SELECT * FROM t WHERE j IS NULL;
SELECT * FROM t WHERE (j IS NULL);
;
;
;
;
SELECT * FROM t WHERE j IS NULL;
DROP TABLE IF EXISTS t;
CREATE TABLE t(i int, j int);
INSERT INTO T SELECT 1,1 FROM RANGE(2048);
BEGIN TRANSACTION;
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
INSERT INTO T VALUES(8888, 8888);
ROLLBACK;
INSERT INTO t VALUES(9999, NULL);
SELECT i FROM t WHERE j IS NULL;
SELECT i FROM t WHERE j IS NULL;
;
SELECT i FROM t WHERE j IS NULL;
SELECT i FROM t WHERE (j IS NULL);
;
;
;
;
SELECT i FROM t WHERE j IS NULL;
DROP TABLE IF EXISTS t;
CREATE TABLE t(i int, j int);
ALTER TABLE t ALTER COLUMN j SET NOT NULL;
INSERT INTO T SELECT 1,1 FROM RANGE(2048);
BEGIN TRANSACTION;
ALTER TABLE t ALTER COLUMN j DROP NOT NULL;
INSERT INTO T VALUES(7777, NULL);
ROLLBACK;
INSERT INTO t VALUES(8888, NULL);
SELECT COUNT(*) FROM t WHERE j IS NULL;
SELECT COUNT(*) FROM t WHERE j IS NULL;
;
SELECT COUNT(*) FROM t WHERE j IS NULL;
SELECT count_star() FROM t WHERE (j IS NULL);
;
;
;
;
SELECT COUNT(*) FROM t WHERE j IS NULL;
DROP TABLE IF EXISTS t;
BEGIN TRANSACTION;
CREATE TABLE t(i INTEGER);
ALTER TABLE t ALTER COLUMN i SET NOT NULL;
INSERT INTO t SELECT 1 FROM RANGE(1024);
COMMIT;
INSERT INTO t VALUES(NULL);
DROP TABLE IF EXISTS t;
BEGIN TRANSACTION;
CREATE TABLE t(i INTEGER NOT NULL);
INSERT INTO t SELECT 1 FROM RANGE(1024);
ALTER TABLE t ALTER COLUMN i DROP NOT NULL;
INSERT INTO t VALUES(NULL);
COMMIT;
INSERT INTO t VALUES(NULL);
