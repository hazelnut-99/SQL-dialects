PRAGMA enable_verification;
select min(i::varchar), max(i::varchar) from range(10) tbl(i);;
select min(i::varchar), max(i::varchar) from range(10) tbl(i);;
;
select min(i::varchar), max(i::varchar) from range(10) tbl(i);;
SELECT min(CAST(i AS VARCHAR)), max(CAST(i AS VARCHAR)) FROM range(10) AS tbl(i);
;
;
;
;
select min(i::varchar), max(i::varchar) from range(10) tbl(i);;
select min(list_value(i)), max(list_value(i)) from range(10) tbl(i);;
select min(list_value(i)), max(list_value(i)) from range(10) tbl(i);;
;
select min(list_value(i)), max(list_value(i)) from range(10) tbl(i);;
SELECT min(list_value(i)), max(list_value(i)) FROM range(10) AS tbl(i);
;
;
;
;
select min(list_value(i)), max(list_value(i)) from range(10) tbl(i);;
select min(list_value(-i)), max(list_value(i+2)) from range(10) tbl(i);;
select min(list_value(-i)), max(list_value(i+2)) from range(10) tbl(i);;
;
select min(list_value(-i)), max(list_value(i+2)) from range(10) tbl(i);;
SELECT min(list_value(-(i))), max(list_value((i + 2))) FROM range(10) AS tbl(i);
;
;
;
;
select min(list_value(-i)), max(list_value(i+2)) from range(10) tbl(i);;
CREATE VIEW list_int AS
SELECT * FROM (VALUES
	([1]),
	([1, 2]),
	([1, NULL]),
	([NULL, 2]),
	([NULL, NULL]),
	([NULL]),
	(NULL)
) tbl(i);;
select min(i), max(i), first(i) from list_int;;
select min(i), max(i), first(i) from list_int;;
;
select min(i), max(i), first(i) from list_int;;
SELECT min(i), max(i), first(i) FROM list_int;
;
;
;
;
select min(i), max(i), first(i) from list_int;;
select first([i]) from range(10) tbl(i);;
select first([i]) from range(10) tbl(i);;
;
select first([i]) from range(10) tbl(i);;
SELECT first(main.list_value(i)) FROM range(10) AS tbl(i);
;
;
;
;
select first([i]) from range(10) tbl(i);;
select first([0]) from range(10) tbl(i);;
select first([0]) from range(10) tbl(i);;
;
select first([0]) from range(10) tbl(i);;
SELECT first(main.list_value(0)) FROM range(10) AS tbl(i);
;
;
;
;
select first([0]) from range(10) tbl(i);;
select first(i) from range(10) tbl(i) WHERE i=-1;;
select first(i) from range(10) tbl(i) WHERE i=-1;;
;
select first(i) from range(10) tbl(i) WHERE i=-1;;
SELECT first(i) FROM range(10) AS tbl(i) WHERE (i = -1);
;
;
;
;
select first(i) from range(10) tbl(i) WHERE i=-1;;
select first(NULL::INT[]) from range(10) tbl(i) WHERE i=-1;;
select first(NULL::INT[]) from range(10) tbl(i) WHERE i=-1;;
;
select first(NULL::INT[]) from range(10) tbl(i) WHERE i=-1;;
SELECT first(CAST(NULL AS INTEGER[])) FROM range(10) AS tbl(i) WHERE (i = -1);
;
;
;
;
select first(NULL::INT[]) from range(10) tbl(i) WHERE i=-1;;
select i%3 a, first([i]) from range(10) tbl(i) group by a order by a;;
select i%3 a, first([i]) from range(10) tbl(i) group by a order by a;;
;
select i%3 a, first([i]) from range(10) tbl(i) group by a order by a;;
SELECT (i % 3) AS a, first(main.list_value(i)) FROM range(10) AS tbl(i) GROUP BY a ORDER BY a;
;
;
;
;
select i%3 a, first([i]) from range(10) tbl(i) group by a order by a;;
select i%3 a, unnest(first([i])) from range(10) tbl(i) group by a order by a;;
select i%3 a, unnest(first([i])) from range(10) tbl(i) group by a order by a;;
;
select i%3 a, unnest(first([i])) from range(10) tbl(i) group by a order by a;;
SELECT (i % 3) AS a, unnest(first(main.list_value(i))) FROM range(10) AS tbl(i) GROUP BY a ORDER BY a;
;
;
;
;
select i%3 a, unnest(first([i])) from range(10) tbl(i) group by a order by a;;
select string_agg(list_value(i)::varchar, ',') from range(10) tbl(i);;
select string_agg(list_value(i)::varchar, ',') from range(10) tbl(i);;
;
select string_agg(list_value(i)::varchar, ',') from range(10) tbl(i);;
SELECT string_agg(CAST(list_value(i) AS VARCHAR), ',') FROM range(10) AS tbl(i);
;
;
;
;
select string_agg(list_value(i)::varchar, ',') from range(10) tbl(i);;
select i, i % 2, min(list_value(i)) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 1;;
select i, i % 2, min(list_value(i)) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 1;;
;
select i, i % 2, min(list_value(i)) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 1;;
SELECT i, (i % 2), min(list_value(i)) OVER (PARTITION BY (i % 2) ORDER BY i) FROM range(10) AS tbl(i) ORDER BY 1;
;
;
;
;
select i, i % 2, min(list_value(i)) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 1;;
select i, i % 2, list(i) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 2, 1;;
select i, i % 2, list(i) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 2, 1;;
;
select i, i % 2, list(i) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 2, 1;;
SELECT i, (i % 2), list(i) OVER (PARTITION BY (i % 2) ORDER BY i) FROM range(10) AS tbl(i) ORDER BY 2, 1;
;
;
;
;
select i, i % 2, list(i) over(partition by i % 2 order by i) from range(10) tbl(i) ORDER BY 2, 1;;
select i, i % 2, list(i) over(partition by i % 2 order by i rows between 1 preceding and 1 following) from range(10) tbl(i) ORDER BY 2, 1;;
select i, i % 2, list(i) over(partition by i % 2 order by i rows between 1 preceding and 1 following) from range(10) tbl(i) ORDER BY 2, 1;;
;
select i, i % 2, list(i) over(partition by i % 2 order by i rows between 1 preceding and 1 following) from range(10) tbl(i) ORDER BY 2, 1;;
SELECT i, (i % 2), list(i) OVER (PARTITION BY (i % 2) ORDER BY i ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) FROM range(10) AS tbl(i) ORDER BY 2, 1;
;
;
;
;
select i, i % 2, list(i) over(partition by i % 2 order by i rows between 1 preceding and 1 following) from range(10) tbl(i) ORDER BY 2, 1;;
PREPARE rebind_stmt AS SELECT list(list_value({'foo': [?]}));;
EXECUTE rebind_stmt(10);;
