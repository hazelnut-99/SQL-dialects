CREATE TABLE t1 AS SELECT [1, 2, 3] AS x;;
SELECT list_apply(['hello'], x -> x) FROM t1;;
CREATE TABLE t2 AS SELECT [[1], [2], [3]] AS x;;
SELECT list_transform([[1], [2], [3]], x -> x[1]) FROM t2;;
CREATE TABLE l_test (l integer[]);;
INSERT INTO l_test VALUES ([1, 2, 3]);;
SELECT l, list_transform(l, l -> l + 1) FROM l_test;;
CREATE TABLE l_filter_test (l integer[]);;
INSERT INTO l_filter_test VALUES ([1, 2]);;
SELECT l, list_filter(l, l -> l > 1) FROM l_filter_test;;
SELECT list_apply(i, a.x -> a.x + 1) FROM (VALUES (list_value(1, 2, 3))) tbl(i);;
CREATE TABLE qualified_tbl (x INTEGER[]);;
INSERT INTO qualified_tbl VALUES ([1, 2]);;
SELECT list_transform(qualified_tbl.x, x -> (qualified_tbl.x)[1] + 1 + x) FROM qualified_tbl;;
SELECT list_transform(qualified_tbl.x, qualified_tbl.x -> qualified_tbl.x + 1) FROM qualified_tbl;;
SELECT list_transform([1, 2], x -> list_transform([3, 4], x -> x));;
SELECT list_has_all([variable_has_all FOR variable_has_all IN ['a']], ['b']) AS list_comp_result;;
SELECT list_has_all(list_transform(['a'], variable_has_all -> variable_has_all), ['b']) AS list_transform_result;;
SELECT list_has_any(['b'], list_transform(['a'], variable_has_any -> variable_has_any)) AS list_transform_result;;
SELECT list_intersect(list_intersect([1], [1]), [1]);
SELECT list_intersect([1], list_intersect([1], [1]));
SELECT list_has_any(LIST_VALUE(list_has_any([1], [1])), [1]);
SELECT list_has_any([1], LIST_VALUE(list_has_any([1], [1])));
SELECT list_has_all(LIST_VALUE(list_has_all([1], [1])), [1]);
SELECT list_has_all([1], LIST_VALUE(list_has_all([1], [1])));
SELECT list_has_any(LIST_VALUE(list_has_all(list_intersect([1], [1]), [1])), [1]);;
SELECT list_has_all(LIST_VALUE(list_has_any(list_intersect([1], [1]), [1])), [1]);;
SELECT list_intersect(LIST_VALUE(list_has_all(LIST_VALUE(list_has_any([1], [1])), [1])), [1]);
SELECT list_intersect(list_intersect([1, 2, 3, 4], [4, 5, 6, 7]), list_intersect([4, 5, 6, 7], [1, 2, 3, 4]));;
CREATE TABLE tbl_qualified AS SELECT 42 AS x;;
SELECT x, list_transform([1], x -> x) FROM tbl_qualified;;
SELECT list_transform([1,2,3], sqrt(xxx.z) -> xxx.z + 1) AS l ;;
SELECT list_transform([1, 2, 3], "x.y" -> "x.y" + x.y) AS l FROM (VALUES (42), (84)) x(y);;
SELECT list_reduce([1, 2, 3, 4], x *++++++++* y -> x - y) AS l;;
