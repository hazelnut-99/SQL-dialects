SET default_null_order='nulls_first';;
PRAGMA enable_verification;
CREATE VIEW intlists AS SELECT * FROM (VALUES
	(21, [1]),
	(22, [NULL]),
	(23, []),
	(24, [2, 3]),
	(NULL::INTEGER, [13]),
	(32, [NULL]),
	(34, [2, 3])
	) lv(v, k);;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM intlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
CREATE VIEW strlists AS SELECT * FROM (VALUES
	(21, ['a']),
	(22, [NULL]),
	(23, []),
	(24, ['Branta Canadensis', 'c']),
	(NULL::INTEGER, ['Somateria mollissima']),
	(32, [NULL]),
	(34, ['Branta Canadensis', 'c'])
	) lv(v, k);;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM strlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
CREATE VIEW structs AS SELECT * FROM (VALUES
	(21, {'x': 1, 'y': 'a'}),
	(22, {'x': NULL, 'y': NULL}),
	(23, {'x': 0, 'y': ''}),
	(24, {'x': 2, 'y': 'c'}),
	(NULL::INTEGER, {'x': 13, 'y': 'Somateria mollissima'}),
	(32, {'x': NULL, 'y': NULL}),
	(34, {'x': 2, 'y': 'c'})
	) sv(v, k);;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM structs GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
CREATE VIEW struct_lint_lstr AS SELECT * FROM (VALUES
	(21, {'x': [1], 'y': ['a']}),
	(22, {'x': [NULL], 'y': [NULL]}),
	(23, {'x': [], 'y': []}),
	(24, {'x': [2, 3], 'y': ['Branta Canadensis', 'c']}),
	(NULL::INTEGER, {'x': [13], 'y': ['Somateria mollissima']}),
	(32, {'x': [NULL], 'y': [NULL]}),
	(34, {'x': [2, 3], 'y': ['Branta Canadensis', 'c']})
	) sv(v, k);;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM struct_lint_lstr GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM struct_lint_lstr GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
CREATE VIEW r2l3r4l5i4i2l3v AS SELECT * FROM (VALUES
	(21, {'x': [{'l4': [51], 'i4': 41}], 'y': ['a']}),
	(22, {'x': [NULL], 'y': [NULL]}),
	(23, {'x': [], 'y': []}),
	(24, {'x': [{'l4': [52, 53], 'i4': 42}, {'l4': [54, 55], 'i4': 43}], 'y': ['Branta Canadensis', 'c']}),
	(NULL::INTEGER, {'x': [{'l4': [62], 'i4': 47}], 'y': ['Somateria mollissima']}),
	(32, {'x': [NULL], 'y': [NULL]}),
	(34, {'x': [{'l4': [52, 53], 'i4': 42}, {'l4': [54, 55], 'i4': 43}], 'y': ['Branta Canadensis', 'c']})
	) sv(v, k);;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM r2l3r4l5i4i2l3v GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM r2l3r4l5i4i2l3v GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
CREATE VIEW longlists AS
SELECT *
FROM ((VALUES
	(21, [1]),
	(22, [NULL]),
	(23, []),
	(NULL::INTEGER, [13]),
	(32, [NULL])
	)
UNION ALL
	select 24 as i, list(r) as pk from range(2000) tbl(r)
UNION ALL
	select 34 as i, list(r) as pk from range(2000) tbl(r)
) sv(v, k);;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM longlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM longlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
SELECT main.list_value(1, 2, 3) AS a, count_star() FROM range(5) AS tbl(b) GROUP BY a;
;
;
;
;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
SELECT main.struct_pack(x := 1, y := 2, z := 3) AS a, count_star() FROM range(5) AS tbl(b) GROUP BY a;
;
;
;
;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
DROP VIEW intlists;;
DROP VIEW strlists;;
DROP VIEW structs;;
DROP VIEW struct_lint_lstr;;
DROP VIEW r2l3r4l5i4i2l3v;;
DROP VIEW longlists;;
CREATE TABLE intlists AS SELECT * FROM (VALUES
	(21, [1]),
	(22, [NULL]),
	(23, []),
	(24, [2, 3]),
	(NULL::INTEGER, [13]),
	(32, [NULL]),
	(34, [2, 3])
	) lv(v, k);;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM intlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM intlists GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM intlists GROUP BY k, c ORDER BY 2, 3;
CREATE TABLE strlists AS SELECT * FROM (VALUES
	(21, ['a']),
	(22, [NULL]),
	(23, []),
	(24, ['Branta Canadensis', 'c']),
	(NULL::INTEGER, ['Somateria mollissima']),
	(32, [NULL]),
	(34, ['Branta Canadensis', 'c'])
	) lv(v, k);;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM strlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM strlists GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM strlists GROUP BY k, c ORDER BY 2, 3;
CREATE TABLE structs AS SELECT * FROM (VALUES
	(21, {'x': 1, 'y': 'a'}),
	(22, {'x': NULL, 'y': NULL}),
	(23, {'x': 0, 'y': ''}),
	(24, {'x': 2, 'y': 'c'}),
	(NULL::INTEGER, {'x': 13, 'y': 'Somateria mollissima'}),
	(32, {'x': NULL, 'y': NULL}),
	(34, {'x': 2, 'y': 'c'})
	) sv(v, k);;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, sum(v) FROM structs GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM structs GROUP BY k ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM structs GROUP BY k, c ORDER BY 2, 3;
CREATE TABLE struct_lint_lstr AS SELECT * FROM (VALUES
	(21, {'x': [1], 'y': ['a']}),
	(22, {'x': [NULL], 'y': [NULL]}),
	(23, {'x': [], 'y': []}),
	(24, {'x': [2, 3], 'y': ['Branta Canadensis', 'c']}),
	(NULL::INTEGER, {'x': [13], 'y': ['Somateria mollissima']}),
	(32, {'x': [NULL], 'y': [NULL]}),
	(34, {'x': [2, 3], 'y': ['Branta Canadensis', 'c']})
	) sv(v, k);;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM struct_lint_lstr GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM struct_lint_lstr
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM struct_lint_lstr GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM struct_lint_lstr
GROUP BY k, c
ORDER BY 2, 3;
CREATE TABLE r2l3r4l5i4i2l3v AS SELECT * FROM (VALUES
	(21, {'x': [{'l4': [51], 'i4': 41}], 'y': ['a']}),
	(22, {'x': [NULL], 'y': [NULL]}),
	(23, {'x': [], 'y': []}),
	(24, {'x': [{'l4': [52, 53], 'i4': 42}, {'l4': [54, 55], 'i4': 43}], 'y': ['Branta Canadensis', 'c']}),
	(NULL::INTEGER, {'x': [{'l4': [62], 'i4': 47}], 'y': ['Somateria mollissima']}),
	(32, {'x': [NULL], 'y': [NULL]}),
	(34, {'x': [{'l4': [52, 53], 'i4': 42}, {'l4': [54, 55], 'i4': 43}], 'y': ['Branta Canadensis', 'c']})
	) sv(v, k);;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM r2l3r4l5i4i2l3v GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM r2l3r4l5i4i2l3v GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM r2l3r4l5i4i2l3v
GROUP BY k, c
ORDER BY 2, 3;
CREATE TABLE longlists AS
SELECT *
FROM ((VALUES
	(21, [1]),
	(22, [NULL]),
	(23, []),
	(NULL::INTEGER, [13]),
	(32, [NULL])
	)
UNION ALL
	select 24 as i, list(r) as pk from range(2000) tbl(r)
UNION ALL
	select 34 as i, list(r) as pk from range(2000) tbl(r)
) sv(v, k);;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, sum(v) FROM longlists GROUP BY k ORDER BY 2;
;
;
;
SELECT k, SUM(v) FROM longlists
GROUP BY k
ORDER BY 2;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
SELECT k, least(v, 21) AS c, sum(v) FROM longlists GROUP BY k, c ORDER BY 2, 3;
;
;
;
SELECT k, LEAST(v, 21) as c, SUM(v) FROM longlists
GROUP BY k, c
ORDER BY 2, 3;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
SELECT main.list_value(1, 2, 3) AS a, count_star() FROM range(5) AS tbl(b) GROUP BY a;
;
;
;
;
select [1,2,3] a, count(*)
from range(5) tbl(b)
group by a;;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
SELECT main.struct_pack(x := 1, y := 2, z := 3) AS a, count_star() FROM range(5) AS tbl(b) GROUP BY a;
;
;
;
;
select {'x': 1, 'y': 2, 'z': 3} a, count(*)
from range(5) tbl(b)
group by a;;
DROP TABLE intlists;;
DROP TABLE strlists;;
DROP TABLE structs;;
DROP TABLE struct_lint_lstr;;
DROP TABLE r2l3r4l5i4i2l3v;;
DROP TABLE longlists;;
