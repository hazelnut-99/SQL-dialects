CREATE TABLE integers(i INTEGER);
INSERT INTO integers VALUES (1), (2), (3), (4), (5);
CREATE TABLE i2 AS SELECT 1 AS i FROM integers WHERE i % 2 <> 0;
SELECT * FROM i2 ORDER BY 1;
UPDATE i2 SET i=NULL;
SELECT * FROM i2 ORDER BY 1;
CREATE TABLE IF NOT EXISTS presentations(presentation_date Date NOT NULL UNIQUE, author VARCHAR NOT NULL, title VARCHAR NOT NULL, bio VARCHAR, abstract VARCHAR, zoom_link VARCHAR);
insert into presentations values ('2020-05-29', 'Eduardo Pena', 'Analytical Query Processing Based on Continuous Compression of Intermediates', NULL, 'Modern in-memory column-stores are widely accepted as the adequate database architecture for the efficient processing of complex analytical queries over large relational data volumes. These systems keep their entire data in main memory and typically employ lightweight compression to address the bottleneck between main memory and CPU. Numerous lightweight compression algorithms have been proposed in the past years, but none of them is suitable in all cases. While lightweight compression is already well established for base data, the efficient representation of intermediate results generated during query processing has attracted insufficient attention so far, although in in-memory systems, accessing intermeFdiates is as expensive as accessing base data. Thus, our vision is a continuous use of lightweight compression for all intermediates in a query execution plan, whereby a suitable compression algorithm should be selected for each intermediate. In this talk, I will provide an overview of our research in the context of this vision, including an experimental survey of lightweight compression algorithms, our compression-enabled processing model, and our compression-aware query optimization strategies.', 'https://zoom.us/j/7845983526');
CREATE TABLE integers AS SELECT * FROM range(1000000) tbl(i);
CREATE TABLE integers2 AS SELECT * FROM integers GROUP BY i;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers2;
DROP TABLE integers;
DROP TABLE integers2;
CREATE TABLE integers AS SELECT case when i%2=0 then null else i end AS i  FROM range(1000000) tbl(i);
CREATE TABLE integers2 AS SELECT * FROM integers GROUP BY i;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers2;
CREATE TABLE varchars AS SELECT case when i%2=0 then null else concat('thisismyvarchar-', i//4) end AS v  FROM range(1000000) tbl(i);
CREATE TABLE varchars2 AS SELECT * FROM varchars GROUP BY v;
SELECT MIN(v), MAX(v), COUNT(*), COUNT(v), COUNT(DISTINCT v) FROM varchars;
SELECT MIN(v), MAX(v), COUNT(*), COUNT(v), COUNT(DISTINCT v) FROM varchars2;
CREATE TABLE lists AS SELECT [i, NULL, i + 2] AS l FROM range(1000000) tbl(i);
CREATE TABLE lists2 AS SELECT * FROM lists GROUP BY l;
SELECT SUM(l[1]), SUM(l[2]), SUM(l[3]), COUNT(*), COUNT(l), COUNT(l[1]), COUNT(l[2]) FROM lists;
SELECT SUM(l[1]), SUM(l[2]), SUM(l[3]), COUNT(*), COUNT(l), COUNT(l[1]), COUNT(l[2]) FROM lists2;
CREATE TABLE structs AS SELECT {'i': i, 'j': NULL, 'k': i + 2} AS s FROM range(1000000) tbl(i);
CREATE TABLE structs2 AS SELECT * FROM structs GROUP BY s;
SELECT SUM(s.i), SUM(s.j), SUM(s.k), COUNT(*), COUNT(s), COUNT(s.i), COUNT(s.j) FROM structs;
SELECT SUM(s.i), SUM(s.j), SUM(s.k), COUNT(*), COUNT(s), COUNT(s.i), COUNT(s.j) FROM structs2;
CREATE TABLE integers(i INTEGER);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 500000);
SELECT COUNT(*) FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers;
CREATE TABLE integers(i INTEGER);
INSERT INTO integers VALUES (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9), (0), (1), (2), (3), (4), (5), (6), (7), (8), (9);
SELECT COUNT(*) FROM integers;
INSERT INTO integers SELECT * FROM integers;
SELECT COUNT(*) FROM integers;
DROP TABLE integers;
CREATE TABLE integers(i INTEGER, j INTEGER);
INSERT INTO integers VALUES (3, 4), (4, 3);
INSERT INTO integers VALUES (DEFAULT, 4);
INSERT INTO integers VALUES (DEFAULT+1, 4);
INSERT INTO integers (i) SELECT j FROM integers;
SELECT * FROM integers;
CREATE TABLE integers(i INTEGER);
BEGIN TRANSACTION;
INSERT INTO integers VALUES (0), (1), (2);
SELECT COUNT(*) FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers;
PRAGMA enable_verification;
CREATE TABLE integers(i INTEGER, j INTEGER);
INSERT INTO integers BY NAME SELECT 42 AS j;
INSERT INTO integers BY NAME SELECT 84 AS i;
INSERT INTO integers BY NAME SELECT 99 AS j, 9 AS i;
INSERT INTO integers BY POSITION SELECT 1 AS j, 10 AS i;
FROM integers;
CREATE TABLE "My Table"("My Column 1" INT, "My Column 2" INT);
INSERT INTO "My Table" BY NAME SELECT 1 AS "My Column 2";
FROM "My Table";
INSERT INTO integers BY NAME SELECT 1 AS xxx;
INSERT INTO integers BY NAME SELECT 1 AS i, 2 AS i;
INSERT INTO integers (i, i) SELECT 1, 2;
INSERT INTO integers BY NAME SELECT 1 AS rowid;
CREATE TABLE tbl (
	price INTEGER,
	total_price AS ((price)::DATE)
);
INSERT INTO tbl BY NAME SELECT 1 AS total_price;
INSERT INTO integers BY NAME VALUES (42, 84);
INSERT INTO integers BY NAME (i) SELECT 1 AS j;
INSERT INTO integers BY POSITION VALUES (42, 84);
SET immediate_transaction_mode=true;
CREATE TABLE integers(i INTEGER);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 5);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 17);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 1007);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 3020);
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 3);
BEGIN TRANSACTION;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
CREATE TABLE integers AS SELECT i FROM generate_series(0,999999,1) tbl(i);
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
INSERT INTO integers2 SELECT i FROM integers;
INSERT INTO integers2 VALUES (42);
SELECT * FROM integers2 WHERE i=999;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
INSERT INTO integers2 VALUES (999999);
INSERT INTO integers2 SELECT i FROM integers;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
BEGIN TRANSACTION;
INSERT INTO integers2 SELECT i FROM integers;
INSERT INTO integers2 VALUES (42);
ROLLBACK;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
BEGIN TRANSACTION;
INSERT INTO integers2 VALUES (999999);
INSERT INTO integers2 SELECT i FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
SET preserve_insertion_order=false;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
INSERT INTO integers2 SELECT i FROM integers;
INSERT INTO integers2 VALUES (42);
SELECT * FROM integers2 WHERE i=999;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers;
SELECT SUM(i), COUNT(*), COUNT(i) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
INSERT INTO integers2 VALUES (999999);
INSERT INTO integers2 SELECT i FROM integers;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
BEGIN TRANSACTION;
INSERT INTO integers2 SELECT i FROM integers;
INSERT INTO integers2 VALUES (42);
ROLLBACK;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
CREATE TABLE integers2(i INTEGER PRIMARY KEY);
BEGIN TRANSACTION;
INSERT INTO integers2 VALUES (999999);
INSERT INTO integers2 SELECT i FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers2;
DROP TABLE integers2;
SET preserve_insertion_order=false;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT NULL;
CREATE OR REPLACE TABLE integers_not_null(i INTEGER NOT NULL);
INSERT INTO integers_not_null SELECT * FROM integers;
CREATE OR REPLACE TABLE varchars AS SELECT i::VARCHAR s FROM range(1000000) tbl(i) UNION ALL SELECT 'hello';
CREATE OR REPLACE TABLE varchars_generated(s VARCHAR, i AS (s::INT));
INSERT INTO varchars_generated (s) SELECT * FROM varchars;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT 7777;
CREATE OR REPLACE TABLE integers_pk(i INTEGER PRIMARY KEY);
INSERT INTO integers_pk SELECT * FROM integers;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT -1;
CREATE OR REPLACE TABLE integers_pk(i INTEGER PRIMARY KEY);
INSERT INTO integers_pk SELECT * FROM range(1000000);
CREATE OR REPLACE TABLE integers_fk(i INTEGER PRIMARY KEY REFERENCES integers_pk(i));
INSERT INTO integers_fk SELECT * FROM integers;
DROP TABLE integers_fk;
DROP TABLE integers_pk;
PRAGMA preserve_insertion_order=false;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT NULL;
CREATE OR REPLACE TABLE integers_not_null(i INTEGER NOT NULL);
INSERT INTO integers_not_null SELECT * FROM integers;
CREATE OR REPLACE TABLE varchars AS SELECT i::VARCHAR s FROM range(1000000) tbl(i) UNION ALL SELECT 'hello';
CREATE OR REPLACE TABLE varchars_generated(s VARCHAR, i AS (s::INT));
INSERT INTO varchars_generated (s) SELECT * FROM varchars;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT 7777;
CREATE OR REPLACE TABLE integers_pk(i INTEGER PRIMARY KEY);
INSERT INTO integers_pk SELECT * FROM integers;
CREATE OR REPLACE TABLE integers AS SELECT * FROM range(1000000) tbl(i) UNION ALL SELECT -1;
CREATE OR REPLACE TABLE integers_pk(i INTEGER PRIMARY KEY);
INSERT INTO integers_pk SELECT * FROM range(1000000);
CREATE OR REPLACE TABLE integers_fk(i INTEGER PRIMARY KEY REFERENCES integers_pk(i));
INSERT INTO integers_fk SELECT * FROM integers;
DROP TABLE integers_fk;
DROP TABLE integers_pk;
PRAGMA preserve_insertion_order=false;
CREATE TABLE integers(i INTEGER);
INSERT INTO integers SELECT i FROM range(100) tbl(i);
BEGIN TRANSACTION;
INSERT INTO integers SELECT i FROM range(100) tbl(i);
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);
INSERT INTO integers SELECT i FROM range(100) tbl(i);
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);
INSERT INTO integers SELECT i FROM range(100) tbl(i);
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);
INSERT INTO integers SELECT i FROM range(100) tbl(i);
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);
INSERT INTO integers SELECT i FROM range(100) tbl(i);
INSERT INTO integers SELECT NULL FROM range(100) tbl(i);
SELECT COUNT(i), SUM(i), MIN(i), MAX(i), COUNT(*) FROM integers;
COMMIT;
SELECT COUNT(i), SUM(i), MIN(i), MAX(i), COUNT(*) FROM integers;
SELECT SUM(CASE WHEN i IS NULL THEN 1 ELSE 0 END) FROM integers;
CREATE TABLE integers(i INTEGER);
INSERT INTO integers SELECT 42;
INSERT INTO integers SELECT CAST(NULL AS VARCHAR);
SELECT * FROM integers;
CREATE TABLE integers(i INTEGER);
BEGIN TRANSACTION;
BEGIN TRANSACTION;
INSERT INTO integers SELECT * FROM range(0, 500000);
INSERT INTO integers SELECT * FROM range(0, 500000);
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers;
SELECT COUNT(*) FROM integers;
ROLLBACK;
SELECT COUNT(*) FROM integers;
PRAGMA preserve_insertion_order=false;
CREATE TABLE integers AS SELECT * FROM range(1000000) tbl(i);
CREATE TABLE integers2 AS SELECT * FROM integers;
SELECT SUM(i) FROM integers;
SELECT SUM(i) FROM integers2;
DROP TABLE integers;
DROP TABLE integers2;
CREATE TABLE integers AS SELECT case when i%2=0 then null else i end AS i  FROM range(1000000) tbl(i);
CREATE TABLE integers2 AS SELECT * FROM integers;
SELECT SUM(i) FROM integers;
SELECT SUM(i) FROM integers2;
CREATE TABLE varchars AS SELECT case when i%2=0 then null else concat('thisismyvarchar-', i//4) end AS v  FROM range(1000000) tbl(i);
CREATE TABLE varchars2 AS SELECT * FROM varchars;
SELECT MIN(v), MAX(v), COUNT(*), COUNT(v), COUNT(DISTINCT v) FROM varchars;
SELECT MIN(v), MAX(v), COUNT(*), COUNT(v), COUNT(DISTINCT v) FROM varchars2;
CREATE TABLE strings(i STRING);
CREATE TABLE a(i integer, j integer);
INSERT INTO a VALUES (1, 2);
INSERT INTO a VALUES (1);
INSERT INTO a VALUES (1,2,3);
INSERT INTO a VALUES (1,2),(3);
INSERT INTO a VALUES (1,2),(3,4,5);
INSERT INTO a SELECT 42;
SET default_null_order='nulls_first';
CREATE TABLE strings(a VARCHAR);
CREATE TABLE integers(i INTEGER);
INSERT INTO integers VALUES (3), (4), (NULL);
INSERT INTO strings SELECT * FROM integers;
SELECT * FROM strings;
UPDATE strings SET a=13 WHERE a='3';
SELECT * FROM strings ORDER BY cast(a AS INTEGER);
