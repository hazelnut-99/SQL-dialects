PRAGMA enable_verification;
create table r AS SELECT * FROM read_csv('test/sql/copy/csv/data/test/date.csv', columns=STRUCT_PACK(d := 'DATE'), header=0, auto_detect=0);;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, r
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, r
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, r
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t (i) AS ((SELECT 1, CAST(NULL AS DATE)) UNION  ALL (SELECT (i + 1), d FROM t , r WHERE (i < 5)))SELECT * FROM t ORDER BY i;
;
;
;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, r
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', columns=STRUCT_PACK(d := 'DATE'), header=0, auto_detect=0)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', columns=STRUCT_PACK(d := 'DATE'), header=0, auto_detect=0)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', columns=STRUCT_PACK(d := 'DATE'), header=0, auto_detect=0)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t (i) AS ((SELECT 1, CAST(NULL AS DATE)) UNION  ALL (SELECT (i + 1), d FROM t , read_csv('test/sql/copy/csv/data/test/date.csv', ("columns" = struct_pack(d := 'DATE')), ("header" = 0), (auto_detect = 0)) WHERE (i < 5)))SELECT * FROM t ORDER BY i;
;
;
;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', columns=STRUCT_PACK(d := 'DATE'), header=0, auto_detect=0)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
;
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
;
;
;
;
SELECT * FROM read_csv_auto('test/sql/copy/csv/data/test/date.csv');
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', header=0, auto_detect=1) r(d)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', header=0, auto_detect=1) r(d)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', header=0, auto_detect=1) r(d)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
WITH RECURSIVE t (i) AS ((SELECT 1, CAST(NULL AS DATE)) UNION  ALL (SELECT (i + 1), d FROM t , read_csv('test/sql/copy/csv/data/test/date.csv', ("header" = 0), (auto_detect = 1)) AS r(d) WHERE (i < 5)))SELECT * FROM t ORDER BY i;
;
;
;
;
WITH RECURSIVE t(i) AS
(
	SELECT 1, NULL::DATE
	UNION ALL
	(
		SELECT i+1, d
		FROM t, read_csv('test/sql/copy/csv/data/test/date.csv', header=0, auto_detect=1) r(d)
		WHERE i<5
	)
)
SELECT * FROM t ORDER BY i;;
