PRAGMA enable_verification;
CREATE TABLE events (begin DOUBLE, value INTEGER);;
INSERT INTO events VALUES
	(1, 0),
	(3, 1),
	(6, 2),
	(8, 3)
;;
SELECT begin, value IN (
	SELECT e1.value 
	FROM (
		SELECT * 
		FROM events e1 
		WHERE e1.value = events.value) e1 
	ASOF JOIN 
		range(1, 10) tbl(begin) 
	USING (begin)
	) 
FROM events
ORDER BY ALL;;
SELECT begin, value IN (
	SELECT e1.value 
	FROM (
		SELECT * 
		FROM events e1 
		WHERE e1.value = events.value) e1 
	ASOF JOIN 
		range(1, 10) tbl(begin) 
	USING (begin)
	) 
FROM events
ORDER BY ALL;;
;
SELECT begin, value IN (
	SELECT e1.value 
	FROM (
		SELECT * 
		FROM events e1 
		WHERE e1.value = events.value) e1 
	ASOF JOIN 
		range(1, 10) tbl(begin) 
	USING (begin)
	) 
FROM events
ORDER BY ALL;;
SELECT "begin", ("value" = ANY(SELECT e1."value" FROM (SELECT * FROM events AS e1 WHERE (e1."value" = events."value")) AS e1 ASOF INNER JOIN range(1, 10) AS tbl("begin") USING (begin))) FROM events ORDER BY COLUMNS(*);
;
;
;
;
SELECT begin, value IN (
	SELECT e1.value 
	FROM (
		SELECT * 
		FROM events e1 
		WHERE e1.value = events.value) e1 
	ASOF JOIN 
		range(1, 10) tbl(begin) 
	USING (begin)
	) 
FROM events
ORDER BY ALL;;
