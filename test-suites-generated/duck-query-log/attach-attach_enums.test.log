PRAGMA enable_verification;
ATTACH 'duckdb_unittest_tempdir/54296/attach_enums.db' AS db1;
CREATE TYPE db1.mood AS ENUM ('sad', 'ok', 'happy');;
SELECT enum_range(NULL::db1.mood) AS my_enum_range;;
SELECT enum_range(NULL::db1.mood) AS my_enum_range;;
;
SELECT enum_range(NULL::db1.mood) AS my_enum_range;;
SELECT enum_range(CAST(NULL AS db1.mood)) AS my_enum_range;
;
;
;
;
SELECT enum_range(NULL::db1.mood) AS my_enum_range;;
SELECT enum_range(NULL::db1.main.mood) AS my_enum_range;;
SELECT enum_range(NULL::db1.main.mood) AS my_enum_range;;
;
SELECT enum_range(NULL::db1.main.mood) AS my_enum_range;;
SELECT enum_range(CAST(NULL AS db1.main.mood)) AS my_enum_range;
;
;
;
;
SELECT enum_range(NULL::db1.main.mood) AS my_enum_range;;
DROP TYPE db1.mood;
DROP TYPE IF EXISTS db1.main.mood;
CREATE TYPE db1.mood AS ENUM ('sad', 'ok', 'happy');;
CREATE TABLE db1.person (
    name text,
    current_mood mood
);;
INSERT INTO db1.person VALUES ('Moe', 'happy');;
select * from db1.person;
select * from db1.person;
;
select * from db1.person;
SELECT * FROM db1.person;
;
;
;
;
select * from db1.person;
DETACH db1;
ATTACH 'duckdb_unittest_tempdir/54296/attach_enums.db' AS db1 (READ_ONLY);
select * from db1.person;
select * from db1.person;
;
select * from db1.person;
SELECT * FROM db1.person;
;
;
;
;
select * from db1.person;
ATTACH 'duckdb_unittest_tempdir/54296/attach_enums_2.db' AS db2;
CREATE TYPE db2.mood AS ENUM ('ble','grr','kkcry');;
CREATE TABLE db2.person (
    name text,
    current_mood mood
);;
INSERT INTO db2.person VALUES ('Moe', 'kkcry');;
select * from db1.person;
select * from db1.person;
;
select * from db1.person;
SELECT * FROM db1.person;
;
;
;
;
select * from db1.person;
select * from db2.person;
select * from db2.person;
;
select * from db2.person;
SELECT * FROM db2.person;
;
;
;
;
select * from db2.person;
