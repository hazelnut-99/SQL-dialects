CREATE TABLE struct AS SELECT * FROM (VALUES
	({'a': 42, 'b': 84}),
	({'a': 33, 'b': 32}),
	({'a': 42, 'b': 27})
) tbl(i);;
COPY struct TO 'duckdb_unittest_tempdir/54823/test_struct.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/test_struct.parquet');;
CREATE TABLE struct_nulls AS SELECT * FROM (VALUES
	({'a': 42, 'b': 84}),
	({'a': NULL, 'b': 32}),
	(NULL),
	({'a': 42, 'b': NULL})
) tbl(i);;
COPY struct_nulls TO 'duckdb_unittest_tempdir/54823/test_struct_nulls.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/test_struct_nulls.parquet');;
CREATE TABLE struct_nested AS SELECT * FROM (VALUES
	({'a': {'x': 3, 'x1': 22}, 'b': {'y': 27, 'y1': 44}}),
	({'a': {'x': 9, 'x1': 26}, 'b': {'y': 1, 'y1': 999}}),
	({'a': {'x': 17, 'x1': 23}, 'b': {'y': 3, 'y1': 9999}})
) tbl(i);;
COPY struct_nested TO 'duckdb_unittest_tempdir/54823/struct_nested.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/struct_nested.parquet');;
CREATE TABLE struct_nested_null AS SELECT * FROM (VALUES
	({'a': {'x': 3, 'x1': 22}, 'b': {'y': NULL, 'y1': 44}}),
	({'a': {'x': NULL, 'x1': 26}, 'b': {'y': 1, 'y1': NULL}}),
	({'a': {'x': 17, 'x1': NULL}, 'b': {'y': 3, 'y1': 9999}}),
	(NULL),
	({'a': NULL, 'b': NULL})
) tbl(i);;
COPY struct_nested_null TO 'duckdb_unittest_tempdir/54823/struct_nested_null.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/struct_nested_null.parquet');;
CREATE TABLE single_struct AS SELECT * FROM (VALUES
	({'a': 42}),
	({'a': 33}),
	({'a': 42})
) tbl(i);;
COPY single_struct TO 'duckdb_unittest_tempdir/54823/single_struct.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/single_struct.parquet');;
CREATE TABLE single_struct_null AS SELECT * FROM (VALUES
	({'a': 42}),
	({'a': NULL}),
	(NULL)
) tbl(i);;
COPY single_struct_null TO 'duckdb_unittest_tempdir/54823/single_struct_null.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/single_struct_null.parquet');;
CREATE TABLE nested_single_struct AS SELECT * FROM (VALUES
	({'a': {'b': 42}}),
	({'a': {'b': NULL}}),
	({'a': NULL}),
	(NULL)
) tbl(i);;
COPY nested_single_struct TO 'duckdb_unittest_tempdir/54823/nested_single_struct.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54823/nested_single_struct.parquet');;
