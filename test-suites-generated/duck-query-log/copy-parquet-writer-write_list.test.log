CREATE TABLE list AS SELECT * FROM (VALUES
	([1, 2, 3]),
	([4, 5]),
	([6, 7]),
    ([8, 9, 10, 11])
) tbl(i);;
COPY list TO 'duckdb_unittest_tempdir/54805/test_list.parquet' (FORMAT 'parquet');;
SELECT i FROM parquet_scan('duckdb_unittest_tempdir/54805/test_list.parquet');;
CREATE TABLE null_empty_list AS SELECT * FROM (VALUES
	([1, 2, 3]),
	([4, 5]),
	([6, 7]),
	([NULL]),
	([]),
	([]),
	([]),
	([]),
    ([8, NULL, 10, 11]),
    (NULL)
) tbl(i);;
COPY null_empty_list TO 'duckdb_unittest_tempdir/54805/test_list.parquet' (FORMAT 'parquet');;
SELECT * FROM parquet_scan('duckdb_unittest_tempdir/54805/test_list.parquet');;
COPY (SELECT []::INT[]) TO 'duckdb_unittest_tempdir/54805/test_empty_list.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54805/test_empty_list.parquet';
COPY (SELECT NULL::INT[]) TO 'duckdb_unittest_tempdir/54805/test_null_list.parquet' (FORMAT 'parquet');;
SELECT * FROM 'duckdb_unittest_tempdir/54805/test_null_list.parquet';
CREATE TABLE big_list AS SELECT LIST(CASE WHEN i%2=0 THEN NULL ELSE i END) l FROM range(20000) tbl(i);;
SELECT SUM(i) FROM (SELECT UNNEST(l) FROM big_list) t(i);
COPY big_list TO 'duckdb_unittest_tempdir/54805/big_list.parquet' (FORMAT 'parquet');;
SELECT SUM(i) FROM (SELECT UNNEST(l) FROM 'duckdb_unittest_tempdir/54805/big_list.parquet') t(i);
