select list_sort(list_intersect([1,2,3], [2,3,4]));;
CREATE TABLE list_data(l1 int[], l2 int[]);;
INSERT INTO list_data VALUES (NULL, NULL);;
INSERT INTO list_data VALUES (NULL, [1,2,3]);;
INSERT INTO list_data VALUES ([1,2,3], NULL);;
INSERT INTO list_data VALUES ([1,2,3], [2,3,NULL]);;
INSERT INTO list_data VALUES ([1,2,NULL], [2,3,NULL]);;
select list_sort(list_intersect(l1, l2)) from list_data;;
DROP TABLE list_data;;
create table list_of_list(l1 int[][], l2 int[][]);;
insert into list_of_list values (NULL, NULL);;
insert into list_of_list values ([[1 , 2, 3], NULL, [3, 2, 1]], [[ 2, 3, 4], NULL, [1, 2, 3]]);;
select list_intersect(l1, l2) from list_of_list;;
drop table list_of_list;;
create table list_of_strings(l1 string[], l2 string[]);;
insert into list_of_strings values (NULL, NULL);;
insert into list_of_strings values ([NULL, 'a', 'b', 'c'], [NULL, 'b', 'c', 'd']);;
insert into list_of_strings values (['here is a very long long string that is def more than 12 bytes', 'and a shorty'], ['here is a very long long string that is def more than 12 bytes', 'here is a very long long string that is def more than 12 bytes', 'c', 'd']);;
select list_sort(list_intersect(l1, l2)) from list_of_strings;;
drop table list_of_strings;;
select list_sort(array_intersect([1,2,3], [2,3,4]));;
CREATE TABLE list_data(l1 int[], l2 int[]);;
INSERT INTO list_data VALUES (NULL, NULL);;
INSERT INTO list_data VALUES (NULL, [1,2,3]);;
INSERT INTO list_data VALUES ([1,2,3], NULL);;
INSERT INTO list_data VALUES ([1,2,3], [2,3,NULL]);;
INSERT INTO list_data VALUES ([1,2,NULL], [2,3,NULL]);;
select list_sort(array_intersect(l1, l2)) from list_data;;
DROP TABLE list_data;;
create table list_of_list(l1 int[][], l2 int[][]);;
insert into list_of_list values (NULL, NULL);;
insert into list_of_list values ([[1 , 2, 3], NULL, [3, 2, 1]], [[ 2, 3, 4], NULL, [1, 2, 3]]);;
select array_intersect(l1, l2) from list_of_list;;
drop table list_of_list;;
create table list_of_strings(l1 string[], l2 string[]);;
insert into list_of_strings values (NULL, NULL);;
insert into list_of_strings values ([NULL, 'a', 'b', 'c'], [NULL, 'b', 'c', 'd']);;
insert into list_of_strings values (['here is a very long long string that is def more than 12 bytes', 'and a shorty'], ['here is a very long long string that is def more than 12 bytes', 'here is a very long long string that is def more than 12 bytes', 'c', 'd']);;
select list_sort(array_intersect(l1, l2)) from list_of_strings;;
drop table list_of_strings;;
select list_intersect(l1) from list_of_strings;;
select list_intersect(l1, l2, l1) from list_of_strings;;
select list_intersect([[1,2], [2,4]], ['abc', 'def']);;
create table large_lists(l1 int[], l2 int[]);;
insert into large_lists values (range(1, 3000), range(2000, 3000));;
insert into large_lists values (range(3000), range(3000));;
select list_intersect(l1, l2) from large_lists;;
select list_intersect(list_filter([1,2,3,4], x -> x > 2), list_filter([4,5,6,7], x -> x > 2));;
prepare q1 as select list_intersect(?, ?);;
execute q1(['abc', 'def'], ['def', 'ghi']);;
CREATE TABLE all_types AS SELECT * FROM test_all_types();;
select list_intersect(["bool"], ["bool"]) FROM all_types;;
select list_intersect(["tinyint"], ["tinyint"]) FROM all_types;;
select list_intersect(["smallint"], ["smallint"]) FROM all_types;;
select list_intersect(["int"], ["int"]) FROM all_types;;
select list_intersect(["bigint"], ["bigint"]) FROM all_types;;
select list_intersect(["utinyint"], ["utinyint"]) FROM all_types;;
select list_intersect(["usmallint"], ["usmallint"]) FROM all_types;;
select list_intersect(["uint"], ["uint"]) FROM all_types;;
select list_intersect(["ubigint"], ["ubigint"]) FROM all_types;;
select list_intersect(["date"], ["date"]) FROM all_types;;
select list_intersect(["time"], ["time"]) FROM all_types;;
select list_intersect(["timestamp"], ["timestamp"]) FROM all_types;;
select list_intersect(["timestamp_s"], ["timestamp_s"]) FROM all_types;;
select list_intersect(["timestamp_ms"], ["timestamp_ms"]) FROM all_types;;
select list_intersect(["timestamp_ns"], ["timestamp_ns"]) FROM all_types;;
select list_intersect(["time_tz"], ["time_tz"]) FROM all_types;;
select list_intersect(["timestamp_tz"], ["timestamp_tz"]) FROM all_types;;
select list_intersect(["float"], ["float"]) FROM all_types;;
select list_intersect(["double"], ["double"]) FROM all_types;;
select list_intersect(["dec_4_1"], ["dec_4_1"]) FROM all_types;;
select list_intersect(["dec_9_4"], ["dec_9_4"]) FROM all_types;;
select list_intersect(["uuid"], ["uuid"]) FROM all_types;;
select list_intersect(["interval"], ["interval"]) FROM all_types;;
select list_intersect(["varchar"], ["varchar"]) FROM all_types;;
select list_intersect(["small_enum"], ["small_enum"]) FROM all_types;;
select list_intersect(["medium_enum"], ["medium_enum"]) FROM all_types;;
select list_intersect(["large_enum"], ["large_enum"]) FROM all_types;;
SELECT list_sort(list_intersect([1, 4, 3, 5, 5, 2, 2], [5, 5, 5, 1, 1, 2, 4]));;
